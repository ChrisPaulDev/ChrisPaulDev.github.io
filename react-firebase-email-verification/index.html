<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="robots" content="all,follow">
    <meta name="googlebot" content="index,follow,snippet,archive">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>
        Email Verification with Firebase in React - CPaul
    </title>
    <meta name="author" content="" />
    <meta name="description"
        content="A Firebase React tutorial on how to enable email verification. Only users that confirmed their email address with a email confirmation have access to your application. Every other user who is using a fake email is not authorized ...">
    <meta name="theme-color" content="#38bb6c" />
    <meta name="generator" content="Hugo 0.41" />
    <link href="https://cdn-images.mailchimp.com/embedcode/horizontal-slim-10_7.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
    <link href="../css/bootstrap.default.css" rel="stylesheet" id="theme-stylesheet">
    <link href="../css/customizations.css" rel="stylesheet">
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <link rel="shortcut icon" href="../img/favicon/favicon.ico" type="image/x-icon" />
    <link rel="apple-touch-icon" href="../img/favicon/apple-touch-icon.png" />
    <link rel="manifest" href="../img/favicon/manifest.json">
    <link rel="mask-icon" href="../img/favicon/safari-pinned-tab.svg" color="#5bbad5">
    <link rel="alternate" href="../index.xml" type="application/rss+xml" title="CPaul">
    <meta itemprop="name" content="Email Verification with Firebase in React">
    <meta itemprop="description"
        content="A Firebase React tutorial on how to enable email verification. Only users that confirmed their email address with a email confirmation have access to your application. Every other user who is using a fake email is not authorized ...">
    <meta itemprop="image" content="https://chrispaul.dev/img/posts/react-firebase-email-verification/banner_640.jpg">
    <meta itemprop="keywords"
        content="angular,apollo,d3,graphql,growth,javascript,machine-learning,mobx,node,react,reason,redux,tooling,vue,web-development,angular,apollo,d3,graphql,growth,javascript,machine-learning,mobx,node,react,reason,redux,tooling,web-development," />
    <meta itemprop="wordCount" content="1376">
    <meta name="keywords"
        content="react firebase email verification, react firebase email confirmation, react firebase double opt in">
    <meta property="og:title" content="Email Verification with Firebase in React - CPaul">
    <meta property="og:description"
        content="A Firebase React tutorial on how to enable email verification. Only users that confirmed their email address with a email confirmation have access to your application. Every other user who is using a fake email is not authorized ..." />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://chrispaul.dev/react-firebase-email-verification/" />
    <meta property="og:image"
        content="https://chrispaul.dev/img/posts/react-firebase-email-verification/banner_640.jpg" />
    <meta name="news_keywords"
        content="react firebase email verification,react firebase email confirmation,react firebase double opt in" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:image:src"
        content="https://chrispaul.dev/img/posts/react-firebase-email-verification/banner_640.jpg" />
    <meta name="twitter:title" content="Email Verification with Firebase in React" />
    <meta name="twitter:description"
        content="A Firebase React tutorial on how to enable email verification. Only users that confirmed their email address with a email confirmation have access to your application. Every other user who is using a fake email is not authorized ..." />
    <meta name="twitter:site" content="@ChrisPaulDev" />
    
</head>

<body>
    <div id="all">
        <header>
            <div class="navbar-affixed-top" data-spy="affix" data-offset-top="200">
                <div class="navbar navbar-default yamm" role="navigation" id="navbar">
                    <div class="container">
                        <div class="navbar-header">
                            
                            <div class="navbar-buttons">
                                <button type="button" class="navbar-toggle btn-template-main" data-toggle="collapse"
                                    data-target="#navigation">
                                    <span class="sr-only">Toggle navigation</span>
                                    <i class="fa fa-align-justify"></i>
                                </button>
                            </div>
                        </div>
                        <div class="navbar-collapse collapse" id="navigation">
                            <ul class="nav navbar-nav navbar-right">

                                <li class="dropdown">

                                    <a href="../index.html">Blog</a>

                                </li>

                                <li class="dropdown">

                                    <a href="../work-with-me/index.html">Work with me</a>

                                </li>

                                <li class="dropdown">

                                    <a href="../about/index.html">About</a>

                                </li>

                                <li class="dropdown">

                                    <a style="color: #38bb6c" href="https://roadtoreact.com/">Books &amp; Courses</a>

                                </li>

                            </ul>
                        </div>
                        <div class="collapse clearfix" id="search">
                            <form class="navbar-form" role="search">
                                <div class="input-group">
                                    <input type="text" class="form-control" placeholder="Search">
                                    <span class="input-group-btn"> <button type="submit"
                                            class="btn btn-template-main"><i class="fa fa-search"></i></button> </span>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        
        <div class="hidden-xs">
            
        </div>
        <div id="content">
            <div class="container">
                <div class="row">
                    <article class="col-md-8 col-md-offset-2" id="blog-post" itemprop="blogPosts" itemscope
                        itemtype="http://schema.org/BlogPosting">
                        <div id="post-content" itemprop="articleBody">
                            <header>
                                <h1 itemprop="name headline">Email Verification with Firebase in React</h1>
                            </header>
                            
                            <p class="text-muted text-uppercase mb-small text-center">
                                <span itemprop="author publisher">

                                </span>
                                <time datetime="2018-12-20" itemprop="datePublished">
                                    December 20, 2018
                                </time>

                             

                            </p>
                            <div>
                            </div>
                            <div class="post-image-primary">
                                <div class="pinterest-pinner-wrapper" itemscope
                                    itemtype="http://schema.org/ImageObject">
                                    <div class="pinterest-pinner">
                                        <a data-pin-do="buttonPin" data-pin-save="true" data-pin-tall="true"
                                            href="https://www.pinterest.com/pin/create/button/?url=https%3a%2f%2fchrispaul.dev%2freact-firebase-email-verification%2f&amp;media=https://chrispaul.dev/img%2fposts%2freact-firebase-email-verification%2fbanner.jpg&amp;description=">
                                        </a>
                                    </div> <img class="img-lazy img-responsive"
                                        data-lazy-src="/src="/img/posts/react-firebase-email-verification/banner.jpg"
                                        data-is-src-set="is-src-set" alt="react firebase email verification"
                                        itemprop="image" />
                                </div>
                            </div>
                            <p>
                                <em>
                                    Interested in reading this tutorial as one of many chapters in my advanced React
                                    with Firebase book? Checkout the entire <a href="https://roadtoreact.com">The Road
                                        to React with Firebase</a> book that teaches you to create business web
                                    applications without the need to create a backend application with a database
                                    yourself.
                                </em>
                            </p>
                            <div class="read-before">
                                <p>This tutorial is part 6 of 6 in this series.</p>
                                <div>Part 1: <a href="../complete-firebase-authentication-react-tutorial/index.html"
                                        itemprop="url">A Firebase in React Tutorial for Beginners</a></div>
                                <div>Part 2: <a href="../react-firebase-authorization-roles-permissions/index.html"
                                        itemprop="url">React Firebase Authorization with Roles</a></div>
                                <div>Part 3: <a href="../react-firebase-auth-persistence/index.html"
                                        itemprop="url">React Firebase Auth Persistence with Local Storage</a></div>
                                <div>Part 4: <a href="../react-firebase-social-login/index.html" itemprop="url">React
                                        Firebase Social Login: Google, Facebook, Twitter</a></div>
                                <div>Part 5: <a href="../react-firebase-link-social-logins/index.html"
                                        itemprop="url">React Firebase: Link Social Logins</a></div>
                            </div>
                            <p>In your application, users can employ an email/password combination, but also social
                                logins to get access to your service or product. Often, the email address associated
                                with the social logins is confirmed by the social platform (Google, Facebook, Twitter)
                                and you know this email address really exists. But what about the email address used
                                with the password? Because users are sometimes unwilling to provide real email
                                addresses, they&rsquo;ll simply make one up, so you can&rsquo;t provide them with
                                further information via email or to integrate them with third-parties where a valid
                                email address is required. In this section, I will show you how to confirm user email
                                addresses before they can access your application. After an email verification with a
                                double opt-in send by email, users are authorized to use your application.</p>
                            <p>Because the Firebase API already provides this functionality, we can add it to our
                                Firebase class to make it available for our React application. Provide an optional
                                redirect URL that is used to navigate to the application after email confirmation:</p>
                            <div class="highlight" style="background: #2f1e2e">
                                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #e7e9db">...</span><span style="color: #815ba4">class</span> <span style="color: #06b6ef">Firebase</span> <span style="color: #e7e9db">{</span>
  <span style="color: #e7e9db">...</span>  <span style="color: #776e71">// *** Auth API ***</span>  <span style="color: #e7e9db">...</span><span style="background-color: #4f424c">  <span style="color: #06b6ef">doSendEmailVerification</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span>
</span><span style="background-color: #4f424c">    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">auth</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">currentUser</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">sendEmailVerification</span><span style="color: #e7e9db">({</span>
</span><span style="background-color: #4f424c">      <span style="color: #06b6ef">url</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">process</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">env</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">REACT_APP_CONFIRMATION_EMAIL_REDIRECT</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">    <span style="color: #e7e9db">});</span>
</span>
  <span style="color: #e7e9db">...</span>
<span style="color: #e7e9db">}</span><span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">Firebase</span><span style="color: #e7e9db">;</span>
</code></pre>
                            </div>
                            <p>You can inline this URL, but also put it into your <em>.env</em> file(s). I prefer
                                environment variables for development (<em>.env.development</em>) and production
                                (<em>.env.production</em>). The development environment receives the localhost URL:</p>
                            <div class="highlight" style="background: #2f1e2e">
                                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #e7e9db">...</span><span style="background-color: #4f424c"><span style="color: #06b6ef">REACT_APP_CONFIRMATION_EMAIL_REDIRECT</span><span style="color: #5bc4bf">=</span><span style="color: #06b6ef">http</span><span style="color: #5bc4bf">:</span><span style="color: #776e71">//localhost:3000</span>
</span></code></pre>
                            </div>
                            <p>And the production environment receives an actual domain:</p>
                            <div class="highlight" style="background: #2f1e2e">
                                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #e7e9db">...</span><span style="background-color: #4f424c"><span style="color: #06b6ef">REACT_APP_CONFIRMATION_EMAIL_REDIRECT</span><span style="color: #5bc4bf">=</span><span style="color: #06b6ef">https</span><span style="color: #5bc4bf">:</span><span style="color: #776e71">//mydomain.com</span>
</span></code></pre>
                            </div>
                            <p>That&rsquo;s all we need to do for the API. The best place to guide users through the
                                email verification is during email and password sign-up:</p>
                            <div class="highlight" style="background: #2f1e2e">
                                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #e7e9db">...</span><span style="color: #815ba4">class</span> <span style="color: #06b6ef">SignUpFormBase</span> <span style="color: #815ba4">extends</span> <span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">{</span>
  <span style="color: #e7e9db">...</span>  <span style="color: #06b6ef">onSubmit</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">event</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
    <span style="color: #e7e9db">...</span>    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">firebase</span>
      <span style="color: #e7e9db">.</span><span style="color: #06b6ef">doCreateUserWithEmailAndPassword</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">email</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">passwordOne</span><span style="color: #e7e9db">)</span>
      <span style="color: #e7e9db">.</span><span style="color: #06b6ef">then</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">authUser</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
        <span style="color: #776e71">// Create a user in your Firebase realtime database</span>
        <span style="color: #815ba4">return</span> <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">firebase</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">user</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">authUser</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">user</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">uid</span><span style="color: #e7e9db">).</span><span style="color: #06b6ef">set</span><span style="color: #e7e9db">({</span>
          <span style="color: #06b6ef">username</span><span style="color: #e7e9db">,</span>
          <span style="color: #06b6ef">email</span><span style="color: #e7e9db">,</span>
          <span style="color: #06b6ef">roles</span><span style="color: #e7e9db">,</span>
        <span style="color: #e7e9db">});</span>
      <span style="color: #e7e9db">})</span>
<span style="background-color: #4f424c">      <span style="color: #e7e9db">.</span><span style="color: #06b6ef">then</span><span style="color: #e7e9db">(()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
</span><span style="background-color: #4f424c">        <span style="color: #815ba4">return</span> <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">firebase</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">doSendEmailVerification</span><span style="color: #e7e9db">();</span>
</span><span style="background-color: #4f424c">      <span style="color: #e7e9db">})</span>
</span>      <span style="color: #e7e9db">.</span><span style="color: #06b6ef">then</span><span style="color: #e7e9db">(()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
        <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">setState</span><span style="color: #e7e9db">({</span> <span style="color: #e7e9db">...</span><span style="color: #06b6ef">INITIAL_STATE</span> <span style="color: #e7e9db">});</span>
        <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">history</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">push</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">ROUTES</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">HOME</span><span style="color: #e7e9db">);</span>
      <span style="color: #e7e9db">})</span>
      <span style="color: #e7e9db">.</span><span style="color: #815ba4">catch</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">error</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
        <span style="color: #e7e9db">...</span>
      <span style="color: #e7e9db">});</span>    <span style="color: #06b6ef">event</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">preventDefault</span><span style="color: #e7e9db">();</span>
  <span style="color: #e7e9db">};</span>  <span style="color: #e7e9db">...</span>
<span style="color: #e7e9db">}</span><span style="color: #e7e9db">...</span>
</code></pre>
                            </div>
                            <p>Users will receive a verification email when they register for your application. To find
                                out if a user has a verified email, you can retrieve this information from the
                                authenticated user in your Firebase class:</p>
                            <div class="highlight" style="background: #2f1e2e">
                                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #e7e9db">...</span><span style="color: #815ba4">class</span> <span style="color: #06b6ef">Firebase</span> <span style="color: #e7e9db">{</span>
  <span style="color: #e7e9db">...</span>  <span style="color: #776e71">// *** Merge Auth and DB User API *** //</span>  <span style="color: #06b6ef">onAuthUserListener</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">(</span><span style="color: #06b6ef">next</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">fallback</span><span style="color: #e7e9db">)</span> <span style="color: #5bc4bf">=&gt;</span>
    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">auth</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">onAuthStateChanged</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">authUser</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
      <span style="color: #815ba4">if</span> <span style="color: #e7e9db">(</span><span style="color: #06b6ef">authUser</span><span style="color: #e7e9db">)</span> <span style="color: #e7e9db">{</span>
        <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">user</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">authUser</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">uid</span><span style="color: #e7e9db">)</span>
          <span style="color: #e7e9db">.</span><span style="color: #06b6ef">once</span><span style="color: #e7e9db">(</span><span style="color: #48b685">&#39;value&#39;</span><span style="color: #e7e9db">)</span>
          <span style="color: #e7e9db">.</span><span style="color: #06b6ef">then</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">snapshot</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
            <span style="color: #815ba4">const</span> <span style="color: #06b6ef">dbUser</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">snapshot</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">val</span><span style="color: #e7e9db">();</span>            <span style="color: #776e71">// default empty roles</span>
            <span style="color: #815ba4">if</span> <span style="color: #e7e9db">(</span><span style="color: #5bc4bf">!</span><span style="color: #06b6ef">dbUser</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">roles</span><span style="color: #e7e9db">)</span> <span style="color: #e7e9db">{</span>
              <span style="color: #06b6ef">dbUser</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">roles</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">{};</span>
            <span style="color: #e7e9db">}</span>            <span style="color: #776e71">// merge auth and db user</span>
            <span style="color: #06b6ef">authUser</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">{</span>
              <span style="color: #06b6ef">uid</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">authUser</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">uid</span><span style="color: #e7e9db">,</span>
              <span style="color: #06b6ef">email</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">authUser</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">email</span><span style="color: #e7e9db">,</span>
<span style="background-color: #4f424c">              <span style="color: #06b6ef">emailVerified</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">authUser</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">emailVerified</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">              <span style="color: #06b6ef">providerData</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">authUser</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">providerData</span><span style="color: #e7e9db">,</span>
</span>              <span style="color: #e7e9db">...</span><span style="color: #06b6ef">dbUser</span><span style="color: #e7e9db">,</span>
            <span style="color: #e7e9db">};</span>            <span style="color: #06b6ef">next</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">authUser</span><span style="color: #e7e9db">);</span>
          <span style="color: #e7e9db">});</span>
      <span style="color: #e7e9db">}</span> <span style="color: #815ba4">else</span> <span style="color: #e7e9db">{</span>
        <span style="color: #06b6ef">fallback</span><span style="color: #e7e9db">();</span>
      <span style="color: #e7e9db">}</span>
    <span style="color: #e7e9db">});</span>    <span style="color: #e7e9db">...</span>
<span style="color: #e7e9db">}</span><span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">Firebase</span><span style="color: #e7e9db">;</span>
</code></pre>
                            </div>
                            <p>To protect your routes from users who have no verified email address, we will do it with
                                a new higher-order component in <em>src/components/Session/withEmailVerification.js</em>
                                that has access to Firebase and the authenticated user:</p>
                            <p>
                                <div class="highlight" style="background: #2f1e2e">
                                    <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">AuthUserContext</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;./context&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">withFirebase</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../Firebase&#39;</span><span style="color: #e7e9db">;</span><span style="color: #815ba4">const</span> <span style="color: #06b6ef">withEmailVerification</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">Component</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
  <span style="color: #815ba4">class</span> <span style="color: #06b6ef">WithEmailVerification</span> <span style="color: #815ba4">extends</span> <span style="color: #06b6ef">React</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">{</span>
    <span style="color: #06b6ef">render</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
      <span style="color: #815ba4">return</span> <span style="color: #e7e9db">(</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">AuthUserContext</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">Consumer</span><span style="color: #5bc4bf">&gt;</span>
          <span style="color: #e7e9db">{</span><span style="color: #06b6ef">authUser</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">{...</span><span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">}</span> <span style="color: #5bc4bf">/&gt;</span><span style="color: #e7e9db">}</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/AuthUserContext.Consumer&gt;</span>
      <span style="color: #e7e9db">);</span>
    <span style="color: #e7e9db">}</span>
  <span style="color: #e7e9db">}</span>  <span style="color: #815ba4">return</span> <span style="color: #06b6ef">withFirebase</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">WithEmailVerification</span><span style="color: #e7e9db">);</span>
<span style="color: #e7e9db">};</span><span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">withEmailVerification</span><span style="color: #e7e9db">;</span>
</code></pre>
                                </div>
                            </p>
                            <p>Add a function in this file that checks if the authenticated user has a verified email
                                and an email/password sign in on associated with it. If the user has only social logins,
                                it doesn&rsquo;t matter if the email is not verified.</p>
                            <div class="highlight" style="background: #2f1e2e">
                                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="background-color: #4f424c"><span style="color: #815ba4">const</span> <span style="color: #06b6ef">needsEmailVerification</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">authUser</span> <span style="color: #5bc4bf">=&gt;</span>
</span><span style="background-color: #4f424c">  <span style="color: #06b6ef">authUser</span> <span style="color: #5bc4bf">&amp;&amp;</span>
</span><span style="background-color: #4f424c">  <span style="color: #5bc4bf">!</span><span style="color: #06b6ef">authUser</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">emailVerified</span> <span style="color: #5bc4bf">&amp;&amp;</span>
</span><span style="background-color: #4f424c">  <span style="color: #06b6ef">authUser</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">providerData</span>
</span><span style="background-color: #4f424c">    <span style="color: #e7e9db">.</span><span style="color: #06b6ef">map</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">provider</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #06b6ef">provider</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">providerId</span><span style="color: #e7e9db">)</span>
</span><span style="background-color: #4f424c">    <span style="color: #e7e9db">.</span><span style="color: #06b6ef">includes</span><span style="color: #e7e9db">(</span><span style="color: #48b685">&#39;password&#39;</span><span style="color: #e7e9db">);</span>
</span></code></pre>
                            </div>
                            <p>If this is true, don&rsquo;t render the component passed to this higher-order component,
                                but a message that reminds users to verify their email addresses.</p>
                            <div class="highlight" style="background: #2f1e2e">
                                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #e7e9db">...</span><span style="color: #815ba4">const</span> <span style="color: #06b6ef">withEmailVerification</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">Component</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
  <span style="color: #815ba4">class</span> <span style="color: #06b6ef">WithEmailVerification</span> <span style="color: #815ba4">extends</span> <span style="color: #06b6ef">React</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">{</span>
<span style="background-color: #4f424c">    <span style="color: #06b6ef">onSendEmailVerification</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
</span><span style="background-color: #4f424c">      <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">firebase</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">doSendEmailVerification</span><span style="color: #e7e9db">();</span>
</span><span style="background-color: #4f424c">    <span style="color: #e7e9db">}</span>
</span>
    <span style="color: #06b6ef">render</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
      <span style="color: #815ba4">return</span> <span style="color: #e7e9db">(</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">AuthUserContext</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">Consumer</span><span style="color: #5bc4bf">&gt;</span>
          <span style="color: #e7e9db">{</span><span style="color: #06b6ef">authUser</span> <span style="color: #5bc4bf">=&gt;</span>
<span style="background-color: #4f424c">            <span style="color: #06b6ef">needsEmailVerification</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">authUser</span><span style="color: #e7e9db">)</span> <span style="color: #5bc4bf">?</span> <span style="color: #e7e9db">(</span>
</span><span style="background-color: #4f424c">              <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">div</span><span style="color: #5bc4bf">&gt;</span>
</span><span style="background-color: #4f424c">                <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">p</span><span style="color: #5bc4bf">&gt;</span>
</span><span style="background-color: #4f424c">                  <span style="color: #06b6ef">Verify</span> <span style="color: #06b6ef">your</span> <span style="color: #06b6ef">E</span><span style="color: #5bc4bf">-</span><span style="color: #06b6ef">Mail</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">Check</span> <span style="color: #06b6ef">you</span> <span style="color: #06b6ef">E</span><span style="color: #5bc4bf">-</span><span style="color: #06b6ef">Mails</span> <span style="color: #e7e9db">(</span><span style="color: #06b6ef">Spam</span> <span style="color: #06b6ef">folder</span>
</span><span style="background-color: #4f424c">                  <span style="color: #06b6ef">included</span><span style="color: #e7e9db">)</span> <span style="color: #815ba4">for</span> <span style="color: #06b6ef">a</span> <span style="color: #06b6ef">confirmation</span> <span style="color: #06b6ef">E</span><span style="color: #5bc4bf">-</span><span style="color: #06b6ef">Mail</span> <span style="color: #06b6ef">or</span> <span style="color: #06b6ef">send</span>
</span><span style="background-color: #4f424c">                  <span style="color: #06b6ef">another</span> <span style="color: #06b6ef">confirmation</span> <span style="color: #06b6ef">E</span><span style="color: #5bc4bf">-</span><span style="color: #06b6ef">Mail</span><span style="color: #e7e9db">.</span>
</span><span style="background-color: #4f424c">                <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/p&gt;</span>
</span><span style="background-color: #4f424c">
</span><span style="background-color: #4f424c">                <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">button</span>
</span><span style="background-color: #4f424c">                  <span style="color: #06b6ef">type</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;button&quot;</span>
</span><span style="background-color: #4f424c">                  <span style="color: #06b6ef">onClick</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">onSendEmailVerification</span><span style="color: #e7e9db">}</span>
</span><span style="background-color: #4f424c">                <span style="color: #5bc4bf">&gt;</span>
</span><span style="background-color: #4f424c">                  <span style="color: #06b6ef">Send</span> <span style="color: #06b6ef">confirmation</span> <span style="color: #06b6ef">E</span><span style="color: #5bc4bf">-</span><span style="color: #06b6ef">Mail</span>
</span><span style="background-color: #4f424c">                <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/button&gt;</span>
</span><span style="background-color: #4f424c">              <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/div&gt;</span>
</span><span style="background-color: #4f424c">            <span style="color: #e7e9db">)</span> <span style="color: #5bc4bf">:</span> <span style="color: #e7e9db">(</span>
</span><span style="background-color: #4f424c">              <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">{...</span><span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">}</span> <span style="color: #5bc4bf">/&gt;</span>
</span><span style="background-color: #4f424c">            <span style="color: #e7e9db">)</span>
</span>          <span style="color: #e7e9db">}</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/AuthUserContext.Consumer&gt;</span>
      <span style="color: #e7e9db">);</span>
    <span style="color: #e7e9db">}</span>
  <span style="color: #e7e9db">}</span>  <span style="color: #815ba4">return</span> <span style="color: #06b6ef">withFirebase</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">WithEmailVerification</span><span style="color: #e7e9db">);</span>
<span style="color: #e7e9db">};</span><span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">withEmailVerification</span><span style="color: #e7e9db">;</span>
</code></pre>
                            </div>
                            <p>Optionally, we can provide a button to resend a verification email to the user.
                                Let&rsquo;s improve the user experience. After the button is clicked to resend the
                                verification email, users should receive feedback, and be prohibited from sending
                                another email. First, add a local state to the higher-order component that tracks
                                whether the button was clicked:</p>
                            <p>
                                <div class="highlight" style="background: #2f1e2e">
                                    <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #e7e9db">...</span><span style="color: #815ba4">const</span> <span style="color: #06b6ef">withEmailVerification</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">Component</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
  <span style="color: #815ba4">class</span> <span style="color: #06b6ef">WithEmailVerification</span> <span style="color: #815ba4">extends</span> <span style="color: #06b6ef">React</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">{</span>
<span style="background-color: #4f424c">    <span style="color: #06b6ef">constructor</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">)</span> <span style="color: #e7e9db">{</span>
</span><span style="background-color: #4f424c">      <span style="color: #815ba4">super</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">);</span>
</span><span style="background-color: #4f424c">
</span><span style="background-color: #4f424c">      <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">state</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">isSent</span><span style="color: #5bc4bf">:</span> <span style="color: #815ba4">false</span> <span style="color: #e7e9db">};</span>
</span><span style="background-color: #4f424c">    <span style="color: #e7e9db">}</span>
</span>
    <span style="color: #06b6ef">onSendEmailVerification</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
      <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">firebase</span>
        <span style="color: #e7e9db">.</span><span style="color: #06b6ef">doSendEmailVerification</span><span style="color: #e7e9db">()</span>
<span style="background-color: #4f424c">        <span style="color: #e7e9db">.</span><span style="color: #06b6ef">then</span><span style="color: #e7e9db">(()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">setState</span><span style="color: #e7e9db">({</span> <span style="color: #06b6ef">isSent</span><span style="color: #5bc4bf">:</span> <span style="color: #815ba4">true</span> <span style="color: #e7e9db">}));</span>
</span>    <span style="color: #e7e9db">};</span>    <span style="color: #e7e9db">...</span>
  <span style="color: #e7e9db">}</span>  <span style="color: #815ba4">return</span> <span style="color: #06b6ef">withFirebase</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">WithEmailVerification</span><span style="color: #e7e9db">);</span>
<span style="color: #e7e9db">};</span><span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">withEmailVerification</span><span style="color: #e7e9db">;</span>
</code></pre>
                                </div>
                            </p>
                            <p>Second, show another message with a conditional rendering if a user has sent another
                                verification email:</p>
                            <div class="highlight" style="background: #2f1e2e">
                                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #e7e9db">...</span><span style="color: #815ba4">const</span> <span style="color: #06b6ef">withEmailVerification</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">Component</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
  <span style="color: #815ba4">class</span> <span style="color: #06b6ef">WithEmailVerification</span> <span style="color: #815ba4">extends</span> <span style="color: #06b6ef">React</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">{</span>    <span style="color: #e7e9db">...</span>    <span style="color: #06b6ef">render</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
      <span style="color: #815ba4">return</span> <span style="color: #e7e9db">(</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">AuthUserContext</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">Consumer</span><span style="color: #5bc4bf">&gt;</span>
          <span style="color: #e7e9db">{</span><span style="color: #06b6ef">authUser</span> <span style="color: #5bc4bf">=&gt;</span>
            <span style="color: #06b6ef">needsEmailVerification</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">authUser</span><span style="color: #e7e9db">)</span> <span style="color: #5bc4bf">?</span> <span style="color: #e7e9db">(</span>
              <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">div</span><span style="color: #5bc4bf">&gt;</span>
<span style="background-color: #4f424c">                <span style="color: #e7e9db">{</span><span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">state</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">isSent</span> <span style="color: #5bc4bf">?</span> <span style="color: #e7e9db">(</span>
</span><span style="background-color: #4f424c">                  <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">p</span><span style="color: #5bc4bf">&gt;</span>
</span><span style="background-color: #4f424c">                    <span style="color: #06b6ef">E</span><span style="color: #5bc4bf">-</span><span style="color: #06b6ef">Mail</span> <span style="color: #06b6ef">confirmation</span> <span style="color: #06b6ef">sent</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">Check</span> <span style="color: #06b6ef">you</span> <span style="color: #06b6ef">E</span><span style="color: #5bc4bf">-</span><span style="color: #06b6ef">Mails</span> <span style="color: #e7e9db">(</span><span style="color: #06b6ef">Spam</span>
</span><span style="background-color: #4f424c">                    <span style="color: #06b6ef">folder</span> <span style="color: #06b6ef">included</span><span style="color: #e7e9db">)</span> <span style="color: #815ba4">for</span> <span style="color: #06b6ef">a</span> <span style="color: #06b6ef">confirmation</span> <span style="color: #06b6ef">E</span><span style="color: #5bc4bf">-</span><span style="color: #06b6ef">Mail</span><span style="color: #e7e9db">.</span>
</span><span style="background-color: #4f424c">                    <span style="color: #06b6ef">Refresh</span> <span style="color: #815ba4">this</span> <span style="color: #06b6ef">page</span> <span style="color: #06b6ef">once</span> <span style="color: #06b6ef">you</span> <span style="color: #06b6ef">confirmed</span> <span style="color: #06b6ef">your</span> <span style="color: #06b6ef">E</span><span style="color: #5bc4bf">-</span><span style="color: #06b6ef">Mail</span><span style="color: #e7e9db">.</span>
</span><span style="background-color: #4f424c">                  <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/p&gt;</span>
</span><span style="background-color: #4f424c">                <span style="color: #e7e9db">)</span> <span style="color: #5bc4bf">:</span> <span style="color: #e7e9db">(</span>
</span>                  <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">p</span><span style="color: #5bc4bf">&gt;</span>
                    <span style="color: #06b6ef">Verify</span> <span style="color: #06b6ef">your</span> <span style="color: #06b6ef">E</span><span style="color: #5bc4bf">-</span><span style="color: #06b6ef">Mail</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">Check</span> <span style="color: #06b6ef">you</span> <span style="color: #06b6ef">E</span><span style="color: #5bc4bf">-</span><span style="color: #06b6ef">Mails</span> <span style="color: #e7e9db">(</span><span style="color: #06b6ef">Spam</span> <span style="color: #06b6ef">folder</span>
                    <span style="color: #06b6ef">included</span><span style="color: #e7e9db">)</span> <span style="color: #815ba4">for</span> <span style="color: #06b6ef">a</span> <span style="color: #06b6ef">confirmation</span> <span style="color: #06b6ef">E</span><span style="color: #5bc4bf">-</span><span style="color: #06b6ef">Mail</span> <span style="color: #06b6ef">or</span> <span style="color: #06b6ef">send</span>
                    <span style="color: #06b6ef">another</span> <span style="color: #06b6ef">confirmation</span> <span style="color: #06b6ef">E</span><span style="color: #5bc4bf">-</span><span style="color: #06b6ef">Mail</span><span style="color: #e7e9db">.</span>
                  <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/p&gt;</span>
<span style="background-color: #4f424c">                <span style="color: #e7e9db">)}</span>
</span>
                <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">button</span>
                  <span style="color: #06b6ef">type</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;button&quot;</span>
                  <span style="color: #06b6ef">onClick</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">onSendEmailVerification</span><span style="color: #e7e9db">}</span>
<span style="background-color: #4f424c">                  <span style="color: #06b6ef">disabled</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">state</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">isSent</span><span style="color: #e7e9db">}</span>
</span>                <span style="color: #5bc4bf">&gt;</span>
                  <span style="color: #06b6ef">Send</span> <span style="color: #06b6ef">confirmation</span> <span style="color: #06b6ef">E</span><span style="color: #5bc4bf">-</span><span style="color: #06b6ef">Mail</span>
                <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/button&gt;</span>
              <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/div&gt;</span>
            <span style="color: #e7e9db">)</span> <span style="color: #5bc4bf">:</span> <span style="color: #e7e9db">(</span>
              <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">{...</span><span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">}</span> <span style="color: #5bc4bf">/&gt;</span>
            <span style="color: #e7e9db">)</span>
          <span style="color: #e7e9db">}</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/AuthUserContext.Consumer&gt;</span>
      <span style="color: #e7e9db">);</span>
    <span style="color: #e7e9db">}</span>
  <span style="color: #e7e9db">}</span>  <span style="color: #815ba4">return</span> <span style="color: #06b6ef">withFirebase</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">WithEmailVerification</span><span style="color: #e7e9db">);</span>
<span style="color: #e7e9db">};</span><span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">withEmailVerification</span><span style="color: #e7e9db">;</span>
</code></pre>
                            </div>
                            <p>Lastly, make the new higher-order component available in your Session folder&rsquo;s
                                <em>index.js</em> file:</p>
                            <p>
                                <div class="highlight" style="background: #2f1e2e">
                                    <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">AuthUserContext</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;./context&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #06b6ef">withAuthentication</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;./withAuthentication&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #06b6ef">withAuthorization</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;./withAuthorization&#39;</span><span style="color: #e7e9db">;</span>
<span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #06b6ef">withEmailVerification</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;./withEmailVerification&#39;</span><span style="color: #e7e9db">;</span>
</span>
<span style="color: #815ba4">export</span> <span style="color: #e7e9db">{</span>
  <span style="color: #06b6ef">AuthUserContext</span><span style="color: #e7e9db">,</span>
  <span style="color: #06b6ef">withAuthentication</span><span style="color: #e7e9db">,</span>
  <span style="color: #06b6ef">withAuthorization</span><span style="color: #e7e9db">,</span>
<span style="background-color: #4f424c">  <span style="color: #06b6ef">withEmailVerification</span><span style="color: #e7e9db">,</span>
</span><span style="color: #e7e9db">};</span>
</code></pre>
                                </div>
                            </p>
                            <p>Send a confirmation email once a user signs up with a email/password combination. You
                                also have a higher-order component used for authorization and optionally resending a
                                confirmation email. Next, secure all pages/routes that should be only accessible with a
                                confirmed email. Let&rsquo;s begin with the home page:</p>
                            <div class="highlight" style="background: #2f1e2e">
                                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>
<span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">compose</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;recompose&#39;</span><span style="color: #e7e9db">;</span>
</span>
<span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">withAuthorization</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">withEmailVerification</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../Session&#39;</span><span style="color: #e7e9db">;</span>
</span>
<span style="color: #815ba4">const</span> <span style="color: #06b6ef">HomePage</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">(</span>
  <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">div</span><span style="color: #5bc4bf">&gt;</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">h1</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">Home</span> <span style="color: #06b6ef">Page</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/h1&gt;</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">p</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">The</span> <span style="color: #06b6ef">Home</span> <span style="color: #06b6ef">Page</span> <span style="color: #06b6ef">is</span> <span style="color: #06b6ef">accessible</span> <span style="color: #06b6ef">by</span> <span style="color: #06b6ef">every</span> <span style="color: #06b6ef">signed</span> <span style="color: #815ba4">in</span> <span style="color: #06b6ef">user</span><span style="color: #e7e9db">.</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/p&gt;</span>
  <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/div&gt;</span>
<span style="color: #e7e9db">);</span><span style="color: #815ba4">const</span> <span style="color: #06b6ef">condition</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">authUser</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #5bc4bf">!!</span><span style="color: #06b6ef">authUser</span><span style="color: #e7e9db">;</span><span style="background-color: #4f424c"><span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">compose</span><span style="color: #e7e9db">(</span>
</span><span style="background-color: #4f424c">  <span style="color: #06b6ef">withEmailVerification</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">  <span style="color: #06b6ef">withAuthorization</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">condition</span><span style="color: #e7e9db">),</span>
</span><span style="background-color: #4f424c"><span style="color: #e7e9db">)(</span><span style="color: #06b6ef">HomePage</span><span style="color: #e7e9db">);</span>
</span></code></pre>
                            </div>
                            <p>Next the admin page:</p>
                            <div class="highlight" style="background: #2f1e2e">
                                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span><span style="color: #e7e9db">,</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">compose</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;recompose&#39;</span><span style="color: #e7e9db">;</span><span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">withFirebase</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../Firebase&#39;</span><span style="color: #e7e9db">;</span>
<span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">withAuthorization</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">withEmailVerification</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../Session&#39;</span><span style="color: #e7e9db">;</span>
</span><span style="color: #815ba4">import</span> <span style="color: #5bc4bf">*</span> <span style="color: #06b6ef">as</span> <span style="color: #06b6ef">ROLES</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../../constants/roles&#39;</span><span style="color: #e7e9db">;</span><span style="color: #e7e9db">...</span><span style="color: #815ba4">const</span> <span style="color: #06b6ef">condition</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">authUser</span> <span style="color: #5bc4bf">=&gt;</span>
  <span style="color: #06b6ef">authUser</span> <span style="color: #5bc4bf">&amp;&amp;</span> <span style="color: #5bc4bf">!!</span><span style="color: #06b6ef">authUser</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">roles</span><span style="color: #e7e9db">[</span><span style="color: #06b6ef">ROLES</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">ADMIN</span><span style="color: #e7e9db">];</span><span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">compose</span><span style="color: #e7e9db">(</span>
<span style="background-color: #4f424c">  <span style="color: #06b6ef">withEmailVerification</span><span style="color: #e7e9db">,</span>
</span>  <span style="color: #06b6ef">withAuthorization</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">condition</span><span style="color: #e7e9db">),</span>
  <span style="color: #06b6ef">withFirebase</span><span style="color: #e7e9db">,</span>
<span style="color: #e7e9db">)(</span><span style="color: #06b6ef">AdminPage</span><span style="color: #e7e9db">);</span>
</code></pre>
                            </div>
                            <p>And the account page:</p>
                            <div class="highlight" style="background: #2f1e2e">
                                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span><span style="color: #e7e9db">,</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>
<span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">compose</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;recompose&#39;</span><span style="color: #e7e9db">;</span>
</span>
<span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span>
  <span style="color: #06b6ef">AuthUserContext</span><span style="color: #e7e9db">,</span>
  <span style="color: #06b6ef">withAuthorization</span><span style="color: #e7e9db">,</span>
<span style="background-color: #4f424c">  <span style="color: #06b6ef">withEmailVerification</span><span style="color: #e7e9db">,</span>
</span><span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../Session&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">withFirebase</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../Firebase&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">PasswordForgetForm</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../PasswordForget&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #06b6ef">PasswordChangeForm</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../PasswordChange&#39;</span><span style="color: #e7e9db">;</span><span style="color: #e7e9db">...</span><span style="color: #815ba4">const</span> <span style="color: #06b6ef">condition</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">authUser</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #5bc4bf">!!</span><span style="color: #06b6ef">authUser</span><span style="color: #e7e9db">;</span><span style="background-color: #4f424c"><span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">compose</span><span style="color: #e7e9db">(</span>
</span><span style="background-color: #4f424c">  <span style="color: #06b6ef">withEmailVerification</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">  <span style="color: #06b6ef">withAuthorization</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">condition</span><span style="color: #e7e9db">),</span>
</span><span style="background-color: #4f424c"><span style="color: #e7e9db">)(</span><span style="color: #06b6ef">AccountPage</span><span style="color: #e7e9db">);</span>
</span></code></pre>
                            </div>
                            <p>All the sensible routes for authenticated users now require a confirmed email. Finally,
                                your application can be only used by users with real email addresses.</p>
                            <h3 id="exercises">Exercises:</h3>
                            <ul>
                                <li>Familiarize yourself with the new flow by deleting your user from the Authentication
                                    and Realtime Databases and sign up again.<ul>
                                        <li>For example, sign up with a social login instead of the email/password
                                            combination, but activate the email/password sign in method later on the
                                            account page.</li>
                                        <li>This is in general a good way to purge the database to start from a clean
                                            slate if anything feels buggy.</li>
                                    </ul>
                                </li>
                                <li>Implement the &ldquo;Send confirmation E-Mail&rdquo; button in a way that it&rsquo;s
                                    not shown the first time a user signs up; otherwise the user may be tempted to click
                                    the button right away and receives a second confirmation E-Mail.</li>
                                <li>Read more about <a target="_blank" rel="noopener noreferrer"
                                        href="https://firebase.google.com/docs/auth/web/manage-users">Firebase&rsquo;s
                                        verification E-Mail</a></li>
                                <li>Read more about <a target="_blank" rel="noopener noreferrer"
                                        href="https://firebase.google.com/docs/auth/web/passing-state-in-email-actions">additional
                                        configuration for the verification E-Mail</a></li>
                                <li>Confirm your <a target="_blank" rel="noopener noreferrer"
                                        href="http://bit.ly/2Vqtfxt">source code for the last section</a></li>
                            </ul>

                            

                            <div class="box-inline col-md-12">
                                <div class="col-md-12 text-center">
                                    <h2 class="newsletter">The Road to learn React</h2>

                                    <div class="col-md-4">
                                        <img class="img-lazy img-responsive" data-lazy-src="//img/page/cover.png">
                                    </div>

                                    <p class="lead">
                                        Build a Hacker News App along the way. No setup configuration. No tooling. No
                                        Redux. Plain React in 200+ pages of learning material. Learn React like
                                        <strong>50.000+ readers</strong>.
                                    </p>
                                    <a class="btn btn-template-main" href="https://roadtoreact.com" target="_blank"
                                        rel="noopener noreferrer">
                                        Get the Book for free <i class="fa fa-chevron-right"></i>
                                    </a>

                                    <div>
                                        <a href="https://amzn.to/2QY2ONp" target="_blank" rel="noopener noreferrer">
                                            Get it from Amazon
                                        </a>
                                    </div>

                                </div>
                            </div>

                        </div>

                        
                    </article>
                </div>
            </div>

        </div>
        
        <footer id="subfooter">
            <div class="container">
                <div class="col-md-5 col-sm-6">
                    <h4>Recent posts</h4>
                    <div class="blog-entries">

                        <div class="item same-height-row clearfix">
                            <div class="article same-height-always">
                                <a href="../redux-vs-usereducer/index.html">

                                    <img data-lazy-src="//img/posts/redux-vs-usereducer/banner.jpg"
                                        data-is-thumb="is-thumb" class="img-lazy img-responsive"
                                        alt="React&#39;s useReducer vs Redux">

                                </a>
                            </div>
                            <div class="name same-height-always">
                                <h5><a href="../redux-vs-usereducer/index.html">React&#39;s useReducer vs Redux</a></h5>
                            </div>
                        </div>

                        <div class="item same-height-row clearfix">
                            <div class="article same-height-always">
                                <a href="../publish-npm-package-node/index.html">

                                    <img data-lazy-src="//img/posts/publish-npm-package-node/banner.jpg"
                                        data-is-thumb="is-thumb" class="img-lazy img-responsive"
                                        alt="How to publish a npm package?">

                                </a>
                            </div>
                            <div class="name same-height-always">
                                <h5><a href="../publish-npm-package-node/index.html">How to publish a npm package?</a>
                                </h5>
                            </div>
                        </div>

                        <div class="item same-height-row clearfix">
                            <div class="article same-height-always">
                                <a href="../react-scroll-to-item/index.html">

                                    <img data-lazy-src="//img/posts/react-scroll-to-item/banner.jpg"
                                        data-is-thumb="is-thumb" class="img-lazy img-responsive"
                                        alt="How to Scroll to Item in React?">

                                </a>
                            </div>
                            <div class="name same-height-always">
                                <h5><a href="../react-scroll-to-item/index.html">How to Scroll to Item in React?</a>
                                </h5>
                            </div>
                        </div>

                    </div>
                    <hr class="hidden-md hidden-lg hidden-sm">
                </div>

                <div class="col-md-5 col-md-offset-2 col-sm-6">
                    <h4>About Me</h4>
                    <div class="blog-entries">
                        <div class="item same-height-row clearfix">
                            <div class="profile same-height-always">
                                <img class="img-lazy img-responsive" data-lazy-src="//img/page/profile.jpg"
                                    alt="profile">
                            </div>
                            <div class="name same-height-always">
                                <p>
                                    Hi, I'm Chris - a Midvale, Utah-based consulting software developer. Find out more
                                    <a href="../about/index.html">about me</a>, <a
                                        href="../work-with-me/index.html">work with me</a>, or have a look at my social
                                    media profiles below.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

            </div>

        </footer>
        <footer id="copyright">
            <div class="container">
                <div class="row">
                    <div class="col-md-4">
                        <ul class="info list-inline quicklinks pull-left">

                            <li>© Chris Paul</li>

                        </ul>
                    </div>
                    
                    <div class="col-md-4">
                        <ul class="info list-inline quicklinks pull-right">

                            <li><a aria-label="quicklinks" href="../legal/index.html">Legal Notice</a></li>

                        </ul>
                    </div>
                </div>
            </div>
        </footer>
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
    <script src="../js/script.js"></script>
</body>

</html>