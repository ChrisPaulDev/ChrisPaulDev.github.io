<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="robots" content="all,follow">
    <meta name="googlebot" content="index,follow,snippet,archive">
    <meta name="viewport" content="width=device-width, initial-scale=1">



    <title>
        Accept Stripe Payments with React and Express - CPaul
    </title>

    <meta name="author" content="" />
    <meta name="description"
        content="Ever wondered how to integrate Stripe in your React application? This tutorial guides you through the whole setup process from using a Stripe checkout form on the client-side to setting up an Express payment server. Afterward you are ready to receive secure credit card payments via Stripe in your React.js application ...">


    <meta name="theme-color" content="#38bb6c" />

    <meta name="generator" content="Hugo 0.41" />
    <link href="https://cdn-images.mailchimp.com/embedcode/horizontal-slim-10_7.css" rel="stylesheet" type="text/css">

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
    <link href="../css/bootstrap.default.css" rel="stylesheet" id="theme-stylesheet">
    <link href="../css/customizations.css" rel="stylesheet">

    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <link rel="shortcut icon" href="../img/favicon/favicon.ico" type="image/x-icon" />
    <link rel="apple-touch-icon" href="../img/favicon/apple-touch-icon.png" />
    <link rel="manifest" href="../img/favicon/manifest.json">
    <link rel="mask-icon" href="../img/favicon/safari-pinned-tab.svg" color="#5bbad5">

    <link rel="alternate" href="../index.xml" type="application/rss+xml" title="CPaul">

    <meta itemprop="name" content="Accept Stripe Payments with React and Express">
    <meta itemprop="description"
        content="Ever wondered how to integrate Stripe in your React application? This tutorial guides you through the whole setup process from using a Stripe checkout form on the client-side to setting up an Express payment server. Afterward you are ready to receive secure credit card payments via Stripe in your React.js application ...">
    <meta itemprop="image" content="https://chrispaul.dev/img/posts/react-express-stripe-payment/banner_640.jpg">
    <meta itemprop="keywords"
        content="angular,apollo,d3,graphql,growth,javascript,machine-learning,mobx,node,react,reason,redux,tooling,vue,web-development,angular,apollo,d3,graphql,growth,javascript,machine-learning,mobx,node,react,reason,redux,tooling,web-development," />


    <meta itemprop="wordCount" content="2343">

    <meta name="keywords" content="react express stripe">

    <meta property="og:title" content="Accept Stripe Payments with React and Express - CPaul">


    <meta property="og:description"
        content="Ever wondered how to integrate Stripe in your React application? This tutorial guides you through the whole setup process from using a Stripe checkout form on the client-side to setting up an Express payment server. Afterward you are ready to receive secure credit card payments via Stripe in your React.js application ..." />


    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://chrispaul.dev/react-express-stripe-payment/" />
    <meta property="og:image" content="https://chrispaul.dev/img/posts/react-express-stripe-payment/banner_640.jpg" />



    <meta name="news_keywords" content="react express stripe" />



    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:image:src"
        content="https://chrispaul.dev/img/posts/react-express-stripe-payment/banner_640.jpg" />
    <meta name="twitter:title" content="Accept Stripe Payments with React and Express" />
    <meta name="twitter:description"
        content="Ever wondered how to integrate Stripe in your React application? This tutorial guides you through the whole setup process from using a Stripe checkout form on the client-side to setting up an Express payment server. Afterward you are ready to receive secure credit card payments via Stripe in your React.js application ..." />
    <meta name="twitter:site" content="@ChrisPaulDev" />
    



</head>


<body>

    <div id="all">

        <header>

            <div class="navbar-affixed-top" data-spy="affix" data-offset-top="200">

                <div class="navbar navbar-default yamm" role="navigation" id="navbar">

                    <div class="container">
                        <div class="navbar-header">
                            

                            <div class="navbar-buttons">
                                <button type="button" class="navbar-toggle btn-template-main" data-toggle="collapse"
                                    data-target="#navigation">
                                    <span class="sr-only">Toggle navigation</span>
                                    <i class="fa fa-align-justify"></i>
                                </button>
                            </div>
                        </div>


                        <div class="navbar-collapse collapse" id="navigation">
                            <ul class="nav navbar-nav navbar-right">

                                <li class="dropdown">

                                    <a href="../index.html">Blog</a>

                                </li>

                                <li class="dropdown">

                                    <a href="../work-with-me/index.html">Work with me</a>

                                </li>

                                <li class="dropdown">

                                    <a href="../about/index.html">About</a>

                                </li>

                                <li class="dropdown">

                                    <a style="color: #38bb6c" href="https://roadtoreact.com/">Books &amp; Courses</a>

                                </li>

                            </ul>
                        </div>


                        <div class="collapse clearfix" id="search">

                            <form class="navbar-form" role="search">
                                <div class="input-group">
                                    <input type="text" class="form-control" placeholder="Search">
                                    <span class="input-group-btn">

                                        <button type="submit" class="btn btn-template-main"><i
                                                class="fa fa-search"></i></button>

                                    </span>
                                </div>
                            </form>

                        </div>


                    </div>
                </div>


            </div>
        </header>

        

        



        <div class="hidden-xs">


            <section class="bar background-image-fixed-2 no-mb color-white text-center">
                <div class="dark-mask"></div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-12">
                            <h3 class="lead">Never miss an article about web development, JavaScript and self-growth.
                            </h3>
                            <h2 class="text-uppercase newsletter">Take Part</h2>
                        </div>

                        <div class="col-md-12">
                            <p class="text-center">
                                <div id="mc_embed_signup">
                                    <form action="https://www.getrevue.co/profile/rwieruch/add_subscriber" method="post"
                                        id="revue-form" name="revue-form" target="_blank">
                                        <div id="mc_embed_signup_scroll">
                                            <input class="email" placeholder="email address" type="email"
                                                name="member[email]" id="member_email">
                                            <div>
                                                <button type="submit" value="Subscribe" name="member[subscribe]"
                                                    id="member_submit"
                                                    class="btn btn-template-transparent-black btn-lg">
                                                    Subscribe
                                                </button>
                                            </div>
                                        </div>
                                    </form>
                                </div>

                            </p>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <div id="content">
            <div class="container">

                <div class="row">

                    <article class="col-md-8 col-md-offset-2" id="blog-post" itemprop="blogPosts" itemscope
                        itemtype="http://schema.org/BlogPosting">

                        <div id="post-content" itemprop="articleBody">

                            <header>
                                <h1 itemprop="name headline">Accept Stripe Payments with React and Express</h1>
                            </header>

                            

                            <p class="text-muted text-uppercase mb-small text-center">
                                <span itemprop="author publisher">

                                </span>


                                <time datetime="2017-06-20" itemprop="datePublished">
                                    June 20, 2017
                                </time>


                            </p>

                            <div>


                            </div>

                            <div class="post-image-primary">
                                <div class="pinterest-pinner-wrapper" itemscope
                                    itemtype="http://schema.org/ImageObject">
                                    <div class="pinterest-pinner">
                                        <a data-pin-do="buttonPin" data-pin-save="true" data-pin-tall="true"
                                            href="https://www.pinterest.com/pin/create/button/?url=https%3a%2f%2fchrispaul.dev%2freact-express-stripe-payment%2f&amp;media=https://chrispaul.dev/img%2fposts%2freact-express-stripe-payment%2fbanner.jpg&amp;description=">
                                        </a>
                                    </div>

                                    <img class="img-lazy img-responsive"
                                        data-lazy-src="/src="/img/posts/react-express-stripe-payment/banner.jpg"
                                        data-is-src-set="is-src-set" alt="react express stripe" itemprop="image" />
                                </div>
                            </div>


                            <p>Accepting payments on your own website can be an issue at some point. Often you&rsquo;ll
                                find yourself avoiding it, because you can easily outsource it to platforms such as
                                Gumroad that deal with it. However, at some point you want to avoid these third-party
                                platforms and introduce your own payment system.</p>

                            <p>I dealt with the same issue in a React application. After researching the topic, I found
                                out that using Stripe with React could be a solution, and an viable alternative to
                                PayPal, to charge money. Stripe is a payment platform with a <a target="_blank"
                                    rel="noopener noreferrer" href="https://stripe.com/docs/api">well documented API</a>
                                for developers.</p>

                            <p>In this React tutorial, you will setup a minimal React application where you can charge
                                money with a credit card React Stripe form and a minimal Express server that receives
                                the payment request. The request gets forwared from your payment server to Stripe via
                                its platform API. The tutorial doesn&rsquo;t come with a lot extra on top. It tries to
                                keep the solution to a minimum so that you can adapt it to your needs.</p>

                            <p>If you are interested in a full blown payment solution with Stripe and PayPal in React,
                                you can also read <a href="../react-paypal-payment/index.html">about the PayPal in React
                                    setup</a> in my other article.</p>

                            <h2 class="chapter-header" id="stripe-platform">Stripe Platform</h2>

                            <p>Before you start with the implementation, make sure that you signed up for <a
                                    target="_blank" rel="noopener noreferrer" href="https://stripe.com/de">Stripe</a>.
                                You should create an account and be able to access your dashboard. The dashboard gives
                                you an overview of your payments. There are three things to know about it:</p>

                            <ol>
                                <li>
                                    <p><strong>Modes:</strong> Somewhere you should be able to switch between live and
                                        test mode. When in <strong>test mode</strong>, you will only see payments that
                                        were done from your test application. Once you go live with your application,
                                        you will see real payments in the <strong>live mode</strong>.</p>
                                </li>

                                <li>
                                    <p><strong>API keys:</strong> Somewhere you should find your API keys. One API key
                                        is the <strong>publishable API key</strong> that is used in your React
                                        application to generate a token. The other <strong>secret API key</strong> is
                                        used in your server application to charge the money by accessing the Stripe API.
                                    </p>
                                </li>

                                <li>
                                    <p><strong>Switching Modes:</strong> Be aware that the API keys change when you
                                        switch from live to test mode and vice versa. Thus you can use both variants in
                                        your development (test mode) and production (live mode) environments of your
                                        application. For instance, when you test your application locally, you can
                                        charge money and the payment will be displayed in the dashboard. But only when
                                        the dashboard is in test mode. Once you go to production with your application,
                                        the money will be charged for real from a credit card.</p>
                                </li>
                            </ol>

                            <p>Now, let&rsquo;s begin implementing the frontend application with React and afterward the
                                backend application with Express. The official Stripe library will be used on both
                                sides: In the React application, the Stripe library generates by using the publishable
                                API key a token. Afterward you will forward the token to your backend application. In
                                the backend, the token is used combined with the Stripe library and the secret API key
                                to charge money via the Stripe API. The separation between frontend and backend is
                                mandatory for security reasons.</p>

                            <p>Before you dive into the frontend application, let&rsquo;s setup the folder structure.
                                First, create your project folder from the command line:</p>

                            <div class="highlight" style="background: #2f1e2e">
                                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #06b6ef">mkdir</span> <span style="color: #06b6ef">react</span><span style="color: #5bc4bf">-</span><span style="color: #06b6ef">express</span><span style="color: #5bc4bf">-</span><span style="color: #06b6ef">stripe</span>
<span style="color: #06b6ef">cd</span> <span style="color: #06b6ef">react</span><span style="color: #5bc4bf">-</span><span style="color: #06b6ef">express</span><span style="color: #5bc4bf">-</span><span style="color: #06b6ef">stripe</span>
</code></pre>
                            </div>


                            <p>In this folder, you will create your <em>frontend/</em> and <em>backend/</em> folders in
                                the next chapters.</p>

                            <h2 class="chapter-header" id="react-stripe-frontend">React Stripe Frontend</h2>

                            <p>Using create-react-app is the fastest way to get started in React. It bootstraps your
                                ReactJs project with all boilerplate code with zero-configuration from the command line.
                                You can read more about it in the <a target="_blank" rel="noopener noreferrer"
                                    href="https://github.com/facebookincubator/create-react-app">official
                                    documentation</a>.</p>

                            <p>If you haven&rsquo;t installed it yet, you can install it globally with your node package
                                manager:</p>

                            <div class="highlight" style="background: #2f1e2e">
                                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #06b6ef">npm</span> <span style="color: #06b6ef">install</span> <span style="color: #5bc4bf">-</span><span style="color: #06b6ef">g</span> <span style="color: #06b6ef">create</span><span style="color: #5bc4bf">-</span><span style="color: #06b6ef">react</span><span style="color: #5bc4bf">-</span><span style="color: #06b6ef">app</span>
</code></pre>
                            </div>


                            <p>Once you have it installed, you can bootstrap your frontend application. From
                                <em>react-express-stripe/</em> on the command line:</p>

                            <div class="highlight" style="background: #2f1e2e">
                                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #06b6ef">create</span><span style="color: #5bc4bf">-</span><span style="color: #06b6ef">react</span><span style="color: #5bc4bf">-</span><span style="color: #06b6ef">app</span> <span style="color: #06b6ef">frontend</span>
<span style="color: #06b6ef">cd</span> <span style="color: #06b6ef">frontend</span>
</code></pre>
                            </div>


                            <p>The next step is to install a couple of libraries:</p>

                            <div class="highlight" style="background: #2f1e2e">
                                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #06b6ef">npm</span> <span style="color: #06b6ef">install</span> <span style="color: #5bc4bf">--</span><span style="color: #06b6ef">save</span> <span style="color: #06b6ef">axios</span> <span style="color: #06b6ef">react</span><span style="color: #5bc4bf">-</span><span style="color: #06b6ef">stripe</span><span style="color: #5bc4bf">-</span><span style="color: #06b6ef">checkout</span>
</code></pre>
                            </div>


                            <p>You will use <a target="_blank" rel="noopener noreferrer"
                                    href="https://github.com/mzabriskie/axios">axios</a> to make your payment request to
                                your own Express backend. However, it is up to you to use another solution such as
                                superagent or the native fetch <a target="_blank" rel="noopener noreferrer"
                                    href="../what-is-an-api-javascript/index.html">API</a> of the browser. After all,
                                you are in a React environment, so <a
                                    href="../reasons-why-i-moved-from-angular-to-react/index.html">you can opt-in
                                    whatever solution suits you</a>.</p>

                            <p>The second library you will use is <a target="_blank" rel="noopener noreferrer"
                                    href="https://github.com/azmenak/react-stripe-checkout">react-stripe-checkout</a>.
                                It does two things for you:</p>

                            <ul>
                                <li>it comes with a pretty component to capture credit card information</li>
                                <li>it generates a Stripe token that you can send afterward to your backend</li>
                            </ul>

                            <p>I guess the token generation happens under the hood with the official Stripe.js library
                                that you will later use in your backend too.</p>

                            <p>There exists another library, the official library by Stripe for React, called <a
                                    target="_blank" rel="noopener noreferrer"
                                    href="https://github.com/stripe/react-stripe-elements">react-stripe-elements</a>.
                                However, I ran into two drawbacks when using it:</p>

                            <ul>
                                <li>it isn&rsquo;t supported when using server side rendering (e.g. with <a
                                        target="_blank" rel="noopener noreferrer"
                                        href="https://github.com/zeit/next.js/">NextJs</a>)</li>
                                <li>it didn&rsquo;t came with a pretty pre-configured Stripe like style</li>
                            </ul>

                            <p>After you have installed all the necessary libraries, the frontend application needs only
                                a handful more folders and files for a couple of constants and one component. From
                                <em>react-express-stripe/frontend</em> on the command line:</p>

                            <div class="highlight" style="background: #2f1e2e">
                                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #06b6ef">cd</span> <span style="color: #06b6ef">src</span>
<span style="color: #06b6ef">touch</span> <span style="color: #06b6ef">Checkout</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">js</span>
<span style="color: #06b6ef">mkdir</span> <span style="color: #06b6ef">constants</span> <span style="color: #5bc4bf">&amp;&amp;</span> <span style="color: #06b6ef">cd</span> <span style="color: #06b6ef">constants</span>
<span style="color: #06b6ef">touch</span> <span style="color: #06b6ef">server</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">js</span> <span style="color: #06b6ef">stripe</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">js</span>
</code></pre>
                            </div>


                            <p>Let&rsquo;s start in the <em>src/App.js</em> component that comes from create-react-app.
                                Replace it with the following code:</p>

                            <div class="highlight" style="background: #2f1e2e">
                                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span><span style="color: #e7e9db">,</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #06b6ef">logo</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;./logo.svg&#39;</span><span style="color: #e7e9db">;</span>
<span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #06b6ef">Checkout</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;./Checkout&#39;</span><span style="color: #e7e9db">;</span>
</span><span style="color: #815ba4">import</span> <span style="color: #48b685">&#39;./App.css&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">class</span> <span style="color: #06b6ef">App</span> <span style="color: #815ba4">extends</span> <span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">{</span>
  <span style="color: #06b6ef">render</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
    <span style="color: #815ba4">return</span> <span style="color: #e7e9db">(</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">div</span> <span style="color: #06b6ef">className</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;App&quot;</span><span style="color: #5bc4bf">&gt;</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">div</span> <span style="color: #06b6ef">className</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;App-header&quot;</span><span style="color: #5bc4bf">&gt;</span>
          <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">img</span> <span style="color: #06b6ef">src</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">logo</span><span style="color: #e7e9db">}</span> <span style="color: #06b6ef">className</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;App-logo&quot;</span> <span style="color: #06b6ef">alt</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;logo&quot;</span> <span style="color: #5bc4bf">/&gt;</span>
          <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">h2</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">Welcome</span> <span style="color: #06b6ef">to</span> <span style="color: #06b6ef">React</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/h2&gt;</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/div&gt;</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">p</span> <span style="color: #06b6ef">className</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;App-intro&quot;</span><span style="color: #5bc4bf">&gt;</span>
<span style="background-color: #4f424c">          <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Checkout</span>
</span><span style="background-color: #4f424c">            <span style="color: #06b6ef">name</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #48b685">&#39;The Road to learn React&#39;</span><span style="color: #e7e9db">}</span>
</span><span style="background-color: #4f424c">            <span style="color: #06b6ef">description</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #48b685">&#39;Only the Book&#39;</span><span style="color: #e7e9db">}</span>
</span><span style="background-color: #4f424c">            <span style="color: #06b6ef">amount</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #f99b15">1</span><span style="color: #e7e9db">}</span>
</span><span style="background-color: #4f424c">          <span style="color: #5bc4bf">/&gt;</span>
</span>        <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/p&gt;</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/div&gt;</span>
    <span style="color: #e7e9db">);</span>
  <span style="color: #e7e9db">}</span>
<span style="color: #e7e9db">}</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">App</span><span style="color: #e7e9db">;</span>
</code></pre>
                            </div>


                            <p>The important part is the <code>Checkout</code> component. The <code>name</code>,
                                <code>description</code> and amount can be replaced with your own properties. You can
                                make it a dynamic input with your own forms too.</p>

                            <p>The second step is to implement the <code>Checkout</code> component. The file should be
                                already created by you on the command line.</p>

                            <div class="highlight" style="background: #2f1e2e">
                                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span>
<span style="color: #815ba4">import</span> <span style="color: #06b6ef">axios</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;axios&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #06b6ef">StripeCheckout</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react-stripe-checkout&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">import</span> <span style="color: #06b6ef">STRIPE_PUBLISHABLE</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;./constants/stripe&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #06b6ef">PAYMENT_SERVER_URL</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;./constants/server&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">CURRENCY</span> <span style="color: #5bc4bf">=</span> <span style="color: #48b685">&#39;EUR&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">fromEuroToCent</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">amount</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #06b6ef">amount</span> <span style="color: #5bc4bf">*</span> <span style="color: #f99b15">100</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">successPayment</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">data</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
  <span style="color: #06b6ef">alert</span><span style="color: #e7e9db">(</span><span style="color: #48b685">&#39;Payment Successful&#39;</span><span style="color: #e7e9db">);</span>
<span style="color: #e7e9db">};</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">errorPayment</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">data</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
  <span style="color: #06b6ef">alert</span><span style="color: #e7e9db">(</span><span style="color: #48b685">&#39;Payment Error&#39;</span><span style="color: #e7e9db">);</span>
<span style="color: #e7e9db">};</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">onToken</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">(</span><span style="color: #06b6ef">amount</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">description</span><span style="color: #e7e9db">)</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #06b6ef">token</span> <span style="color: #5bc4bf">=&gt;</span>
  <span style="color: #06b6ef">axios</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">post</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">PAYMENT_SERVER_URL</span><span style="color: #e7e9db">,</span>
    <span style="color: #e7e9db">{</span>
      <span style="color: #06b6ef">description</span><span style="color: #e7e9db">,</span>
      <span style="color: #06b6ef">source</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">token</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">id</span><span style="color: #e7e9db">,</span>
      <span style="color: #06b6ef">currency</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">CURRENCY</span><span style="color: #e7e9db">,</span>
      <span style="color: #06b6ef">amount</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">fromEuroToCent</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">amount</span><span style="color: #e7e9db">)</span>
    <span style="color: #e7e9db">})</span>
    <span style="color: #e7e9db">.</span><span style="color: #06b6ef">then</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">successPayment</span><span style="color: #e7e9db">)</span>
    <span style="color: #e7e9db">.</span><span style="color: #815ba4">catch</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">errorPayment</span><span style="color: #e7e9db">);</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">Checkout</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">({</span> <span style="color: #06b6ef">name</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">description</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">amount</span> <span style="color: #e7e9db">})</span> <span style="color: #5bc4bf">=&gt;</span>
  <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">StripeCheckout</span>
    <span style="color: #06b6ef">name</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">name</span><span style="color: #e7e9db">}</span>
    <span style="color: #06b6ef">description</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">description</span><span style="color: #e7e9db">}</span>
    <span style="color: #06b6ef">amount</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">fromEuroToCent</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">amount</span><span style="color: #e7e9db">)}</span>
    <span style="color: #06b6ef">token</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">onToken</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">amount</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">description</span><span style="color: #e7e9db">)}</span>
    <span style="color: #06b6ef">currency</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">CURRENCY</span><span style="color: #e7e9db">}</span>
    <span style="color: #06b6ef">stripeKey</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">STRIPE_PUBLISHABLE</span><span style="color: #e7e9db">}</span>
  <span style="color: #5bc4bf">/&gt;</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">Checkout</span><span style="color: #e7e9db">;</span>
</code></pre>
                            </div>


                            <p>The <code>Checkout</code> component uses the <code>StripeCheckout</code> that comes from
                                the library you&rsquo;ve installed before. This component receives your personal props,
                                such as <code>name</code>, <code>amount</code> and <code>description</code>, but also
                                needs a <code>currency</code> and your <code>stripeKey</code> which is the publishable
                                API key from the Stripe dashboard.</p>

                            <p>The most important prop is the <code>token</code> handler. There you can pass your
                                callback function that will be triggered when the user submits the credit card
                                information. The component library already creates the <code>token</code> for you in
                                this callback function. Hence you can send all the necessary information to your
                                backend. Because a promise is returned in axios, you can branch your success and error
                                functions with then and catch.</p>

                            <p>The <code>Checkout</code> component uses constants from two files that you have already
                                created. The last step for the frontend is to define these constants.</p>

                            <p>First, in the <em>src/constants/server.js</em> file, you define the URL of your server.
                                In production, when using the express default server, it will be
                                <code>http://localhost:8080</code>. In production you may have a proper domain for your
                                server.</p>

                            <div class="highlight" style="background: #2f1e2e">
                                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">const</span> <span style="color: #06b6ef">PAYMENT_SERVER_URL</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">process</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">env</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">NODE_ENV</span> <span style="color: #5bc4bf">===</span> <span style="color: #48b685">&#39;production&#39;</span>
  <span style="color: #5bc4bf">?</span> <span style="color: #48b685">&#39;http://myapidomain.com&#39;</span>
  <span style="color: #5bc4bf">:</span> <span style="color: #48b685">&#39;http://localhost:8080&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">PAYMENT_SERVER_URL</span><span style="color: #e7e9db">;</span>
</code></pre>
                            </div>


                            <p>Second, in the <em>src/constants/stripe.js</em> file, you define your Stripe API keys
                                depending on development or production environment. You can get your own API keys from
                                the Stripe dashboard and replace them with the following constants.</p>

                            <div class="highlight" style="background: #2f1e2e">
                                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">const</span> <span style="color: #06b6ef">STRIPE_PUBLISHABLE</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">process</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">env</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">NODE_ENV</span> <span style="color: #5bc4bf">===</span> <span style="color: #48b685">&#39;production&#39;</span>
  <span style="color: #5bc4bf">?</span> <span style="color: #48b685">&#39;pk_live_MY_PUBLISHABLE_KEY&#39;</span>
  <span style="color: #5bc4bf">:</span> <span style="color: #48b685">&#39;pk_test_MY_PUBLISHABLE_KEY&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">STRIPE_PUBLISHABLE</span><span style="color: #e7e9db">;</span>
</code></pre>
                            </div>


                            <p>That&rsquo;s it for the React Stripe frontend application. You can start it with
                                <code>npm start</code> from the command line and test the button. On submit it should
                                fail, because you have no server yet.</p>

                            <h2 class="chapter-header" id="express-stripe-backend">Express Stripe Backend</h2>

                            <p>This chapter gives you guidance to implement your Express server application. It will
                                receive the payment information from your React frontend and will pass it to the Stripe
                                API. In the beginning, navigate into the <em>react-express-stripe/backend/</em> folder.
                                There you can initialize a plain npm project:</p>

                            <div class="highlight" style="background: #2f1e2e">
                                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #06b6ef">npm</span> <span style="color: #06b6ef">init</span> <span style="color: #5bc4bf">-</span><span style="color: #06b6ef">y</span>
</code></pre>
                            </div>


                            <p>By using the <code>-y</code> flag, you initialize all the defaults for the project.
                                That&rsquo;s fine for the purpose of this project. As in your frontend application, you
                                have to install a couple of libraries in your backend application.</p>

                            <div class="highlight" style="background: #2f1e2e">
                                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #06b6ef">npm</span> <span style="color: #06b6ef">install</span> <span style="color: #5bc4bf">--</span><span style="color: #06b6ef">save</span> <span style="color: #06b6ef">express</span> <span style="color: #06b6ef">cors</span> <span style="color: #06b6ef">body</span><span style="color: #5bc4bf">-</span><span style="color: #06b6ef">parser</span> <span style="color: #06b6ef">stripe</span>
</code></pre>
                            </div>


                            <p>You will use express to create a backend app with a RESTful routing. In addition, there
                                are cors and body-parser to configure and modify straight forward your incoming requests
                                to the Express server. Last but not least, Stripe is this time used as the pure library
                                that enables you to communicate with the Stripe platform API.</p>

                            <p>Next you can bootstrap your file and folder structure:</p>

                            <div class="highlight" style="background: #2f1e2e">
                                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #06b6ef">touch</span> <span style="color: #06b6ef">index</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">js</span> <span style="color: #06b6ef">server</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">js</span>
<span style="color: #06b6ef">mkdir</span> <span style="color: #06b6ef">constants</span> <span style="color: #06b6ef">routes</span>
</code></pre>
                            </div>


                            <p>In each new folder you create a few more files:</p>

                            <div class="highlight" style="background: #2f1e2e">
                                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #06b6ef">cd</span> <span style="color: #06b6ef">constants</span>
<span style="color: #06b6ef">touch</span> <span style="color: #06b6ef">frontend</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">js</span> <span style="color: #06b6ef">server</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">js</span> <span style="color: #06b6ef">stripe</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">js</span>
<span style="color: #06b6ef">cd</span> <span style="color: #e7e9db">..</span>
<span style="color: #06b6ef">cd</span> <span style="color: #06b6ef">routes</span>
<span style="color: #06b6ef">touch</span> <span style="color: #06b6ef">index</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">js</span> <span style="color: #06b6ef">payment</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">js</span>
</code></pre>
                            </div>


                            <p>Now, let&rsquo;s implement a simple backend API that your frontend can send the generated
                                token to the backend and the backend can forward it to the Stripe API. You&rsquo;ll
                                begin with the <em>index.js</em> file:</p>

                            <div class="highlight" style="background: #2f1e2e">
                                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">const</span> <span style="color: #06b6ef">express</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">require</span><span style="color: #e7e9db">(</span><span style="color: #48b685">&#39;express&#39;</span><span style="color: #e7e9db">);</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">SERVER_CONFIGS</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">require</span><span style="color: #e7e9db">(</span><span style="color: #48b685">&#39;./constants/server&#39;</span><span style="color: #e7e9db">);</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">configureServer</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">require</span><span style="color: #e7e9db">(</span><span style="color: #48b685">&#39;./server&#39;</span><span style="color: #e7e9db">);</span>
<span style="color: #815ba4">const</span> <span style="color: #06b6ef">configureRoutes</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">require</span><span style="color: #e7e9db">(</span><span style="color: #48b685">&#39;./routes&#39;</span><span style="color: #e7e9db">);</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">app</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">express</span><span style="color: #e7e9db">();</span>

<span style="color: #06b6ef">configureServer</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">app</span><span style="color: #e7e9db">);</span>
<span style="color: #06b6ef">configureRoutes</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">app</span><span style="color: #e7e9db">);</span>

<span style="color: #06b6ef">app</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">listen</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">SERVER_CONFIGS</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">PORT</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">error</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
  <span style="color: #815ba4">if</span> <span style="color: #e7e9db">(</span><span style="color: #06b6ef">error</span><span style="color: #e7e9db">)</span> <span style="color: #815ba4">throw</span> <span style="color: #06b6ef">error</span><span style="color: #e7e9db">;</span>
  <span style="color: #06b6ef">console</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">log</span><span style="color: #e7e9db">(</span><span style="color: #48b685">&#39;Server running on port: &#39;</span> <span style="color: #5bc4bf">+</span> <span style="color: #06b6ef">SERVER_CONFIGS</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">PORT</span><span style="color: #e7e9db">);</span>
<span style="color: #e7e9db">});</span>
</code></pre>
                            </div>


                            <p>The <em>index.js</em> file basically is your entry point and bootstraps your Express
                                application. The app gets created with <code>express()</code>, uses a couple of
                                configurations, that you will define later on, and finally listens on a defined port.
                            </p>

                            <p>The second step is to define your constants in the different files. First, you can start
                                in <em>constants/frontend.js</em>:</p>

                            <div class="highlight" style="background: #2f1e2e">
                                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">const</span> <span style="color: #06b6ef">FRONTEND_DEV_URLS</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">[</span> <span style="color: #48b685">&#39;http://localhost:3000&#39;</span> <span style="color: #e7e9db">];</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">FRONTEND_PROD_URLS</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">[</span>
  <span style="color: #48b685">&#39;https://www.yourdomain.com&#39;</span><span style="color: #e7e9db">,</span>
  <span style="color: #48b685">&#39;https://yourdomain.com&#39;</span>
<span style="color: #e7e9db">];</span>

<span style="color: #06b6ef">module</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">exports</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">process</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">env</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">NODE_ENV</span> <span style="color: #5bc4bf">===</span> <span style="color: #48b685">&#39;production&#39;</span>
  <span style="color: #5bc4bf">?</span> <span style="color: #06b6ef">FRONTEND_PROD_URLS</span>
  <span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">FRONTEND_DEV_URLS</span><span style="color: #e7e9db">;</span>
</code></pre>
                            </div>


                            <p>These URLs will be used later to create a whitelist for <a target="_blank"
                                    rel="noopener noreferrer"
                                    href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS">CORS</a>.
                                In our case only the <code>FRONTEND_DEV_URLS</code> matters. But when your application
                                goes in production, you should use your own domain of your frontend application.</p>

                            <p>Second, the <em>constants/server.js</em> file:</p>

                            <div class="highlight" style="background: #2f1e2e">
                                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">const</span> <span style="color: #06b6ef">path</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">require</span><span style="color: #e7e9db">(</span><span style="color: #48b685">&#39;path&#39;</span><span style="color: #e7e9db">);</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">SERVER_PORT</span> <span style="color: #5bc4bf">=</span> <span style="color: #f99b15">8080</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">SERVER_CONFIGS</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">{</span>
  <span style="color: #06b6ef">PRODUCTION</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">process</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">env</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">NODE_ENV</span> <span style="color: #5bc4bf">===</span> <span style="color: #48b685">&#39;production&#39;</span><span style="color: #e7e9db">,</span>
  <span style="color: #06b6ef">PORT</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">process</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">env</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">PORT</span> <span style="color: #5bc4bf">||</span> <span style="color: #06b6ef">SERVER_PORT</span><span style="color: #e7e9db">,</span>
<span style="color: #e7e9db">};</span>

<span style="color: #06b6ef">module</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">exports</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">SERVER_CONFIGS</span><span style="color: #e7e9db">;</span>
</code></pre>
                            </div>


                            <p>The configuration is already used in your <em>index.js</em> file to start up the app.</p>

                            <p>Third, you will define the last constants in <em>constants/stripe.js</em>. There you will
                                define the Stripe API keys, similar to the frontend, but this time the secret API keys.
                                Just replace them with your own API keys from your Stripe dashboard.</p>

                            <div class="highlight" style="background: #2f1e2e">
                                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">const</span> <span style="color: #06b6ef">configureStripe</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">require</span><span style="color: #e7e9db">(</span><span style="color: #48b685">&#39;stripe&#39;</span><span style="color: #e7e9db">);</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">STRIPE_SECRET_KEY</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">process</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">env</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">NODE_ENV</span> <span style="color: #5bc4bf">===</span> <span style="color: #48b685">&#39;production&#39;</span>
    <span style="color: #5bc4bf">?</span> <span style="color: #48b685">&#39;sk_live_MY_SECRET_KEY&#39;</span>
    <span style="color: #5bc4bf">:</span> <span style="color: #48b685">&#39;sk_test_MY_SECRET_KEY&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">stripe</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">configureStripe</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">STRIPE_SECRET_KEY</span><span style="color: #e7e9db">);</span>

<span style="color: #06b6ef">module</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">exports</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">stripe</span><span style="color: #e7e9db">;</span>
</code></pre>
                            </div>


                            <p>Now, only the server configuration and the routing is missing. Let&rsquo;s begin with the
                                server configuration in <em>server.js</em>.</p>

                            <div class="highlight" style="background: #2f1e2e">
                                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">const</span> <span style="color: #06b6ef">cors</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">require</span><span style="color: #e7e9db">(</span><span style="color: #48b685">&#39;cors&#39;</span><span style="color: #e7e9db">);</span>
<span style="color: #815ba4">const</span> <span style="color: #06b6ef">bodyParser</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">require</span><span style="color: #e7e9db">(</span><span style="color: #48b685">&#39;body-parser&#39;</span><span style="color: #e7e9db">);</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">CORS_WHITELIST</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">require</span><span style="color: #e7e9db">(</span><span style="color: #48b685">&#39;./constants/frontend&#39;</span><span style="color: #e7e9db">);</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">corsOptions</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">{</span>
  <span style="color: #06b6ef">origin</span><span style="color: #5bc4bf">:</span> <span style="color: #e7e9db">(</span><span style="color: #06b6ef">origin</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">callback</span><span style="color: #e7e9db">)</span> <span style="color: #5bc4bf">=&gt;</span>
    <span style="color: #e7e9db">(</span><span style="color: #06b6ef">CORS_WHITELIST</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">indexOf</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">origin</span><span style="color: #e7e9db">)</span> <span style="color: #5bc4bf">!==</span> <span style="color: #5bc4bf">-</span><span style="color: #f99b15">1</span><span style="color: #e7e9db">)</span>
      <span style="color: #5bc4bf">?</span> <span style="color: #06b6ef">callback</span><span style="color: #e7e9db">(</span><span style="color: #815ba4">null</span><span style="color: #e7e9db">,</span> <span style="color: #815ba4">true</span><span style="color: #e7e9db">)</span>
      <span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">callback</span><span style="color: #e7e9db">(</span><span style="color: #815ba4">new</span> <span style="color: #e7e9db">Error(</span><span style="color: #48b685">&#39;Not allowed by CORS&#39;</span><span style="color: #e7e9db">))</span>
<span style="color: #e7e9db">};</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">configureServer</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">app</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
  <span style="color: #06b6ef">app</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">use</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">cors</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">corsOptions</span><span style="color: #e7e9db">));</span>

  <span style="color: #06b6ef">app</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">use</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">bodyParser</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">json</span><span style="color: #e7e9db">());</span>
<span style="color: #e7e9db">};</span>

<span style="color: #06b6ef">module</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">exports</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">configureServer</span><span style="color: #e7e9db">;</span>
</code></pre>
                            </div>


                            <p>Basically you enable CORS for your application so that your frontend application is able
                                to communicate with your backend application. In addition, you apply the body-parser
                                middleware to parse your incoming requests rather than parsing them yourself. You
                                don&rsquo;t need to bother about this anymore.</p>

                            <p>Now, last but not least, comes the routing of your backend application where all the
                                magic happens. In your <em>routes/payment.js</em> file you can use the following code:
                            </p>

                            <div class="highlight" style="background: #2f1e2e">
                                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">const</span> <span style="color: #06b6ef">stripe</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">require</span><span style="color: #e7e9db">(</span><span style="color: #48b685">&#39;../constants/stripe&#39;</span><span style="color: #e7e9db">);</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">postStripeCharge</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">res</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">(</span><span style="color: #06b6ef">stripeErr</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">stripeRes</span><span style="color: #e7e9db">)</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
  <span style="color: #815ba4">if</span> <span style="color: #e7e9db">(</span><span style="color: #06b6ef">stripeErr</span><span style="color: #e7e9db">)</span> <span style="color: #e7e9db">{</span>
    <span style="color: #06b6ef">res</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">status</span><span style="color: #e7e9db">(</span><span style="color: #f99b15">500</span><span style="color: #e7e9db">).</span><span style="color: #06b6ef">send</span><span style="color: #e7e9db">({</span> <span style="color: #06b6ef">error</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">stripeErr</span> <span style="color: #e7e9db">});</span>
  <span style="color: #e7e9db">}</span> <span style="color: #815ba4">else</span> <span style="color: #e7e9db">{</span>
    <span style="color: #06b6ef">res</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">status</span><span style="color: #e7e9db">(</span><span style="color: #f99b15">200</span><span style="color: #e7e9db">).</span><span style="color: #06b6ef">send</span><span style="color: #e7e9db">({</span> <span style="color: #06b6ef">success</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">stripeRes</span> <span style="color: #e7e9db">});</span>
  <span style="color: #e7e9db">}</span>
<span style="color: #e7e9db">}</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">paymentApi</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">app</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
  <span style="color: #06b6ef">app</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">get</span><span style="color: #e7e9db">(</span><span style="color: #48b685">&#39;/&#39;</span><span style="color: #e7e9db">,</span> <span style="color: #e7e9db">(</span><span style="color: #06b6ef">req</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">res</span><span style="color: #e7e9db">)</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
    <span style="color: #06b6ef">res</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">send</span><span style="color: #e7e9db">({</span> <span style="color: #06b6ef">message</span><span style="color: #5bc4bf">:</span> <span style="color: #48b685">&#39;Hello Stripe checkout server!&#39;</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">timestamp</span><span style="color: #5bc4bf">:</span> <span style="color: #815ba4">new</span> <span style="color: #e7e9db">Date().</span><span style="color: #06b6ef">toISOString</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">})</span>
  <span style="color: #e7e9db">});</span>

  <span style="color: #06b6ef">app</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">post</span><span style="color: #e7e9db">(</span><span style="color: #48b685">&#39;/&#39;</span><span style="color: #e7e9db">,</span> <span style="color: #e7e9db">(</span><span style="color: #06b6ef">req</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">res</span><span style="color: #e7e9db">)</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
    <span style="color: #06b6ef">stripe</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">charges</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">create</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">req</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">body</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">postStripeCharge</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">res</span><span style="color: #e7e9db">));</span>
  <span style="color: #e7e9db">});</span>

  <span style="color: #815ba4">return</span> <span style="color: #06b6ef">app</span><span style="color: #e7e9db">;</span>
<span style="color: #e7e9db">};</span>

<span style="color: #06b6ef">module</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">exports</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">paymentApi</span><span style="color: #e7e9db">;</span>
</code></pre>
                            </div>


                            <p>Basically on a post request, that you are already doing with axios from your React
                                frontend application, you will use the Stripe library to create a official Stripe
                                payment. The payment creation receives the incoming payload from your frontend
                                application, all the credit card information and optional information, and a callback
                                function that executes after the request to the Stripe API succeeds or fails. Afterward,
                                you can send back a response to your React frontend application.</p>

                            <p>Finally you can wire up your Express application with the payment route in
                                <em>routes/index.js</em>:</p>

                            <div class="highlight" style="background: #2f1e2e">
                                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">const</span> <span style="color: #06b6ef">paymentApi</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">require</span><span style="color: #e7e9db">(</span><span style="color: #48b685">&#39;./payment&#39;</span><span style="color: #e7e9db">);</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">configureRoutes</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">app</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
  <span style="color: #06b6ef">paymentApi</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">app</span><span style="color: #e7e9db">);</span>
<span style="color: #e7e9db">};</span>

<span style="color: #06b6ef">module</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">exports</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">configureRoutes</span><span style="color: #e7e9db">;</span>
</code></pre>
                            </div>


                            <p>The configuration is already used in your <em>index.js</em>. Your Express Stripe Backend
                                should work now. Start it with <code>node index.js</code> from your <em>backend/</em>
                                folder on the command line.</p>

                            <h2 class="chapter-header" id="stripe-react-payment">Make your first Payment</h2>

                            <p>All the implementation is done. Now it is about testing it. When you start backend and
                                frontend, your applications should run on the localhost ports 8080 and 3000. Open up the
                                backend application and verify that it is running on the URL localhost:8080. Open up the
                                frontend application on the URL localhost:3000 and charge money with one of
                                Stripe&rsquo;s <a target="_blank" rel="noopener noreferrer"
                                    href="https://stripe.com/docs/testing#cards">test credit cards</a>. One of these
                                credit cards could be:</p>

                            <ul>
                                <li>Email: Any Email</li>
                                <li>Number: 4242 4242 4242 4242</li>
                                <li>Date: Any Date in the Future</li>
                                <li>CVC: Any 3 Numbers</li>
                            </ul>

                            <p>There should be an obvious alert when the payment succeeded, but also an error alert when
                                it failed. Once it succeeded, you can find the payment on your Stripe dashboard using
                                the test mode. If you charged a real credit card in production environment, the payment
                                should be visible on the dashboard in live mode.</p>

                            <p>You can find the final application and the installation README.md on <a target="_blank"
                                    rel="noopener noreferrer"
                                    href="https://github.com/ChrisPaulDev/react-express-stripe">GitHub</a>. If you like it,
                                make sure to star it. Otherwise, if you need help to deploy your Stripe payment server
                                to production, follow this <a
                                    href="../deploy-applications-digital-ocean/index.html">Digital Ocean deployment
                                    guide</a>. I deploy all my applications there with Dokku.</p>



                            



                            <div class="box-inline col-md-12">
                                <div class="col-md-12 text-center">
                                    <h2 class="newsletter">The Road to learn React</h2>

                                    <div class="col-md-4">
                                        <img class="img-lazy img-responsive" data-lazy-src="//img/page/cover.png">
                                    </div>

                                    <p class="lead">
                                        Build a Hacker News App along the way. No setup configuration. No tooling. No
                                        Redux. Plain React in 200+ pages of learning material. Learn React like
                                        <strong>50.000+ readers</strong>.
                                    </p>
                                    <a class="btn btn-template-main" href="https://roadtoreact.com" target="_blank"
                                        rel="noopener noreferrer">
                                        Get the Book for free <i class="fa fa-chevron-right"></i>
                                    </a>

                                    <div>
                                        <a href="https://amzn.to/2QY2ONp" target="_blank" rel="noopener noreferrer">
                                            Get it from Amazon
                                        </a>
                                    </div>

                                </div>
                            </div>

                        </div>



                        


                    </article>


                </div>


            </div>

        </div>




        <section class="bar background-image-fixed-2 no-mb color-white text-center">
            <div class="dark-mask"></div>
            <div class="container">
                <div class="row">
                    <div class="col-md-12">
                        <h3 class="lead">Never miss an article about web development, JavaScript and self-growth.</h3>
                        <h2 class="text-uppercase">Take Part</h2>
                    </div>

                    <div class="col-md-12 text-center">

                        <h3 class="lead"><i class="fa fa-check"></i> Join 30.000&#43; Developers</h3>

                        <h3 class="lead"><i class="fa fa-check"></i> Learn Web Development with JavaScript</h3>

                        <h3 class="lead"><i class="fa fa-check"></i> Tips and Tricks</h3>

                        <h3 class="lead"><i class="fa fa-check"></i> Access Tutorials, eBooks and Courses</h3>

                        <h3 class="lead"><i class="fa fa-check"></i> Personal Development as a Software Engineer</h3>

                    </div>
                    <div class="col-md-12">
                        <p class="text-center">
                            <div id="mc_embed_signup">
                                <form action="https://www.getrevue.co/profile/rwieruch/add_subscriber" method="post"
                                    id="revue-form" name="revue-form" target="_blank">
                                    <div id="mc_embed_signup_scroll">
                                        <input class="email" placeholder="email address" type="email"
                                            name="member[email]" id="member_email">
                                        <div>
                                            <button type="submit" value="Subscribe" name="member[subscribe]"
                                                id="member_submit" class="btn btn-template-transparent-black btn-lg">
                                                Subscribe
                                            </button>
                                        </div>
                                    </div>
                                </form>
                            </div>

                        </p>
                    </div>
                </div>
            </div>
        </section>
        <footer id="subfooter">
            <div class="container">

                <div class="col-md-5 col-sm-6">

                    <h4>Recent posts</h4>

                    <div class="blog-entries">

                        <div class="item same-height-row clearfix">
                            <div class="article same-height-always">
                                <a href="../redux-vs-usereducer/index.html">

                                    <img data-lazy-src="//img/posts/redux-vs-usereducer/banner.jpg"
                                        data-is-thumb="is-thumb" class="img-lazy img-responsive"
                                        alt="React&#39;s useReducer vs Redux">

                                </a>
                            </div>
                            <div class="name same-height-always">
                                <h5><a href="../redux-vs-usereducer/index.html">React&#39;s useReducer vs Redux</a></h5>
                            </div>
                        </div>

                        <div class="item same-height-row clearfix">
                            <div class="article same-height-always">
                                <a href="../publish-npm-package-node/index.html">

                                    <img data-lazy-src="//img/posts/publish-npm-package-node/banner.jpg"
                                        data-is-thumb="is-thumb" class="img-lazy img-responsive"
                                        alt="How to publish a npm package?">

                                </a>
                            </div>
                            <div class="name same-height-always">
                                <h5><a href="../publish-npm-package-node/index.html">How to publish a npm package?</a>
                                </h5>
                            </div>
                        </div>

                        <div class="item same-height-row clearfix">
                            <div class="article same-height-always">
                                <a href="../react-scroll-to-item/index.html">

                                    <img data-lazy-src="//img/posts/react-scroll-to-item/banner.jpg"
                                        data-is-thumb="is-thumb" class="img-lazy img-responsive"
                                        alt="How to Scroll to Item in React?">

                                </a>
                            </div>
                            <div class="name same-height-always">
                                <h5><a href="../react-scroll-to-item/index.html">How to Scroll to Item in React?</a>
                                </h5>
                            </div>
                        </div>

                    </div>

                    <hr class="hidden-md hidden-lg hidden-sm">

                </div>



                <div class="col-md-5 col-md-offset-2 col-sm-6">

                    <h4>About Me</h4>

                    <div class="blog-entries">
                        <div class="item same-height-row clearfix">
                            <div class="profile same-height-always">
                                <img class="img-lazy img-responsive" data-lazy-src="//img/page/profile.jpg"
                                    alt="profile">
                            </div>
                            <div class="name same-height-always">
                                <p>
                                    Hi, I'm Chris - a Midvale, Utah-based consulting software developer. Find out more
                                    <a href="../about/index.html">about me</a>, <a
                                        href="../work-with-me/index.html">work with me</a>, or have a look at my social
                                    media profiles below.
                                </p>
                            </div>
                        </div>
                    </div>

                </div>



            </div>

        </footer>


        <footer id="copyright">
            <div class="container">
                <div class="row">
                    <div class="col-md-4">
                        <ul class="info list-inline quicklinks pull-left">

                            <li>© Chris Paul</li>

                        </ul>
                    </div>
                    <div class="col-md-4">
                        <ul class="list-inline footer-social-buttons text-center">

                            <li><a target="_blank" rel="noopener noreferrer" aria-label="social-media"
                                    href="https://www.twitter.com/rwieruch"><i class="fa fa-twitter"></i></a></li>

                            <li><a target="_blank" rel="noopener noreferrer" aria-label="social-media"
                                    href="https://www.github.com/ChrisPaulDev"><i class="fa fa-github"></i></a></li>

                            

                            

                            

                            <li><a target="_blank" rel="noopener noreferrer" aria-label="social-media"
                                    href="https://www.paypal.me/rwieruch"><i class="fa fa-paypal"></i></a></li>

                            

                            

                        </ul>
                    </div>
                    <div class="col-md-4">
                        <ul class="info list-inline quicklinks pull-right">

                            <li><a aria-label="quicklinks" href="../legal/index.html">Legal Notice</a></li>

                        </ul>
                    </div>
                </div>
            </div>
        </footer>


    </div>



    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>

    <script src="../js/script.js"></script>
</body>

</html>