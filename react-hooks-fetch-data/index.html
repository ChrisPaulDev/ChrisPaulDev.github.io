<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta name="viewport" content="width=device-width, initial-scale=1">



  <title>
    How to fetch data with React Hooks? - CPaul
  </title>

  <meta name="author" content="" />
  <meta name="description"
    content="A tutorial on how to fetch data in React with Hooks from third-party APIs. You will use state and effect hooks for the data request from a real API ...">


  <meta name="theme-color" content="#38bb6c" />

  <meta name="generator" content="Hugo 0.41" />
  <link href="https://cdn-images.mailchimp.com/embedcode/horizontal-slim-10_7.css" rel="stylesheet" type="text/css">

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
  <link href="../css/bootstrap.default.css" rel="stylesheet" id="theme-stylesheet">
  <link href="../css/customizations.css" rel="stylesheet">

  <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

  <link rel="shortcut icon" href="../img/favicon/favicon.ico" type="image/x-icon" />
  <link rel="apple-touch-icon" href="../img/favicon/apple-touch-icon.png" />
  <link rel="manifest" href="../img/favicon/manifest.json">
  <link rel="mask-icon" href="../img/favicon/safari-pinned-tab.svg" color="#5bbad5">

  <link rel="alternate" href="../index.xml" type="application/rss+xml" title="CPaul">

  <meta itemprop="name" content="How to fetch data with React Hooks?">
  <meta itemprop="description"
    content="A tutorial on how to fetch data in React with Hooks from third-party APIs. You will use state and effect hooks for the data request from a real API ...">
  <meta itemprop="image" content="https://chrispaul.dev/img/posts/react-hooks-fetch-data/banner_640.jpg">
  <meta itemprop="keywords"
    content="angular,apollo,d3,graphql,growth,javascript,machine-learning,mobx,node,react,reason,redux,tooling,vue,web-development,angular,apollo,d3,graphql,growth,javascript,machine-learning,mobx,node,react,reason,redux,tooling,web-development," />


  <meta itemprop="wordCount" content="4102">

  <meta name="keywords" content="react fetch data hooks">

  <meta property="og:title" content="How to fetch data with React Hooks? - CPaul">


  <meta property="og:description"
    content="A tutorial on how to fetch data in React with Hooks from third-party APIs. You will use state and effect hooks for the data request from a real API ..." />


  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://chrispaul.dev/react-hooks-fetch-data/" />
  <meta property="og:image" content="https://chrispaul.dev/img/posts/react-hooks-fetch-data/banner_640.jpg" />



  <meta name="news_keywords" content="react fetch data hooks" />



  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:image:src" content="https://chrispaul.dev/img/posts/react-hooks-fetch-data/banner_640.jpg" />
  <meta name="twitter:title" content="How to fetch data with React Hooks?" />
  <meta name="twitter:description"
    content="A tutorial on how to fetch data in React with Hooks from third-party APIs. You will use state and effect hooks for the data request from a real API ..." />
  <meta name="twitter:site" content="@ChrisPaulDev" />
  



</head>


<body>

  <div id="all">

    <header>

      <div class="navbar-affixed-top" data-spy="affix" data-offset-top="200">

        <div class="navbar navbar-default yamm" role="navigation" id="navbar">

          <div class="container">
            <div class="navbar-header">
              

              <div class="navbar-buttons">
                <button type="button" class="navbar-toggle btn-template-main" data-toggle="collapse"
                  data-target="#navigation">
                  <span class="sr-only">Toggle navigation</span>
                  <i class="fa fa-align-justify"></i>
                </button>
              </div>
            </div>


            <div class="navbar-collapse collapse" id="navigation">
              <ul class="nav navbar-nav navbar-right">

                <li class="dropdown">

                  <a href="../index.html">Blog</a>

                </li>

                <li class="dropdown">

                  <a href="../work-with-me/index.html">Work with me</a>

                </li>

                <li class="dropdown">

                  <a href="../about/index.html">About</a>

                </li>

                <li class="dropdown">

                  <a style="color: #38bb6c" href="https://roadtoreact.com/">Books &amp; Courses</a>

                </li>

              </ul>
            </div>


            <div class="collapse clearfix" id="search">

              <form class="navbar-form" role="search">
                <div class="input-group">
                  <input type="text" class="form-control" placeholder="Search">
                  <span class="input-group-btn">

                    <button type="submit" class="btn btn-template-main"><i class="fa fa-search"></i></button>

                  </span>
                </div>
              </form>

            </div>


          </div>
        </div>


      </div>
    </header>

    

    



    <div class="hidden-xs">


      <section class="bar background-image-fixed-2 no-mb color-white text-center">
        <div class="dark-mask"></div>
        <div class="container">
          <div class="row">
            <div class="col-md-12">
              <h3 class="lead">Never miss an article about web development, JavaScript and self-growth.</h3>
              <h2 class="text-uppercase newsletter">Take Part</h2>
            </div>

            <div class="col-md-12">
              <p class="text-center">
                <div id="mc_embed_signup">
                  <form action="https://www.getrevue.co/profile/rwieruch/add_subscriber" method="post" id="revue-form"
                    name="revue-form" target="_blank">
                    <div id="mc_embed_signup_scroll">
                      <input class="email" placeholder="email address" type="email" name="member[email]"
                        id="member_email">
                      <div>
                        <button type="submit" value="Subscribe" name="member[subscribe]" id="member_submit"
                          class="btn btn-template-transparent-black btn-lg">
                          Subscribe
                        </button>
                      </div>
                    </div>
                  </form>
                </div>

              </p>
            </div>
          </div>
        </div>
      </section>
    </div>

    <div id="content">
      <div class="container">

        <div class="row">

          <article class="col-md-8 col-md-offset-2" id="blog-post" itemprop="blogPosts" itemscope
            itemtype="http://schema.org/BlogPosting">

            <div id="post-content" itemprop="articleBody">

              <header>
                <h1 itemprop="name headline">How to fetch data with React Hooks?</h1>
              </header>

              

              <p class="text-muted text-uppercase mb-small text-center">
                <span itemprop="author publisher">

                </span>


                <time datetime="2019-03-07" itemprop="datePublished">
                  March 7, 2019
                </time>


              </p>

              <div>


              </div>

              <div class="post-image-primary">
                <div class="pinterest-pinner-wrapper" itemscope itemtype="http://schema.org/ImageObject">
                  <div class="pinterest-pinner">
                    <a data-pin-do="buttonPin" data-pin-save="true" data-pin-tall="true"
                      href="https://www.pinterest.com/pin/create/button/?url=https%3a%2f%2fchrispaul.dev%2freact-hooks-fetch-data%2f&amp;media=https://chrispaul.dev/img%2fposts%2freact-hooks-fetch-data%2fbanner.jpg&amp;description=">
                    </a>
                  </div>

                  <img class="img-lazy img-responsive"
                    data-lazy-src="/src="/img/posts/react-hooks-fetch-data/banner.jpg" data-is-src-set="is-src-set"
                    alt="react fetch data hooks" itemprop="image" />
                </div>
              </div>


              <p>In this tutorial, I want to show you <strong>how to fetch data in React with Hooks</strong> by using
                the <a target="_blank" rel="noopener noreferrer"
                  href="https://reactjs.org/docs/hooks-state.html">state</a> and <a target="_blank"
                  rel="noopener noreferrer" href="https://reactjs.org/docs/hooks-effect.html">effect</a> hooks. We will
                use the widely known <a target="_blank" rel="noopener noreferrer"
                  href="https://hn.algolia.com/api">Hacker News API</a> to fetch popular articles from the tech world.
                You will also implement your custom hook for the data fetching that can be reused anywhere in your
                application or published on npm as standalone node package.</p>

              <p>If you don&rsquo;t know anything about this new React feature, checkout this <a
                  href="../react-hooks/index.html">introduction to React Hooks</a>. If you want to checkout the finished
                project for the showcased examples that show how to fetch data in React with Hooks, checkout this <a
                  target="_blank" rel="noopener noreferrer"
                  href="https://github.com/the-road-to-learn-react/react-hooks-introduction">GitHub repository</a>.</p>

              <p><strong>Note:</strong> In the future, React Hooks are not be intended for data fetching in React.
                Instead, a feature called Suspense will be in charge for it. The following walkthrough is nonetheless a
                great way to learn more about state and effect hooks in React.</p>

              <h2 class="chapter-header" id="react-fetching-data-with-hooks">Data Fetching with React Hooks</h2>

              <p>If you are not familiar with data fetching in React, checkout my <a
                  href="../react-fetching-data/index.html">extensive data fetching in React article</a>. It walks you
                through data fetching with React class components, how it can be made reusable with <a
                  href="../react-render-props-pattern/index.html">Render Prop Components</a> and <a
                  href="../gentle-introduction-higher-order-components/index.html">Higher-Order Components</a>, and how
                it deals with error handling and loading spinners. In this article, I want to show you all of it with
                React Hooks in function components.</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span><span style="color: #e7e9db">,</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">useState</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">function</span> <span style="color: #06b6ef">App</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">data</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">setData</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">({</span> <span style="color: #06b6ef">hits</span><span style="color: #5bc4bf">:</span> <span style="color: #e7e9db">[]</span> <span style="color: #e7e9db">});</span>

  <span style="color: #815ba4">return</span> <span style="color: #e7e9db">(</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">ul</span><span style="color: #5bc4bf">&gt;</span>
      <span style="color: #e7e9db">{</span><span style="color: #06b6ef">data</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">hits</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">map</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">item</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">(</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">li</span> <span style="color: #06b6ef">key</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">item</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">objectID</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span>
          <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">a</span> <span style="color: #06b6ef">href</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">item</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">url</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">item</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">title</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/a&gt;</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/li&gt;</span>
      <span style="color: #e7e9db">))}</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/ul&gt;</span>
  <span style="color: #e7e9db">);</span>
<span style="color: #e7e9db">}</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">App</span><span style="color: #e7e9db">;</span>
</code></pre>
              </div>


              <p>The App component shows a list of items (hits = Hacker News articles). The state and state update
                function come from the state hook called <code>useState</code> that is responsible to manage the local
                state for the data that we are going to fetch for the App component. The initial state is an empty list
                of hits in an object that represents the data. No one is setting any state for this data yet.</p>

              <p>We are going to use <a target="_blank" rel="noopener noreferrer"
                  href="https://github.com/axios/axios">axios</a> to fetch data, but it is up to you to use another data
                fetching library or the native fetch API of the browser. If you haven&rsquo;t installed axios yet, you
                can do so by on the command line with <code>npm install axios</code>. Then implement your effect hook
                for the data fetching:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span><span style="color: #e7e9db">,</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">useEffect</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>
</span><span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #06b6ef">axios</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;axios&#39;</span><span style="color: #e7e9db">;</span>
</span>
<span style="color: #815ba4">function</span> <span style="color: #06b6ef">App</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">data</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">setData</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">({</span> <span style="color: #06b6ef">hits</span><span style="color: #5bc4bf">:</span> <span style="color: #e7e9db">[]</span> <span style="color: #e7e9db">});</span>

<span style="background-color: #4f424c">  <span style="color: #06b6ef">useEffect</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">async</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
</span><span style="background-color: #4f424c">    <span style="color: #815ba4">const</span> <span style="color: #06b6ef">result</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">await</span> <span style="color: #06b6ef">axios</span><span style="color: #e7e9db">(</span>
</span><span style="background-color: #4f424c">      <span style="color: #48b685">&#39;http://hn.algolia.com/api/v1/search?query=redux&#39;</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">    <span style="color: #e7e9db">);</span>
</span><span style="background-color: #4f424c">
</span><span style="background-color: #4f424c">    <span style="color: #06b6ef">setData</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">result</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">data</span><span style="color: #e7e9db">);</span>
</span><span style="background-color: #4f424c">  <span style="color: #e7e9db">});</span>
</span>
  <span style="color: #815ba4">return</span> <span style="color: #e7e9db">(</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">ul</span><span style="color: #5bc4bf">&gt;</span>
      <span style="color: #e7e9db">{</span><span style="color: #06b6ef">data</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">hits</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">map</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">item</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">(</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">li</span> <span style="color: #06b6ef">key</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">item</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">objectID</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span>
          <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">a</span> <span style="color: #06b6ef">href</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">item</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">url</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">item</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">title</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/a&gt;</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/li&gt;</span>
      <span style="color: #e7e9db">))}</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/ul&gt;</span>
  <span style="color: #e7e9db">);</span>
<span style="color: #e7e9db">}</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">App</span><span style="color: #e7e9db">;</span>
</code></pre>
              </div>


              <p>The effect hook called useEffect is used to fetch the data with axios from the API and to set the data
                in the local state of the component with the state hook&rsquo;s update function. The promise resolving
                happens with async/await.</p>

              <p>However, when you run your application, you should stumble into a nasty loop. The effect hook runs when
                the component mounts but also when the component updates. Because we are setting the state after every
                data fetch, the component updates and the effect runs again. It fetches the data again and again.
                That&rsquo;s a bug and needs to be avoided. <strong>We only want to fetch data when the component
                  mounts.</strong> That&rsquo;s why you can provide an empty array as second argument to the effect hook
                to avoid activating it on component updates but only for the mounting of the component.</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span><span style="color: #e7e9db">,</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">useEffect</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #06b6ef">axios</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;axios&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">function</span> <span style="color: #06b6ef">App</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">data</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">setData</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">({</span> <span style="color: #06b6ef">hits</span><span style="color: #5bc4bf">:</span> <span style="color: #e7e9db">[]</span> <span style="color: #e7e9db">});</span>

  <span style="color: #06b6ef">useEffect</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">async</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
    <span style="color: #815ba4">const</span> <span style="color: #06b6ef">result</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">await</span> <span style="color: #06b6ef">axios</span><span style="color: #e7e9db">(</span>
      <span style="color: #48b685">&#39;http://hn.algolia.com/api/v1/search?query=redux&#39;</span><span style="color: #e7e9db">,</span>
    <span style="color: #e7e9db">);</span>

    <span style="color: #06b6ef">setData</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">result</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">data</span><span style="color: #e7e9db">);</span>
<span style="background-color: #4f424c">  <span style="color: #e7e9db">},</span> <span style="color: #e7e9db">[]);</span>
</span>
  <span style="color: #815ba4">return</span> <span style="color: #e7e9db">(</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">ul</span><span style="color: #5bc4bf">&gt;</span>
      <span style="color: #e7e9db">{</span><span style="color: #06b6ef">data</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">hits</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">map</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">item</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">(</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">li</span> <span style="color: #06b6ef">key</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">item</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">objectID</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span>
          <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">a</span> <span style="color: #06b6ef">href</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">item</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">url</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">item</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">title</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/a&gt;</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/li&gt;</span>
      <span style="color: #e7e9db">))}</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/ul&gt;</span>
  <span style="color: #e7e9db">);</span>
<span style="color: #e7e9db">}</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">App</span><span style="color: #e7e9db">;</span>
</code></pre>
              </div>


              <p>The second argument can be used to define all the variables (allocated in this array) on which the hook
                depends. If one of the variables changes, the hook runs again. If the array with the variables is empty,
                the hook doesn&rsquo;t run when updating the component at all, because it doesn&rsquo;t have to watch
                any variables.</p>

              <p>There is one last catch. In the code, we are using async/await to fetch data from a third-party API.
                According to the documentation every function annotated with async returns an implicit promise:
                <em>&ldquo;The async function declaration defines an asynchronous function, which returns an
                  AsyncFunction object. An asynchronous function is a function which operates asynchronously via the
                  event loop, using an implicit Promise to return its result. &ldquo;</em>. However, an effect hook
                should return nothing or a clean up function. That&rsquo;s why you may see the following warning in your
                developer console log: <strong>07:41:22.910 index.js:1452 Warning: useEffect function must return a
                  cleanup function or nothing. Promises and useEffect(async () =&gt; &hellip;) are not supported, but
                  you can call an async function inside an effect.</strong>. That&rsquo;s why using async directly in
                the <code>useEffect</code> function isn&rsquo;t allowed. Let&rsquo;s implement a workaround for it, by
                using the async function inside the effect.</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span><span style="color: #e7e9db">,</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">useEffect</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #06b6ef">axios</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;axios&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">function</span> <span style="color: #06b6ef">App</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">data</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">setData</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">({</span> <span style="color: #06b6ef">hits</span><span style="color: #5bc4bf">:</span> <span style="color: #e7e9db">[]</span> <span style="color: #e7e9db">});</span>

  <span style="color: #06b6ef">useEffect</span><span style="color: #e7e9db">(()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
<span style="background-color: #4f424c">    <span style="color: #815ba4">const</span> <span style="color: #06b6ef">fetchData</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">async</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
</span><span style="background-color: #4f424c">      <span style="color: #815ba4">const</span> <span style="color: #06b6ef">result</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">await</span> <span style="color: #06b6ef">axios</span><span style="color: #e7e9db">(</span>
</span><span style="background-color: #4f424c">        <span style="color: #48b685">&#39;http://hn.algolia.com/api/v1/search?query=redux&#39;</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">      <span style="color: #e7e9db">);</span>
</span><span style="background-color: #4f424c">
</span><span style="background-color: #4f424c">      <span style="color: #06b6ef">setData</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">result</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">data</span><span style="color: #e7e9db">);</span>
</span><span style="background-color: #4f424c">    <span style="color: #e7e9db">};</span>
</span>
<span style="background-color: #4f424c">    <span style="color: #06b6ef">fetchData</span><span style="color: #e7e9db">();</span>
</span>  <span style="color: #e7e9db">},</span> <span style="color: #e7e9db">[]);</span>

  <span style="color: #815ba4">return</span> <span style="color: #e7e9db">(</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">ul</span><span style="color: #5bc4bf">&gt;</span>
      <span style="color: #e7e9db">{</span><span style="color: #06b6ef">data</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">hits</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">map</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">item</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">(</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">li</span> <span style="color: #06b6ef">key</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">item</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">objectID</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span>
          <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">a</span> <span style="color: #06b6ef">href</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">item</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">url</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">item</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">title</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/a&gt;</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/li&gt;</span>
      <span style="color: #e7e9db">))}</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/ul&gt;</span>
  <span style="color: #e7e9db">);</span>
<span style="color: #e7e9db">}</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">App</span><span style="color: #e7e9db">;</span>
</code></pre>
              </div>


              <p>That&rsquo;s data fetching with React hooks in a nutshell. But continue reading if you are interested
                about error handling, loading indicators, how to trigger the data fetching from a form, and how to
                implment a reusable data fetching hook.</p>

              <h2 class="chapter-header" id="react-hooks-programmatically">How to trigger a hook
                programmatically/manually?</h2>

              <p>Great, we are fetching data once the component mounts. But what about using an input field to tell the
                API in which topic we are interested in? &ldquo;Redux&rdquo; is taken as default query. But what about
                topics about &ldquo;React&rdquo;? Let&rsquo;s implement an input element to enable someone to fetch
                other stories than &ldquo;Redux&rdquo; stories. Therefore, introduce a new state for the input element.
              </p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span><span style="color: #e7e9db">,</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">Fragment</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">useEffect</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #06b6ef">axios</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;axios&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">function</span> <span style="color: #06b6ef">App</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">data</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">setData</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">({</span> <span style="color: #06b6ef">hits</span><span style="color: #5bc4bf">:</span> <span style="color: #e7e9db">[]</span> <span style="color: #e7e9db">});</span>
<span style="background-color: #4f424c">  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">query</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">setQuery</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">(</span><span style="color: #48b685">&#39;redux&#39;</span><span style="color: #e7e9db">);</span>
</span>
  <span style="color: #06b6ef">useEffect</span><span style="color: #e7e9db">(()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
    <span style="color: #815ba4">const</span> <span style="color: #06b6ef">fetchData</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">async</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
      <span style="color: #815ba4">const</span> <span style="color: #06b6ef">result</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">await</span> <span style="color: #06b6ef">axios</span><span style="color: #e7e9db">(</span>
        <span style="color: #48b685">&#39;http://hn.algolia.com/api/v1/search?query=redux&#39;</span><span style="color: #e7e9db">,</span>
      <span style="color: #e7e9db">);</span>

      <span style="color: #06b6ef">setData</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">result</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">data</span><span style="color: #e7e9db">);</span>
    <span style="color: #e7e9db">};</span>

    <span style="color: #06b6ef">fetchData</span><span style="color: #e7e9db">();</span>
  <span style="color: #e7e9db">},</span> <span style="color: #e7e9db">[]);</span>

  <span style="color: #815ba4">return</span> <span style="color: #e7e9db">(</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Fragment</span><span style="color: #5bc4bf">&gt;</span>
<span style="background-color: #4f424c">      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">input</span>
</span><span style="background-color: #4f424c">        <span style="color: #06b6ef">type</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;text&quot;</span>
</span><span style="background-color: #4f424c">        <span style="color: #06b6ef">value</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">query</span><span style="color: #e7e9db">}</span>
</span><span style="background-color: #4f424c">        <span style="color: #06b6ef">onChange</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">event</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #06b6ef">setQuery</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">event</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">target</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">value</span><span style="color: #e7e9db">)}</span>
</span><span style="background-color: #4f424c">      <span style="color: #5bc4bf">/&gt;</span>
</span>      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">ul</span><span style="color: #5bc4bf">&gt;</span>
        <span style="color: #e7e9db">{</span><span style="color: #06b6ef">data</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">hits</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">map</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">item</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">(</span>
          <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">li</span> <span style="color: #06b6ef">key</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">item</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">objectID</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span>
            <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">a</span> <span style="color: #06b6ef">href</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">item</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">url</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">item</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">title</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/a&gt;</span>
          <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/li&gt;</span>
        <span style="color: #e7e9db">))}</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/ul&gt;</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/Fragment&gt;</span>
  <span style="color: #e7e9db">);</span>
<span style="color: #e7e9db">}</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">App</span><span style="color: #e7e9db">;</span>
</code></pre>
              </div>


              <p>At the moment, both states are independent from each other, but now you want to couple them to only
                fetch articles that are specified by the query in the input field. With the following change, the
                component should fetch all articles by query term once it mounted.</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #e7e9db">...</span>

<span style="color: #815ba4">function</span> <span style="color: #06b6ef">App</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">data</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">setData</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">({</span> <span style="color: #06b6ef">hits</span><span style="color: #5bc4bf">:</span> <span style="color: #e7e9db">[]</span> <span style="color: #e7e9db">});</span>
  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">query</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">setQuery</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">(</span><span style="color: #48b685">&#39;redux&#39;</span><span style="color: #e7e9db">);</span>

  <span style="color: #06b6ef">useEffect</span><span style="color: #e7e9db">(()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
    <span style="color: #815ba4">const</span> <span style="color: #06b6ef">fetchData</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">async</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
      <span style="color: #815ba4">const</span> <span style="color: #06b6ef">result</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">await</span> <span style="color: #06b6ef">axios</span><span style="color: #e7e9db">(</span>
<span style="background-color: #4f424c">        <span style="color: #48b685">`http://hn.algolia.com/api/v1/search?query=</span><span style="color: #f99b15">${</span><span style="color: #06b6ef">query</span><span style="color: #f99b15">}</span><span style="color: #48b685">`</span><span style="color: #e7e9db">,</span>
</span>      <span style="color: #e7e9db">);</span>

      <span style="color: #06b6ef">setData</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">result</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">data</span><span style="color: #e7e9db">);</span>
    <span style="color: #e7e9db">};</span>

    <span style="color: #06b6ef">fetchData</span><span style="color: #e7e9db">();</span>
  <span style="color: #e7e9db">},</span> <span style="color: #e7e9db">[]);</span>

  <span style="color: #815ba4">return</span> <span style="color: #e7e9db">(</span>
    <span style="color: #e7e9db">...</span>
  <span style="color: #e7e9db">);</span>
<span style="color: #e7e9db">}</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">App</span><span style="color: #e7e9db">;</span>
</code></pre>
              </div>


              <p>One piece is missing: When you try to type something into the input field, there is no other data
                fetching after the mounting triggered from the effect. That&rsquo;s because you have provided the empty
                array as second argument to the effect. The effect depends on no variables, so it is only triggered when
                the component mounts. However, now the effect should depend on the query. Once the query changes, the
                data request should fire again.</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #e7e9db">...</span>

<span style="color: #815ba4">function</span> <span style="color: #06b6ef">App</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">data</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">setData</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">({</span> <span style="color: #06b6ef">hits</span><span style="color: #5bc4bf">:</span> <span style="color: #e7e9db">[]</span> <span style="color: #e7e9db">});</span>
  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">query</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">setQuery</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">(</span><span style="color: #48b685">&#39;redux&#39;</span><span style="color: #e7e9db">);</span>

  <span style="color: #06b6ef">useEffect</span><span style="color: #e7e9db">(()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
    <span style="color: #815ba4">const</span> <span style="color: #06b6ef">fetchData</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">async</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
      <span style="color: #815ba4">const</span> <span style="color: #06b6ef">result</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">await</span> <span style="color: #06b6ef">axios</span><span style="color: #e7e9db">(</span>
        <span style="color: #48b685">`http://hn.algolia.com/api/v1/search?query=</span><span style="color: #f99b15">${</span><span style="color: #06b6ef">query</span><span style="color: #f99b15">}</span><span style="color: #48b685">`</span><span style="color: #e7e9db">,</span>
      <span style="color: #e7e9db">);</span>

      <span style="color: #06b6ef">setData</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">result</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">data</span><span style="color: #e7e9db">);</span>
    <span style="color: #e7e9db">};</span>

    <span style="color: #06b6ef">fetchData</span><span style="color: #e7e9db">();</span>
<span style="background-color: #4f424c">  <span style="color: #e7e9db">},</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">query</span><span style="color: #e7e9db">]);</span>
</span>
  <span style="color: #815ba4">return</span> <span style="color: #e7e9db">(</span>
    <span style="color: #e7e9db">...</span>
  <span style="color: #e7e9db">);</span>
<span style="color: #e7e9db">}</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">App</span><span style="color: #e7e9db">;</span>
</code></pre>
              </div>


              <p>The refetching of the data should work once you change the value in the input field. But that opens up
                another problem: On every character you type into the input field, the effect is triggered and executes
                another data fetching request. How about providing a button that triggers the request and therefore the
                hook manually?</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">function</span> <span style="color: #06b6ef">App</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">data</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">setData</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">({</span> <span style="color: #06b6ef">hits</span><span style="color: #5bc4bf">:</span> <span style="color: #e7e9db">[]</span> <span style="color: #e7e9db">});</span>
  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">query</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">setQuery</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">(</span><span style="color: #48b685">&#39;redux&#39;</span><span style="color: #e7e9db">);</span>
<span style="background-color: #4f424c">  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">search</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">setSearch</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">(</span><span style="color: #48b685">&#39;&#39;</span><span style="color: #e7e9db">);</span>
</span>
  <span style="color: #06b6ef">useEffect</span><span style="color: #e7e9db">(()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
    <span style="color: #815ba4">const</span> <span style="color: #06b6ef">fetchData</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">async</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
      <span style="color: #815ba4">const</span> <span style="color: #06b6ef">result</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">await</span> <span style="color: #06b6ef">axios</span><span style="color: #e7e9db">(</span>
        <span style="color: #48b685">`http://hn.algolia.com/api/v1/search?query=</span><span style="color: #f99b15">${</span><span style="color: #06b6ef">query</span><span style="color: #f99b15">}</span><span style="color: #48b685">`</span><span style="color: #e7e9db">,</span>
      <span style="color: #e7e9db">);</span>

      <span style="color: #06b6ef">setData</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">result</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">data</span><span style="color: #e7e9db">);</span>
    <span style="color: #e7e9db">};</span>

    <span style="color: #06b6ef">fetchData</span><span style="color: #e7e9db">();</span>
  <span style="color: #e7e9db">},</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">query</span><span style="color: #e7e9db">]);</span>

  <span style="color: #815ba4">return</span> <span style="color: #e7e9db">(</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Fragment</span><span style="color: #5bc4bf">&gt;</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">input</span>
        <span style="color: #06b6ef">type</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;text&quot;</span>
        <span style="color: #06b6ef">value</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">query</span><span style="color: #e7e9db">}</span>
        <span style="color: #06b6ef">onChange</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">event</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #06b6ef">setQuery</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">event</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">target</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">value</span><span style="color: #e7e9db">)}</span>
      <span style="color: #5bc4bf">/&gt;</span>
<span style="background-color: #4f424c">      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">button</span> <span style="color: #06b6ef">type</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;button&quot;</span> <span style="color: #06b6ef">onClick</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #06b6ef">setSearch</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">query</span><span style="color: #e7e9db">)}</span><span style="color: #5bc4bf">&gt;</span>
</span><span style="background-color: #4f424c">        <span style="color: #06b6ef">Search</span>
</span><span style="background-color: #4f424c">      <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/button&gt;</span>
</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">ul</span><span style="color: #5bc4bf">&gt;</span>
        <span style="color: #e7e9db">{</span><span style="color: #06b6ef">data</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">hits</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">map</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">item</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">(</span>
          <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">li</span> <span style="color: #06b6ef">key</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">item</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">objectID</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span>
            <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">a</span> <span style="color: #06b6ef">href</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">item</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">url</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">item</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">title</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/a&gt;</span>
          <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/li&gt;</span>
        <span style="color: #e7e9db">))}</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/ul&gt;</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/Fragment&gt;</span>
  <span style="color: #e7e9db">);</span>
<span style="color: #e7e9db">}</span>
</code></pre>
              </div>


              <p>Now, make the effect dependant on the search state rather than the fluctuant query state that changes
                with every key stroke in the input field. Once the user clicks the button, the new search state is set
                and should trigger the effect hook kinda manually.</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #e7e9db">...</span>

<span style="color: #815ba4">function</span> <span style="color: #06b6ef">App</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">data</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">setData</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">({</span> <span style="color: #06b6ef">hits</span><span style="color: #5bc4bf">:</span> <span style="color: #e7e9db">[]</span> <span style="color: #e7e9db">});</span>
  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">query</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">setQuery</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">(</span><span style="color: #48b685">&#39;redux&#39;</span><span style="color: #e7e9db">);</span>
<span style="background-color: #4f424c">  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">search</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">setSearch</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">(</span><span style="color: #48b685">&#39;redux&#39;</span><span style="color: #e7e9db">);</span>
</span>
  <span style="color: #06b6ef">useEffect</span><span style="color: #e7e9db">(()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
    <span style="color: #815ba4">const</span> <span style="color: #06b6ef">fetchData</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">async</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
      <span style="color: #815ba4">const</span> <span style="color: #06b6ef">result</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">await</span> <span style="color: #06b6ef">axios</span><span style="color: #e7e9db">(</span>
<span style="background-color: #4f424c">        <span style="color: #48b685">`http://hn.algolia.com/api/v1/search?query=</span><span style="color: #f99b15">${</span><span style="color: #06b6ef">search</span><span style="color: #f99b15">}</span><span style="color: #48b685">`</span><span style="color: #e7e9db">,</span>
</span>      <span style="color: #e7e9db">);</span>

      <span style="color: #06b6ef">setData</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">result</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">data</span><span style="color: #e7e9db">);</span>
    <span style="color: #e7e9db">};</span>

    <span style="color: #06b6ef">fetchData</span><span style="color: #e7e9db">();</span>
<span style="background-color: #4f424c">  <span style="color: #e7e9db">},</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">search</span><span style="color: #e7e9db">]);</span>
</span>
  <span style="color: #815ba4">return</span> <span style="color: #e7e9db">(</span>
    <span style="color: #e7e9db">...</span>
  <span style="color: #e7e9db">);</span>
<span style="color: #e7e9db">}</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">App</span><span style="color: #e7e9db">;</span>
</code></pre>
              </div>


              <p>Also the initial state of the search state is set to the same state as the query state, because the
                component fetches data also on mount and therefore the result should mirror the value in the input
                field. However, having a similar query and search state is kinda confusing. Why not set the actual URL
                as state instead of the search state?</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">function</span> <span style="color: #06b6ef">App</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">data</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">setData</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">({</span> <span style="color: #06b6ef">hits</span><span style="color: #5bc4bf">:</span> <span style="color: #e7e9db">[]</span> <span style="color: #e7e9db">});</span>
  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">query</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">setQuery</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">(</span><span style="color: #48b685">&#39;redux&#39;</span><span style="color: #e7e9db">);</span>
<span style="background-color: #4f424c">  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">url</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">setUrl</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">(</span>
</span><span style="background-color: #4f424c">    <span style="color: #48b685">&#39;http://hn.algolia.com/api/v1/search?query=redux&#39;</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">  <span style="color: #e7e9db">);</span>
</span>
  <span style="color: #06b6ef">useEffect</span><span style="color: #e7e9db">(()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
    <span style="color: #815ba4">const</span> <span style="color: #06b6ef">fetchData</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">async</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
<span style="background-color: #4f424c">      <span style="color: #815ba4">const</span> <span style="color: #06b6ef">result</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">await</span> <span style="color: #06b6ef">axios</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">url</span><span style="color: #e7e9db">);</span>
</span>
      <span style="color: #06b6ef">setData</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">result</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">data</span><span style="color: #e7e9db">);</span>
    <span style="color: #e7e9db">};</span>

    <span style="color: #06b6ef">fetchData</span><span style="color: #e7e9db">();</span>
<span style="background-color: #4f424c">  <span style="color: #e7e9db">},</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">url</span><span style="color: #e7e9db">]);</span>
</span>
  <span style="color: #815ba4">return</span> <span style="color: #e7e9db">(</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Fragment</span><span style="color: #5bc4bf">&gt;</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">input</span>
        <span style="color: #06b6ef">type</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;text&quot;</span>
        <span style="color: #06b6ef">value</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">query</span><span style="color: #e7e9db">}</span>
        <span style="color: #06b6ef">onChange</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">event</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #06b6ef">setQuery</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">event</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">target</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">value</span><span style="color: #e7e9db">)}</span>
      <span style="color: #5bc4bf">/&gt;</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">button</span>
        <span style="color: #06b6ef">type</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;button&quot;</span>
        <span style="color: #06b6ef">onClick</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{()</span> <span style="color: #5bc4bf">=&gt;</span>
<span style="background-color: #4f424c">          <span style="color: #06b6ef">setUrl</span><span style="color: #e7e9db">(</span><span style="color: #48b685">`http://hn.algolia.com/api/v1/search?query=</span><span style="color: #f99b15">${</span><span style="color: #06b6ef">query</span><span style="color: #f99b15">}</span><span style="color: #48b685">`</span><span style="color: #e7e9db">)</span>
</span>        <span style="color: #e7e9db">}</span>
      <span style="color: #5bc4bf">&gt;</span>
        <span style="color: #06b6ef">Search</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/button&gt;</span>

      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">ul</span><span style="color: #5bc4bf">&gt;</span>
        <span style="color: #e7e9db">{</span><span style="color: #06b6ef">data</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">hits</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">map</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">item</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">(</span>
          <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">li</span> <span style="color: #06b6ef">key</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">item</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">objectID</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span>
            <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">a</span> <span style="color: #06b6ef">href</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">item</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">url</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">item</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">title</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/a&gt;</span>
          <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/li&gt;</span>
        <span style="color: #e7e9db">))}</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/ul&gt;</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/Fragment&gt;</span>
  <span style="color: #e7e9db">);</span>
<span style="color: #e7e9db">}</span>
</code></pre>
              </div>


              <p>That&rsquo;s if for the implicit programmatic data fetching with the effect hook. You can decide on
                which state the effect depends. Once you set this state on a click or in another side-effect, this
                effect will run again. In this case, if the URL state changes, the effect runs again to fetch stories
                from the API.</p>

              <h2 class="chapter-header" id="react-hooks-error-handling">Loading Indicator with React Hooks</h2>

              <p>Let&rsquo;s introduce a loading indicator to the data fetching. It&rsquo;s just another state that is
                manage by a state hook. The loading flag is used to render a loading indicator in the App component.</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span><span style="color: #e7e9db">,</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">Fragment</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">useEffect</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #06b6ef">axios</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;axios&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">function</span> <span style="color: #06b6ef">App</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">data</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">setData</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">({</span> <span style="color: #06b6ef">hits</span><span style="color: #5bc4bf">:</span> <span style="color: #e7e9db">[]</span> <span style="color: #e7e9db">});</span>
  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">query</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">setQuery</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">(</span><span style="color: #48b685">&#39;redux&#39;</span><span style="color: #e7e9db">);</span>
  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">url</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">setUrl</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">(</span>
    <span style="color: #48b685">&#39;http://hn.algolia.com/api/v1/search?query=redux&#39;</span><span style="color: #e7e9db">,</span>
  <span style="color: #e7e9db">);</span>
<span style="background-color: #4f424c">  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">isLoading</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">setIsLoading</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">(</span><span style="color: #815ba4">false</span><span style="color: #e7e9db">);</span>
</span>
  <span style="color: #06b6ef">useEffect</span><span style="color: #e7e9db">(()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
    <span style="color: #815ba4">const</span> <span style="color: #06b6ef">fetchData</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">async</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
<span style="background-color: #4f424c">      <span style="color: #06b6ef">setIsLoading</span><span style="color: #e7e9db">(</span><span style="color: #815ba4">true</span><span style="color: #e7e9db">);</span>
</span>
      <span style="color: #815ba4">const</span> <span style="color: #06b6ef">result</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">await</span> <span style="color: #06b6ef">axios</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">url</span><span style="color: #e7e9db">);</span>

      <span style="color: #06b6ef">setData</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">result</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">data</span><span style="color: #e7e9db">);</span>
<span style="background-color: #4f424c">      <span style="color: #06b6ef">setIsLoading</span><span style="color: #e7e9db">(</span><span style="color: #815ba4">false</span><span style="color: #e7e9db">);</span>
</span>    <span style="color: #e7e9db">};</span>

    <span style="color: #06b6ef">fetchData</span><span style="color: #e7e9db">();</span>
  <span style="color: #e7e9db">},</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">url</span><span style="color: #e7e9db">]);</span>

  <span style="color: #815ba4">return</span> <span style="color: #e7e9db">(</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Fragment</span><span style="color: #5bc4bf">&gt;</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">input</span>
        <span style="color: #06b6ef">type</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;text&quot;</span>
        <span style="color: #06b6ef">value</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">query</span><span style="color: #e7e9db">}</span>
        <span style="color: #06b6ef">onChange</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">event</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #06b6ef">setQuery</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">event</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">target</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">value</span><span style="color: #e7e9db">)}</span>
      <span style="color: #5bc4bf">/&gt;</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">button</span>
        <span style="color: #06b6ef">type</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;button&quot;</span>
        <span style="color: #06b6ef">onClick</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{()</span> <span style="color: #5bc4bf">=&gt;</span>
          <span style="color: #06b6ef">setUrl</span><span style="color: #e7e9db">(</span><span style="color: #48b685">`http://hn.algolia.com/api/v1/search?query=</span><span style="color: #f99b15">${</span><span style="color: #06b6ef">query</span><span style="color: #f99b15">}</span><span style="color: #48b685">`</span><span style="color: #e7e9db">)</span>
        <span style="color: #e7e9db">}</span>
      <span style="color: #5bc4bf">&gt;</span>
        <span style="color: #06b6ef">Search</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/button&gt;</span>

<span style="background-color: #4f424c">      <span style="color: #e7e9db">{</span><span style="color: #06b6ef">isLoading</span> <span style="color: #5bc4bf">?</span> <span style="color: #e7e9db">(</span>
</span><span style="background-color: #4f424c">        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">div</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">Loading</span> <span style="color: #e7e9db">...</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/div&gt;</span>
</span><span style="background-color: #4f424c">      <span style="color: #e7e9db">)</span> <span style="color: #5bc4bf">:</span> <span style="color: #e7e9db">(</span>
</span>        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">ul</span><span style="color: #5bc4bf">&gt;</span>
          <span style="color: #e7e9db">{</span><span style="color: #06b6ef">data</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">hits</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">map</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">item</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">(</span>
            <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">li</span> <span style="color: #06b6ef">key</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">item</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">objectID</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span>
              <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">a</span> <span style="color: #06b6ef">href</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">item</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">url</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">item</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">title</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/a&gt;</span>
            <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/li&gt;</span>
          <span style="color: #e7e9db">))}</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/ul&gt;</span>
<span style="background-color: #4f424c">      <span style="color: #e7e9db">)}</span>
</span>    <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/Fragment&gt;</span>
  <span style="color: #e7e9db">);</span>
<span style="color: #e7e9db">}</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">App</span><span style="color: #e7e9db">;</span>
</code></pre>
              </div>


              <p>Once the effect is called for data fetching, which happens when the component mounts or the URL state
                changes, the loading state is set to true. Once the request resolves, the loading state is set to false
                again.</p>

              <h2 class="chapter-header" id="react-hooks-error-handling">Error Handling with React Hooks</h2>

              <p>What about error handling for data fetching with a React hook? The error is just another state
                initialized with a state hook. Once there is an error state, the App component can render feedback for
                the user. When using async/await, it is common to use try/catch blocks for error handling. You can do it
                within the effect:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span><span style="color: #e7e9db">,</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">Fragment</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">useEffect</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #06b6ef">axios</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;axios&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">function</span> <span style="color: #06b6ef">App</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">data</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">setData</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">({</span> <span style="color: #06b6ef">hits</span><span style="color: #5bc4bf">:</span> <span style="color: #e7e9db">[]</span> <span style="color: #e7e9db">});</span>
  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">query</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">setQuery</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">(</span><span style="color: #48b685">&#39;redux&#39;</span><span style="color: #e7e9db">);</span>
  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">url</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">setUrl</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">(</span>
    <span style="color: #48b685">&#39;http://hn.algolia.com/api/v1/search?query=redux&#39;</span><span style="color: #e7e9db">,</span>
  <span style="color: #e7e9db">);</span>
  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">isLoading</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">setIsLoading</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">(</span><span style="color: #815ba4">false</span><span style="color: #e7e9db">);</span>
<span style="background-color: #4f424c">  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">isError</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">setIsError</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">(</span><span style="color: #815ba4">false</span><span style="color: #e7e9db">);</span>
</span>
  <span style="color: #06b6ef">useEffect</span><span style="color: #e7e9db">(()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
    <span style="color: #815ba4">const</span> <span style="color: #06b6ef">fetchData</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">async</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
<span style="background-color: #4f424c">      <span style="color: #06b6ef">setIsError</span><span style="color: #e7e9db">(</span><span style="color: #815ba4">false</span><span style="color: #e7e9db">);</span>
</span>      <span style="color: #06b6ef">setIsLoading</span><span style="color: #e7e9db">(</span><span style="color: #815ba4">true</span><span style="color: #e7e9db">);</span>

<span style="background-color: #4f424c">      <span style="color: #815ba4">try</span> <span style="color: #e7e9db">{</span>
</span>        <span style="color: #815ba4">const</span> <span style="color: #06b6ef">result</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">await</span> <span style="color: #06b6ef">axios</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">url</span><span style="color: #e7e9db">);</span>

        <span style="color: #06b6ef">setData</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">result</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">data</span><span style="color: #e7e9db">);</span>
<span style="background-color: #4f424c">      <span style="color: #e7e9db">}</span> <span style="color: #815ba4">catch</span> <span style="color: #e7e9db">(</span><span style="color: #06b6ef">error</span><span style="color: #e7e9db">)</span> <span style="color: #e7e9db">{</span>
</span><span style="background-color: #4f424c">        <span style="color: #06b6ef">setIsError</span><span style="color: #e7e9db">(</span><span style="color: #815ba4">true</span><span style="color: #e7e9db">);</span>
</span><span style="background-color: #4f424c">      <span style="color: #e7e9db">}</span>
</span>
      <span style="color: #06b6ef">setIsLoading</span><span style="color: #e7e9db">(</span><span style="color: #815ba4">false</span><span style="color: #e7e9db">);</span>
    <span style="color: #e7e9db">};</span>

    <span style="color: #06b6ef">fetchData</span><span style="color: #e7e9db">();</span>
  <span style="color: #e7e9db">},</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">url</span><span style="color: #e7e9db">]);</span>

  <span style="color: #815ba4">return</span> <span style="color: #e7e9db">(</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Fragment</span><span style="color: #5bc4bf">&gt;</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">input</span>
        <span style="color: #06b6ef">type</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;text&quot;</span>
        <span style="color: #06b6ef">value</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">query</span><span style="color: #e7e9db">}</span>
        <span style="color: #06b6ef">onChange</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">event</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #06b6ef">setQuery</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">event</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">target</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">value</span><span style="color: #e7e9db">)}</span>
      <span style="color: #5bc4bf">/&gt;</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">button</span>
        <span style="color: #06b6ef">type</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;button&quot;</span>
        <span style="color: #06b6ef">onClick</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{()</span> <span style="color: #5bc4bf">=&gt;</span>
          <span style="color: #06b6ef">setUrl</span><span style="color: #e7e9db">(</span><span style="color: #48b685">`http://hn.algolia.com/api/v1/search?query=</span><span style="color: #f99b15">${</span><span style="color: #06b6ef">query</span><span style="color: #f99b15">}</span><span style="color: #48b685">`</span><span style="color: #e7e9db">)</span>
        <span style="color: #e7e9db">}</span>
      <span style="color: #5bc4bf">&gt;</span>
        <span style="color: #06b6ef">Search</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/button&gt;</span>

<span style="background-color: #4f424c">      <span style="color: #e7e9db">{</span><span style="color: #06b6ef">isError</span> <span style="color: #5bc4bf">&amp;&amp;</span> <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">div</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">Something</span> <span style="color: #06b6ef">went</span> <span style="color: #06b6ef">wrong</span> <span style="color: #e7e9db">...</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/div&gt;}</span>
</span>
      <span style="color: #e7e9db">{</span><span style="color: #06b6ef">isLoading</span> <span style="color: #5bc4bf">?</span> <span style="color: #e7e9db">(</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">div</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">Loading</span> <span style="color: #e7e9db">...</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/div&gt;</span>
      <span style="color: #e7e9db">)</span> <span style="color: #5bc4bf">:</span> <span style="color: #e7e9db">(</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">ul</span><span style="color: #5bc4bf">&gt;</span>
          <span style="color: #e7e9db">{</span><span style="color: #06b6ef">data</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">hits</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">map</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">item</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">(</span>
            <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">li</span> <span style="color: #06b6ef">key</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">item</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">objectID</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span>
              <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">a</span> <span style="color: #06b6ef">href</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">item</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">url</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">item</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">title</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/a&gt;</span>
            <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/li&gt;</span>
          <span style="color: #e7e9db">))}</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/ul&gt;</span>
      <span style="color: #e7e9db">)}</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/Fragment&gt;</span>
  <span style="color: #e7e9db">);</span>
<span style="color: #e7e9db">}</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">App</span><span style="color: #e7e9db">;</span>
</code></pre>
              </div>


              <p>The error state is reset every time the hook runs again. That&rsquo;s useful because after a failed
                request the user may want to try it again which should reset the error. In order to enforce an error
                yourself, you can alter the URL into something invalid. Then check whether the error message shows up.
              </p>

              <h2 class="chapter-header" id="react-hooks-forms-data-fetching">Fetching Data with Forms and React</h2>

              <p>What about a proper form to fetch data? So far, we have only a combination of input field and button.
                Once you introduce more input elements, you may want to wrap them with a form element. In addition, a
                form makes it possible to trigger the button with &ldquo;Enter&rdquo; on the keyboard too.</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">function</span> <span style="color: #06b6ef">App</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
  <span style="color: #e7e9db">...</span>

  <span style="color: #815ba4">return</span> <span style="color: #e7e9db">(</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Fragment</span><span style="color: #5bc4bf">&gt;</span>
<span style="background-color: #4f424c">      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">form</span>
</span><span style="background-color: #4f424c">        <span style="color: #06b6ef">onSubmit</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{()</span> <span style="color: #5bc4bf">=&gt;</span>
</span><span style="background-color: #4f424c">          <span style="color: #06b6ef">setUrl</span><span style="color: #e7e9db">(</span><span style="color: #48b685">`http://hn.algolia.com/api/v1/search?query=</span><span style="color: #f99b15">${</span><span style="color: #06b6ef">query</span><span style="color: #f99b15">}</span><span style="color: #48b685">`</span><span style="color: #e7e9db">)</span>
</span><span style="background-color: #4f424c">        <span style="color: #e7e9db">}</span>
</span><span style="background-color: #4f424c">      <span style="color: #5bc4bf">&gt;</span>
</span>        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">input</span>
          <span style="color: #06b6ef">type</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;text&quot;</span>
          <span style="color: #06b6ef">value</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">query</span><span style="color: #e7e9db">}</span>
          <span style="color: #06b6ef">onChange</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">event</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #06b6ef">setQuery</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">event</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">target</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">value</span><span style="color: #e7e9db">)}</span>
        <span style="color: #5bc4bf">/&gt;</span>
<span style="background-color: #4f424c">        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">button</span> <span style="color: #06b6ef">type</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;submit&quot;</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">Search</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/button&gt;</span>
</span><span style="background-color: #4f424c">      <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/form&gt;</span>
</span>
      <span style="color: #e7e9db">{</span><span style="color: #06b6ef">isError</span> <span style="color: #5bc4bf">&amp;&amp;</span> <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">div</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">Something</span> <span style="color: #06b6ef">went</span> <span style="color: #06b6ef">wrong</span> <span style="color: #e7e9db">...</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/div&gt;}</span>

      <span style="color: #e7e9db">...</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/Fragment&gt;</span>
  <span style="color: #e7e9db">);</span>
<span style="color: #e7e9db">}</span>
</code></pre>
              </div>


              <p>But now the browser reloads when clicking the submit button, because that&rsquo;s the native behavior
                of the browser when submitting a form. In order to prevent the default behavior, we can invoke a
                function on the React event. That&rsquo;s how you do it in React class components too.</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">function</span> <span style="color: #06b6ef">App</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
  <span style="color: #e7e9db">...</span>

<span style="background-color: #4f424c">  <span style="color: #815ba4">const</span> <span style="color: #06b6ef">doFetch</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
</span><span style="background-color: #4f424c">    <span style="color: #06b6ef">setUrl</span><span style="color: #e7e9db">(</span><span style="color: #48b685">`http://hn.algolia.com/api/v1/search?query=</span><span style="color: #f99b15">${</span><span style="color: #06b6ef">query</span><span style="color: #f99b15">}</span><span style="color: #48b685">`</span><span style="color: #e7e9db">);</span>
</span><span style="background-color: #4f424c">  <span style="color: #e7e9db">};</span>
</span><span style="background-color: #4f424c">
</span>  <span style="color: #815ba4">return</span> <span style="color: #e7e9db">(</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Fragment</span><span style="color: #5bc4bf">&gt;</span>
<span style="background-color: #4f424c">      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">form</span> <span style="color: #06b6ef">onSubmit</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">event</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
</span><span style="background-color: #4f424c">        <span style="color: #06b6ef">doFetch</span><span style="color: #e7e9db">();</span>
</span><span style="background-color: #4f424c">
</span><span style="background-color: #4f424c">        <span style="color: #06b6ef">event</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">preventDefault</span><span style="color: #e7e9db">();</span>
</span><span style="background-color: #4f424c">      <span style="color: #e7e9db">}}</span><span style="color: #5bc4bf">&gt;</span>
</span>        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">input</span>
          <span style="color: #06b6ef">type</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;text&quot;</span>
          <span style="color: #06b6ef">value</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">query</span><span style="color: #e7e9db">}</span>
          <span style="color: #06b6ef">onChange</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">event</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #06b6ef">setQuery</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">event</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">target</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">value</span><span style="color: #e7e9db">)}</span>
        <span style="color: #5bc4bf">/&gt;</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">button</span> <span style="color: #06b6ef">type</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;submit&quot;</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">Search</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/button&gt;</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/form&gt;</span>

      <span style="color: #e7e9db">{</span><span style="color: #06b6ef">isError</span> <span style="color: #5bc4bf">&amp;&amp;</span> <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">div</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">Something</span> <span style="color: #06b6ef">went</span> <span style="color: #06b6ef">wrong</span> <span style="color: #e7e9db">...</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/div&gt;}</span>

      <span style="color: #e7e9db">...</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/Fragment&gt;</span>
  <span style="color: #e7e9db">);</span>
<span style="color: #e7e9db">}</span>
</code></pre>
              </div>


              <p>Now the browser shouldn&rsquo;t reload anymore when you click the submit button. It works as before,
                but this time with a form instead of the naive input field and button combination. You can press the
                &ldquo;Enter&rdquo; key on your keyboard too.</p>

              <h2 class="chapter-header" id="react-hooks-custom-data-fetching">Custom Data Fetching Hook</h2>

              <p>In order to extract a custom hook for data fetching, move everything that belongs to the data fetching,
                except for the query state that belongs to the input field, but including the loading indicator and
                error handling, to its own function. Also make sure you return all the necessary variables from the
                function that are used in the App component.</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="background-color: #4f424c"><span style="color: #815ba4">const</span> <span style="color: #06b6ef">useHackerNewsApi</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
</span>  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">data</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">setData</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">({</span> <span style="color: #06b6ef">hits</span><span style="color: #5bc4bf">:</span> <span style="color: #e7e9db">[]</span> <span style="color: #e7e9db">});</span>
  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">url</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">setUrl</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">(</span>
    <span style="color: #48b685">&#39;http://hn.algolia.com/api/v1/search?query=redux&#39;</span><span style="color: #e7e9db">,</span>
  <span style="color: #e7e9db">);</span>
  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">isLoading</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">setIsLoading</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">(</span><span style="color: #815ba4">false</span><span style="color: #e7e9db">);</span>
  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">isError</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">setIsError</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">(</span><span style="color: #815ba4">false</span><span style="color: #e7e9db">);</span>

  <span style="color: #06b6ef">useEffect</span><span style="color: #e7e9db">(()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
    <span style="color: #815ba4">const</span> <span style="color: #06b6ef">fetchData</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">async</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
      <span style="color: #06b6ef">setIsError</span><span style="color: #e7e9db">(</span><span style="color: #815ba4">false</span><span style="color: #e7e9db">);</span>
      <span style="color: #06b6ef">setIsLoading</span><span style="color: #e7e9db">(</span><span style="color: #815ba4">true</span><span style="color: #e7e9db">);</span>

      <span style="color: #815ba4">try</span> <span style="color: #e7e9db">{</span>
        <span style="color: #815ba4">const</span> <span style="color: #06b6ef">result</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">await</span> <span style="color: #06b6ef">axios</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">url</span><span style="color: #e7e9db">);</span>

        <span style="color: #06b6ef">setData</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">result</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">data</span><span style="color: #e7e9db">);</span>
      <span style="color: #e7e9db">}</span> <span style="color: #815ba4">catch</span> <span style="color: #e7e9db">(</span><span style="color: #06b6ef">error</span><span style="color: #e7e9db">)</span> <span style="color: #e7e9db">{</span>
        <span style="color: #06b6ef">setIsError</span><span style="color: #e7e9db">(</span><span style="color: #815ba4">true</span><span style="color: #e7e9db">);</span>
      <span style="color: #e7e9db">}</span>

      <span style="color: #06b6ef">setIsLoading</span><span style="color: #e7e9db">(</span><span style="color: #815ba4">false</span><span style="color: #e7e9db">);</span>
    <span style="color: #e7e9db">};</span>

    <span style="color: #06b6ef">fetchData</span><span style="color: #e7e9db">();</span>
  <span style="color: #e7e9db">},</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">url</span><span style="color: #e7e9db">]);</span>

  <span style="color: #815ba4">const</span> <span style="color: #06b6ef">doFetch</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
    <span style="color: #06b6ef">setUrl</span><span style="color: #e7e9db">(</span><span style="color: #48b685">`http://hn.algolia.com/api/v1/search?query=</span><span style="color: #f99b15">${</span><span style="color: #06b6ef">query</span><span style="color: #f99b15">}</span><span style="color: #48b685">`</span><span style="color: #e7e9db">);</span>
  <span style="color: #e7e9db">};</span>

<span style="background-color: #4f424c">  <span style="color: #815ba4">return</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">data</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">isLoading</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">isError</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">doFetch</span> <span style="color: #e7e9db">};</span>
</span><span style="background-color: #4f424c"><span style="color: #e7e9db">}</span>
</span></code></pre>
              </div>


              <p>Now, your new hook can be used in the App component again:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">function</span> <span style="color: #06b6ef">App</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">query</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">setQuery</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">(</span><span style="color: #48b685">&#39;redux&#39;</span><span style="color: #e7e9db">);</span>
<span style="background-color: #4f424c">  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">data</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">isLoading</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">isError</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">doFetch</span> <span style="color: #e7e9db">}</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useHackerNewsApi</span><span style="color: #e7e9db">();</span>
</span>
  <span style="color: #815ba4">return</span> <span style="color: #e7e9db">(</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Fragment</span><span style="color: #5bc4bf">&gt;</span>
      <span style="color: #e7e9db">...</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/Fragment&gt;</span>
  <span style="color: #e7e9db">);</span>
<span style="color: #e7e9db">}</span>
</code></pre>
              </div>


              <p>Next, pass the URL state from the outside the <code>doFetch</code> function:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">const</span> <span style="color: #06b6ef">useHackerNewsApi</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
  <span style="color: #e7e9db">...</span>

  <span style="color: #06b6ef">useEffect</span><span style="color: #e7e9db">(</span>
    <span style="color: #e7e9db">...</span>
  <span style="color: #e7e9db">);</span>

<span style="background-color: #4f424c">  <span style="color: #815ba4">const</span> <span style="color: #06b6ef">doFetch</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">url</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
</span><span style="background-color: #4f424c">    <span style="color: #06b6ef">setUrl</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">url</span><span style="color: #e7e9db">);</span>
</span>  <span style="color: #e7e9db">};</span>

  <span style="color: #815ba4">return</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">data</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">isLoading</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">isError</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">doFetch</span> <span style="color: #e7e9db">};</span>
<span style="color: #e7e9db">};</span>

<span style="color: #815ba4">function</span> <span style="color: #06b6ef">App</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">query</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">setQuery</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">(</span><span style="color: #48b685">&#39;redux&#39;</span><span style="color: #e7e9db">);</span>
  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">data</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">isLoading</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">isError</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">doFetch</span> <span style="color: #e7e9db">}</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useHackerNewsApi</span><span style="color: #e7e9db">();</span>

  <span style="color: #815ba4">return</span> <span style="color: #e7e9db">(</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Fragment</span><span style="color: #5bc4bf">&gt;</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">form</span>
        <span style="color: #06b6ef">onSubmit</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">event</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
          <span style="color: #06b6ef">doFetch</span><span style="color: #e7e9db">(</span>
<span style="background-color: #4f424c">            <span style="color: #48b685">`http://hn.algolia.com/api/v1/search?query=</span><span style="color: #f99b15">${</span><span style="color: #06b6ef">query</span><span style="color: #f99b15">}</span><span style="color: #48b685">`</span><span style="color: #e7e9db">,</span>
</span>          <span style="color: #e7e9db">);</span>

          <span style="color: #06b6ef">event</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">preventDefault</span><span style="color: #e7e9db">();</span>
        <span style="color: #e7e9db">}}</span>
      <span style="color: #5bc4bf">&gt;</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">input</span>
          <span style="color: #06b6ef">type</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;text&quot;</span>
          <span style="color: #06b6ef">value</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">query</span><span style="color: #e7e9db">}</span>
          <span style="color: #06b6ef">onChange</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">event</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #06b6ef">setQuery</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">event</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">target</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">value</span><span style="color: #e7e9db">)}</span>
        <span style="color: #5bc4bf">/&gt;</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">button</span> <span style="color: #06b6ef">type</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;submit&quot;</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">Search</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/button&gt;</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/form&gt;</span>

      <span style="color: #e7e9db">...</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/Fragment&gt;</span>
  <span style="color: #e7e9db">);</span>
<span style="color: #e7e9db">}</span>
</code></pre>
              </div>


              <p>The initial state can be made generic too. Pass it simply to the new custom hook:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span><span style="color: #e7e9db">,</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">Fragment</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">useEffect</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #06b6ef">axios</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;axios&#39;</span><span style="color: #e7e9db">;</span>

<span style="background-color: #4f424c"><span style="color: #815ba4">const</span> <span style="color: #06b6ef">useDataApi</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">(</span><span style="color: #06b6ef">initialUrl</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">initialData</span><span style="color: #e7e9db">)</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
</span><span style="background-color: #4f424c">  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">data</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">setData</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">initialData</span><span style="color: #e7e9db">);</span>
</span><span style="background-color: #4f424c">  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">url</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">setUrl</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">initialUrl</span><span style="color: #e7e9db">);</span>
</span>  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">isLoading</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">setIsLoading</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">(</span><span style="color: #815ba4">false</span><span style="color: #e7e9db">);</span>
  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">isError</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">setIsError</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">(</span><span style="color: #815ba4">false</span><span style="color: #e7e9db">);</span>

  <span style="color: #06b6ef">useEffect</span><span style="color: #e7e9db">(()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
    <span style="color: #815ba4">const</span> <span style="color: #06b6ef">fetchData</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">async</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
      <span style="color: #06b6ef">setIsError</span><span style="color: #e7e9db">(</span><span style="color: #815ba4">false</span><span style="color: #e7e9db">);</span>
      <span style="color: #06b6ef">setIsLoading</span><span style="color: #e7e9db">(</span><span style="color: #815ba4">true</span><span style="color: #e7e9db">);</span>

      <span style="color: #815ba4">try</span> <span style="color: #e7e9db">{</span>
        <span style="color: #815ba4">const</span> <span style="color: #06b6ef">result</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">await</span> <span style="color: #06b6ef">axios</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">url</span><span style="color: #e7e9db">);</span>

        <span style="color: #06b6ef">setData</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">result</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">data</span><span style="color: #e7e9db">);</span>
      <span style="color: #e7e9db">}</span> <span style="color: #815ba4">catch</span> <span style="color: #e7e9db">(</span><span style="color: #06b6ef">error</span><span style="color: #e7e9db">)</span> <span style="color: #e7e9db">{</span>
        <span style="color: #06b6ef">setIsError</span><span style="color: #e7e9db">(</span><span style="color: #815ba4">true</span><span style="color: #e7e9db">);</span>
      <span style="color: #e7e9db">}</span>

      <span style="color: #06b6ef">setIsLoading</span><span style="color: #e7e9db">(</span><span style="color: #815ba4">false</span><span style="color: #e7e9db">);</span>
    <span style="color: #e7e9db">};</span>

    <span style="color: #06b6ef">fetchData</span><span style="color: #e7e9db">();</span>
  <span style="color: #e7e9db">},</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">url</span><span style="color: #e7e9db">]);</span>

  <span style="color: #815ba4">const</span> <span style="color: #06b6ef">doFetch</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">url</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
    <span style="color: #06b6ef">setUrl</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">url</span><span style="color: #e7e9db">);</span>
  <span style="color: #e7e9db">};</span>

  <span style="color: #815ba4">return</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">data</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">isLoading</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">isError</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">doFetch</span> <span style="color: #e7e9db">};</span>
<span style="color: #e7e9db">};</span>

<span style="color: #815ba4">function</span> <span style="color: #06b6ef">App</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">query</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">setQuery</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">(</span><span style="color: #48b685">&#39;redux&#39;</span><span style="color: #e7e9db">);</span>
<span style="background-color: #4f424c">  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">data</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">isLoading</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">isError</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">doFetch</span> <span style="color: #e7e9db">}</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useDataApi</span><span style="color: #e7e9db">(</span>
</span><span style="background-color: #4f424c">    <span style="color: #48b685">&#39;http://hn.algolia.com/api/v1/search?query=redux&#39;</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">    <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">hits</span><span style="color: #5bc4bf">:</span> <span style="color: #e7e9db">[]</span> <span style="color: #e7e9db">},</span>
</span><span style="background-color: #4f424c">  <span style="color: #e7e9db">);</span>
</span>
  <span style="color: #815ba4">return</span> <span style="color: #e7e9db">(</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Fragment</span><span style="color: #5bc4bf">&gt;</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">form</span>
        <span style="color: #06b6ef">onSubmit</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">event</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
          <span style="color: #06b6ef">doFetch</span><span style="color: #e7e9db">(</span>
            <span style="color: #48b685">`http://hn.algolia.com/api/v1/search?query=</span><span style="color: #f99b15">${</span><span style="color: #06b6ef">query</span><span style="color: #f99b15">}</span><span style="color: #48b685">`</span><span style="color: #e7e9db">,</span>
          <span style="color: #e7e9db">);</span>

          <span style="color: #06b6ef">event</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">preventDefault</span><span style="color: #e7e9db">();</span>
        <span style="color: #e7e9db">}}</span>
      <span style="color: #5bc4bf">&gt;</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">input</span>
          <span style="color: #06b6ef">type</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;text&quot;</span>
          <span style="color: #06b6ef">value</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">query</span><span style="color: #e7e9db">}</span>
          <span style="color: #06b6ef">onChange</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">event</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #06b6ef">setQuery</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">event</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">target</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">value</span><span style="color: #e7e9db">)}</span>
        <span style="color: #5bc4bf">/&gt;</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">button</span> <span style="color: #06b6ef">type</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;submit&quot;</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">Search</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/button&gt;</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/form&gt;</span>

      <span style="color: #e7e9db">{</span><span style="color: #06b6ef">isError</span> <span style="color: #5bc4bf">&amp;&amp;</span> <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">div</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">Something</span> <span style="color: #06b6ef">went</span> <span style="color: #06b6ef">wrong</span> <span style="color: #e7e9db">...</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/div&gt;}</span>

      <span style="color: #e7e9db">{</span><span style="color: #06b6ef">isLoading</span> <span style="color: #5bc4bf">?</span> <span style="color: #e7e9db">(</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">div</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">Loading</span> <span style="color: #e7e9db">...</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/div&gt;</span>
      <span style="color: #e7e9db">)</span> <span style="color: #5bc4bf">:</span> <span style="color: #e7e9db">(</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">ul</span><span style="color: #5bc4bf">&gt;</span>
          <span style="color: #e7e9db">{</span><span style="color: #06b6ef">data</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">hits</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">map</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">item</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">(</span>
            <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">li</span> <span style="color: #06b6ef">key</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">item</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">objectID</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span>
              <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">a</span> <span style="color: #06b6ef">href</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">item</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">url</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">item</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">title</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/a&gt;</span>
            <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/li&gt;</span>
          <span style="color: #e7e9db">))}</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/ul&gt;</span>
      <span style="color: #e7e9db">)}</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/Fragment&gt;</span>
  <span style="color: #e7e9db">);</span>
<span style="color: #e7e9db">}</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">App</span><span style="color: #e7e9db">;</span>
</code></pre>
              </div>


              <p>That&rsquo;s it for the data fetching with a custom hook. The hook itself doesn&rsquo;t know anything
                about the API. It receives all parameters from the outside and only manages necessary states such as the
                data, loading and error state. It executes the request and returns the data to the component using it as
                custom data fetching hook.</p>

              <h2 class="chapter-header" id="react-hooks-reducer-hook">Reducer Hook for Data Fetching</h2>

              <p>So far, we have used various state hooks to manage our data fetching state for the data, loading and
                error state. However, somehow all these states, managed with their own state hook, belong together
                because they care about the same cause. As you can see, they are all used within the data fetching
                function. A good indicator that they belong together is that they are used one after another (e.g.
                <code>setIsError</code>, <code>setIsLoading</code>). Let&rsquo;s combine all three of them with a
                Reducer Hook instead.</p>

              <p>A Reducer Hook returns us a state object and a function to alter the state object. The function &ndash;
                called dispatch function &ndash; takes an action which has a type and an optional payload. All this
                information is used in the actual reducer function to distill a new state from the previous state, the
                action&rsquo;s optional payload and type. Let&rsquo;s see how this works in code:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span><span style="color: #e7e9db">,</span> <span style="color: #e7e9db">{</span>
  <span style="color: #06b6ef">Fragment</span><span style="color: #e7e9db">,</span>
  <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">,</span>
  <span style="color: #06b6ef">useEffect</span><span style="color: #e7e9db">,</span>
<span style="background-color: #4f424c">  <span style="color: #06b6ef">useReducer</span><span style="color: #e7e9db">,</span>
</span><span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #06b6ef">axios</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;axios&#39;</span><span style="color: #e7e9db">;</span>

<span style="background-color: #4f424c"><span style="color: #815ba4">const</span> <span style="color: #06b6ef">dataFetchReducer</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">(</span><span style="color: #06b6ef">state</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">action</span><span style="color: #e7e9db">)</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
</span><span style="background-color: #4f424c">  <span style="color: #e7e9db">...</span>
</span><span style="background-color: #4f424c"><span style="color: #e7e9db">};</span>
</span>
<span style="color: #815ba4">const</span> <span style="color: #06b6ef">useDataApi</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">(</span><span style="color: #06b6ef">initialUrl</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">initialData</span><span style="color: #e7e9db">)</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">url</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">setUrl</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">initialUrl</span><span style="color: #e7e9db">);</span>

<span style="background-color: #4f424c">  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">state</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">dispatch</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useReducer</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">dataFetchReducer</span><span style="color: #e7e9db">,</span> <span style="color: #e7e9db">{</span>
</span><span style="background-color: #4f424c">    <span style="color: #06b6ef">isLoading</span><span style="color: #5bc4bf">:</span> <span style="color: #815ba4">false</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">    <span style="color: #06b6ef">isError</span><span style="color: #5bc4bf">:</span> <span style="color: #815ba4">false</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">    <span style="color: #06b6ef">data</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">initialData</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">  <span style="color: #e7e9db">});</span>
</span>
  <span style="color: #e7e9db">...</span>
<span style="color: #e7e9db">};</span>
</code></pre>
              </div>


              <p>The Reducer Hook takes the reducer function and an initial state object as parameters. In our case, the
                arguments of the initial states for the data, loading and error state didn&rsquo;t change, but they have
                been aggregated to one state object managed by one reducer hook instead of single state hooks.</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">const</span> <span style="color: #06b6ef">dataFetchReducer</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">(</span><span style="color: #06b6ef">state</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">action</span><span style="color: #e7e9db">)</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
  <span style="color: #e7e9db">...</span>
<span style="color: #e7e9db">};</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">useDataApi</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">(</span><span style="color: #06b6ef">initialUrl</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">initialData</span><span style="color: #e7e9db">)</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">url</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">setUrl</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">initialUrl</span><span style="color: #e7e9db">);</span>

  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">state</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">dispatch</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useReducer</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">dataFetchReducer</span><span style="color: #e7e9db">,</span> <span style="color: #e7e9db">{</span>
    <span style="color: #06b6ef">isLoading</span><span style="color: #5bc4bf">:</span> <span style="color: #815ba4">false</span><span style="color: #e7e9db">,</span>
    <span style="color: #06b6ef">isError</span><span style="color: #5bc4bf">:</span> <span style="color: #815ba4">false</span><span style="color: #e7e9db">,</span>
    <span style="color: #06b6ef">data</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">initialData</span><span style="color: #e7e9db">,</span>
  <span style="color: #e7e9db">});</span>

  <span style="color: #06b6ef">useEffect</span><span style="color: #e7e9db">(()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
    <span style="color: #815ba4">const</span> <span style="color: #06b6ef">fetchData</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">async</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
<span style="background-color: #4f424c">      <span style="color: #06b6ef">dispatch</span><span style="color: #e7e9db">({</span> <span style="color: #06b6ef">type</span><span style="color: #5bc4bf">:</span> <span style="color: #48b685">&#39;FETCH_INIT&#39;</span> <span style="color: #e7e9db">});</span>
</span>
      <span style="color: #815ba4">try</span> <span style="color: #e7e9db">{</span>
        <span style="color: #815ba4">const</span> <span style="color: #06b6ef">result</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">await</span> <span style="color: #06b6ef">axios</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">url</span><span style="color: #e7e9db">);</span>

<span style="background-color: #4f424c">        <span style="color: #06b6ef">dispatch</span><span style="color: #e7e9db">({</span> <span style="color: #06b6ef">type</span><span style="color: #5bc4bf">:</span> <span style="color: #48b685">&#39;FETCH_SUCCESS&#39;</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">payload</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">result</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">data</span> <span style="color: #e7e9db">});</span>
</span>      <span style="color: #e7e9db">}</span> <span style="color: #815ba4">catch</span> <span style="color: #e7e9db">(</span><span style="color: #06b6ef">error</span><span style="color: #e7e9db">)</span> <span style="color: #e7e9db">{</span>
<span style="background-color: #4f424c">        <span style="color: #06b6ef">dispatch</span><span style="color: #e7e9db">({</span> <span style="color: #06b6ef">type</span><span style="color: #5bc4bf">:</span> <span style="color: #48b685">&#39;FETCH_FAILURE&#39;</span> <span style="color: #e7e9db">});</span>
</span>      <span style="color: #e7e9db">}</span>
    <span style="color: #e7e9db">};</span>

    <span style="color: #06b6ef">fetchData</span><span style="color: #e7e9db">();</span>
  <span style="color: #e7e9db">},</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">url</span><span style="color: #e7e9db">]);</span>

  <span style="color: #e7e9db">...</span>
<span style="color: #e7e9db">};</span>
</code></pre>
              </div>


              <p>Now, when fetching data, the dispatch function can be used to send information to the reducer function.
                The object being send with the dispatch function has a mandatory <code>type</code> property and an
                optional <code>payload</code> property. The type tells the reducer function which state transition needs
                to be applied and the payload can additionally be used by the reducer to distill the new state. After
                all, we only have three state transitions: initializing the fetching process, notifying about a
                successful data fetching result, and notifying about an errornous data fetching result.</p>

              <p>In the end of the custom hook, the state is returned as before, but because we have a state object and
                not the standalone states anymore, the state object is returned as destrcutured object. This way, the
                one who calls the <code>useDataApi</code> custom hook still gets access to <code>data</code>,
                <code>isLoading</code> and <code>isError</code>:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">const</span> <span style="color: #06b6ef">useDataApi</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">(</span><span style="color: #06b6ef">initialUrl</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">initialData</span><span style="color: #e7e9db">)</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">url</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">setUrl</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">initialUrl</span><span style="color: #e7e9db">);</span>

  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">state</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">dispatch</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useReducer</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">dataFetchReducer</span><span style="color: #e7e9db">,</span> <span style="color: #e7e9db">{</span>
    <span style="color: #06b6ef">isLoading</span><span style="color: #5bc4bf">:</span> <span style="color: #815ba4">false</span><span style="color: #e7e9db">,</span>
    <span style="color: #06b6ef">isError</span><span style="color: #5bc4bf">:</span> <span style="color: #815ba4">false</span><span style="color: #e7e9db">,</span>
    <span style="color: #06b6ef">data</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">initialData</span><span style="color: #e7e9db">,</span>
  <span style="color: #e7e9db">});</span>

  <span style="color: #e7e9db">...</span>

  <span style="color: #815ba4">const</span> <span style="color: #06b6ef">doFetch</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">url</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
    <span style="color: #06b6ef">setUrl</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">url</span><span style="color: #e7e9db">);</span>
  <span style="color: #e7e9db">};</span>

<span style="background-color: #4f424c">  <span style="color: #815ba4">return</span> <span style="color: #e7e9db">{</span> <span style="color: #e7e9db">...</span><span style="color: #06b6ef">state</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">doFetch</span> <span style="color: #e7e9db">};</span>
</span><span style="color: #e7e9db">};</span>
</code></pre>
              </div>


              <p>Last but not least, the implementation of the reducer function is missing. It needs to act on three
                different state transitions called <code>FETCH_INIT</code>, <code>FETCH_SUCCESS</code> and
                <code>FETCH_FAILURE</code>. Each state transition needs to return a new state object. Let&rsquo;s see
                how this can be implemented with a switch case statement:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">const</span> <span style="color: #06b6ef">dataFetchReducer</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">(</span><span style="color: #06b6ef">state</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">action</span><span style="color: #e7e9db">)</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
<span style="background-color: #4f424c">  <span style="color: #815ba4">switch</span> <span style="color: #e7e9db">(</span><span style="color: #06b6ef">action</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">type</span><span style="color: #e7e9db">)</span> <span style="color: #e7e9db">{</span>
</span><span style="background-color: #4f424c">    <span style="color: #815ba4">case</span> <span style="color: #48b685">&#39;FETCH_INIT&#39;</span><span style="color: #5bc4bf">:</span>
</span><span style="background-color: #4f424c">      <span style="color: #815ba4">return</span> <span style="color: #e7e9db">{</span> <span style="color: #e7e9db">...</span><span style="color: #06b6ef">state</span> <span style="color: #e7e9db">};</span>
</span><span style="background-color: #4f424c">    <span style="color: #815ba4">case</span> <span style="color: #48b685">&#39;FETCH_SUCCESS&#39;</span><span style="color: #5bc4bf">:</span>
</span><span style="background-color: #4f424c">      <span style="color: #815ba4">return</span> <span style="color: #e7e9db">{</span> <span style="color: #e7e9db">...</span><span style="color: #06b6ef">state</span> <span style="color: #e7e9db">};</span>
</span><span style="background-color: #4f424c">    <span style="color: #815ba4">case</span> <span style="color: #48b685">&#39;FETCH_FAILURE&#39;</span><span style="color: #5bc4bf">:</span>
</span><span style="background-color: #4f424c">      <span style="color: #815ba4">return</span> <span style="color: #e7e9db">{</span> <span style="color: #e7e9db">...</span><span style="color: #06b6ef">state</span> <span style="color: #e7e9db">};</span>
</span><span style="background-color: #4f424c">    <span style="color: #815ba4">default</span><span style="color: #5bc4bf">:</span>
</span><span style="background-color: #4f424c">      <span style="color: #815ba4">throw</span> <span style="color: #815ba4">new</span> <span style="color: #e7e9db">Error();</span>
</span><span style="background-color: #4f424c">  <span style="color: #e7e9db">}</span>
</span><span style="color: #e7e9db">};</span>
</code></pre>
              </div>


              <p>A reducer function has access to the current state and the incoming action via its arguments. So far,
                in out switch case statement each state transition only returns the previous state. A destructuring
                statement is used to keep the state object immutable &ndash; meaning the state is never directly mutated
                &ndash; to enforce best practices. Now let&rsquo;s override a few of the current&rsquo;s state returned
                properties to alter the state with each state transition:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">const</span> <span style="color: #06b6ef">dataFetchReducer</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">(</span><span style="color: #06b6ef">state</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">action</span><span style="color: #e7e9db">)</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
  <span style="color: #815ba4">switch</span> <span style="color: #e7e9db">(</span><span style="color: #06b6ef">action</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">type</span><span style="color: #e7e9db">)</span> <span style="color: #e7e9db">{</span>
    <span style="color: #815ba4">case</span> <span style="color: #48b685">&#39;FETCH_INIT&#39;</span><span style="color: #5bc4bf">:</span>
      <span style="color: #815ba4">return</span> <span style="color: #e7e9db">{</span>
        <span style="color: #e7e9db">...</span><span style="color: #06b6ef">state</span><span style="color: #e7e9db">,</span>
<span style="background-color: #4f424c">        <span style="color: #06b6ef">isLoading</span><span style="color: #5bc4bf">:</span> <span style="color: #815ba4">true</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">        <span style="color: #06b6ef">isError</span><span style="color: #5bc4bf">:</span> <span style="color: #815ba4">false</span>
</span>      <span style="color: #e7e9db">};</span>
    <span style="color: #815ba4">case</span> <span style="color: #48b685">&#39;FETCH_SUCCESS&#39;</span><span style="color: #5bc4bf">:</span>
      <span style="color: #815ba4">return</span> <span style="color: #e7e9db">{</span>
        <span style="color: #e7e9db">...</span><span style="color: #06b6ef">state</span><span style="color: #e7e9db">,</span>
<span style="background-color: #4f424c">        <span style="color: #06b6ef">isLoading</span><span style="color: #5bc4bf">:</span> <span style="color: #815ba4">false</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">        <span style="color: #06b6ef">isError</span><span style="color: #5bc4bf">:</span> <span style="color: #815ba4">false</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">        <span style="color: #06b6ef">data</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">action</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">payload</span><span style="color: #e7e9db">,</span>
</span>      <span style="color: #e7e9db">};</span>
    <span style="color: #815ba4">case</span> <span style="color: #48b685">&#39;FETCH_FAILURE&#39;</span><span style="color: #5bc4bf">:</span>
      <span style="color: #815ba4">return</span> <span style="color: #e7e9db">{</span>
        <span style="color: #e7e9db">...</span><span style="color: #06b6ef">state</span><span style="color: #e7e9db">,</span>
<span style="background-color: #4f424c">        <span style="color: #06b6ef">isLoading</span><span style="color: #5bc4bf">:</span> <span style="color: #815ba4">false</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">        <span style="color: #06b6ef">isError</span><span style="color: #5bc4bf">:</span> <span style="color: #815ba4">true</span><span style="color: #e7e9db">,</span>
</span>      <span style="color: #e7e9db">};</span>
    <span style="color: #815ba4">default</span><span style="color: #5bc4bf">:</span>
      <span style="color: #815ba4">throw</span> <span style="color: #815ba4">new</span> <span style="color: #e7e9db">Error();</span>
  <span style="color: #e7e9db">}</span>
<span style="color: #e7e9db">};</span>
</code></pre>
              </div>


              <p>Now every state transition, decided by the action&rsquo;s type, returns a new state based on the
                previous state and the optional payload. For instance, in the case of a successful request, the payload
                is used to set the data of the new state object.</p>

              <p>In conclusion, the Reducer Hook makes sure that this portion of the state management is encapsulated
                with its own logic. By providing action types and optional payloads, you will always end up with a
                predicatbale state change. In addition, you will never run into invalid states. For instance, previously
                it would have been possible to accidently set the <code>isLoading</code> and <code>isError</code> states
                to true. What should be displayed in the UI for this case? Now, each state transition defined by the
                reducer function leads to a valid state object.</p>

              <h2 class="chapter-header" id="react-hooks-abort-data-fetching">Abort Data Fetching in Effect Hook</h2>

              <p>It&rsquo;s a common problem in React that component state is set even though the component got already
                unmounted (e.g. due to navigating away with React Router). I have written about this issue previously
                over here which describes <a
                  href="../react-warning-cant-call-setstate-on-an-unmounted-component/index.html">how to prevent setting
                  state for unmounted components</a> in various scenarios. Let&rsquo;s see how we can prevent to set
                state in our custom hook for the data fetching:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">const</span> <span style="color: #06b6ef">useDataApi</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">(</span><span style="color: #06b6ef">initialUrl</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">initialData</span><span style="color: #e7e9db">)</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">url</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">setUrl</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useState</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">initialUrl</span><span style="color: #e7e9db">);</span>

  <span style="color: #815ba4">const</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">state</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">dispatch</span><span style="color: #e7e9db">]</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">useReducer</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">dataFetchReducer</span><span style="color: #e7e9db">,</span> <span style="color: #e7e9db">{</span>
    <span style="color: #06b6ef">isLoading</span><span style="color: #5bc4bf">:</span> <span style="color: #815ba4">false</span><span style="color: #e7e9db">,</span>
    <span style="color: #06b6ef">isError</span><span style="color: #5bc4bf">:</span> <span style="color: #815ba4">false</span><span style="color: #e7e9db">,</span>
    <span style="color: #06b6ef">data</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">initialData</span><span style="color: #e7e9db">,</span>
  <span style="color: #e7e9db">});</span>

  <span style="color: #06b6ef">useEffect</span><span style="color: #e7e9db">(()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
<span style="background-color: #4f424c">    <span style="color: #815ba4">let</span> <span style="color: #06b6ef">didCancel</span> <span style="color: #5bc4bf">=</span> <span style="color: #815ba4">false</span><span style="color: #e7e9db">;</span>
</span>
    <span style="color: #815ba4">const</span> <span style="color: #06b6ef">fetchData</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">async</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
      <span style="color: #06b6ef">dispatch</span><span style="color: #e7e9db">({</span> <span style="color: #06b6ef">type</span><span style="color: #5bc4bf">:</span> <span style="color: #48b685">&#39;FETCH_INIT&#39;</span> <span style="color: #e7e9db">});</span>

      <span style="color: #815ba4">try</span> <span style="color: #e7e9db">{</span>
        <span style="color: #815ba4">const</span> <span style="color: #06b6ef">result</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">await</span> <span style="color: #06b6ef">axios</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">url</span><span style="color: #e7e9db">);</span>

<span style="background-color: #4f424c">        <span style="color: #815ba4">if</span> <span style="color: #e7e9db">(</span><span style="color: #5bc4bf">!</span><span style="color: #06b6ef">didCancel</span><span style="color: #e7e9db">)</span> <span style="color: #e7e9db">{</span>
</span>          <span style="color: #06b6ef">dispatch</span><span style="color: #e7e9db">({</span> <span style="color: #06b6ef">type</span><span style="color: #5bc4bf">:</span> <span style="color: #48b685">&#39;FETCH_SUCCESS&#39;</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">payload</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">result</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">data</span> <span style="color: #e7e9db">});</span>
<span style="background-color: #4f424c">        <span style="color: #e7e9db">}</span>
</span>      <span style="color: #e7e9db">}</span> <span style="color: #815ba4">catch</span> <span style="color: #e7e9db">(</span><span style="color: #06b6ef">error</span><span style="color: #e7e9db">)</span> <span style="color: #e7e9db">{</span>
<span style="background-color: #4f424c">        <span style="color: #815ba4">if</span> <span style="color: #e7e9db">(</span><span style="color: #5bc4bf">!</span><span style="color: #06b6ef">didCancel</span><span style="color: #e7e9db">)</span> <span style="color: #e7e9db">{</span>
</span>          <span style="color: #06b6ef">dispatch</span><span style="color: #e7e9db">({</span> <span style="color: #06b6ef">type</span><span style="color: #5bc4bf">:</span> <span style="color: #48b685">&#39;FETCH_FAILURE&#39;</span> <span style="color: #e7e9db">});</span>
<span style="background-color: #4f424c">        <span style="color: #e7e9db">}</span>
</span>      <span style="color: #e7e9db">}</span>
    <span style="color: #e7e9db">};</span>

    <span style="color: #06b6ef">fetchData</span><span style="color: #e7e9db">();</span>

<span style="background-color: #4f424c">    <span style="color: #815ba4">return</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
</span><span style="background-color: #4f424c">      <span style="color: #06b6ef">didCancel</span> <span style="color: #5bc4bf">=</span> <span style="color: #815ba4">true</span><span style="color: #e7e9db">;</span>
</span><span style="background-color: #4f424c">    <span style="color: #e7e9db">};</span>
</span>  <span style="color: #e7e9db">},</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">url</span><span style="color: #e7e9db">]);</span>

  <span style="color: #815ba4">const</span> <span style="color: #06b6ef">doFetch</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">url</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
    <span style="color: #06b6ef">setUrl</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">url</span><span style="color: #e7e9db">);</span>
  <span style="color: #e7e9db">};</span>

  <span style="color: #815ba4">return</span> <span style="color: #e7e9db">{</span> <span style="color: #e7e9db">...</span><span style="color: #06b6ef">state</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">doFetch</span> <span style="color: #e7e9db">};</span>
<span style="color: #e7e9db">};</span>
</code></pre>
              </div>


              <p>Every Effect Hook comes with a clean up function which runs when a component unmounts. The clean up
                function is the one function returned from the hook. In our case, we use a boolean flag called
                <code>didCancel</code> to let our data fetching logic know about the state (mounted/unmounted) of the
                component. If the component did unmount, the flag should be set to <code>true</code> which results in
                preventing to set the component state after the data fetching has been asynchronously resolved
                eventually.</p>

              <p><em>Note: Actually not the data fetching is aborted &ndash; which could be achieved with <a
                    target="_blank" rel="noopener noreferrer" href="https://github.com/axios/axios#cancellation">Axios
                    Cancellation</a> &ndash; but the state transition is not performed anymore for the unmounted
                  component. Since Axios Cancellation has not the best API in my eyes, this boolean flag to prevent
                  setting state does the job as well.</em></p>

              <hr class="section-divider">

              <p>You have learned how the React hooks for state and effects can be used in React for data fetching. If
                you are curious about data fetching in class components (and function components) with render props and
                higher-order components, checkout out my other article from the beginning. Otherwise, I hope this
                article was useful to you for learning about React Hooks and how to use them in a real world scenario.
              </p>



              



              <div class="box-inline col-md-12">
                <div class="col-md-12 text-center">
                  <h2 class="newsletter">The Road to learn React</h2>

                  <div class="col-md-4">
                    <img class="img-lazy img-responsive" data-lazy-src="//img/page/cover.png">
                  </div>

                  <p class="lead">
                    Build a Hacker News App along the way. No setup configuration. No tooling. No Redux. Plain React in
                    200+ pages of learning material. Learn React like <strong>50.000+ readers</strong>.
                  </p>
                  <a class="btn btn-template-main" href="https://roadtoreact.com" target="_blank"
                    rel="noopener noreferrer">
                    Get the Book for free <i class="fa fa-chevron-right"></i>
                  </a>

                  <div>
                    <a href="https://amzn.to/2QY2ONp" target="_blank" rel="noopener noreferrer">
                      Get it from Amazon
                    </a>
                  </div>

                </div>
              </div>

            </div>



            


          </article>


        </div>


      </div>

    </div>




    <section class="bar background-image-fixed-2 no-mb color-white text-center">
      <div class="dark-mask"></div>
      <div class="container">
        <div class="row">
          <div class="col-md-12">
            <h3 class="lead">Never miss an article about web development, JavaScript and self-growth.</h3>
            <h2 class="text-uppercase">Take Part</h2>
          </div>

          <div class="col-md-12 text-center">

            <h3 class="lead"><i class="fa fa-check"></i> Join 30.000&#43; Developers</h3>

            <h3 class="lead"><i class="fa fa-check"></i> Learn Web Development with JavaScript</h3>

            <h3 class="lead"><i class="fa fa-check"></i> Tips and Tricks</h3>

            <h3 class="lead"><i class="fa fa-check"></i> Access Tutorials, eBooks and Courses</h3>

            <h3 class="lead"><i class="fa fa-check"></i> Personal Development as a Software Engineer</h3>

          </div>
          <div class="col-md-12">
            <p class="text-center">
              <div id="mc_embed_signup">
                <form action="https://www.getrevue.co/profile/rwieruch/add_subscriber" method="post" id="revue-form"
                  name="revue-form" target="_blank">
                  <div id="mc_embed_signup_scroll">
                    <input class="email" placeholder="email address" type="email" name="member[email]"
                      id="member_email">
                    <div>
                      <button type="submit" value="Subscribe" name="member[subscribe]" id="member_submit"
                        class="btn btn-template-transparent-black btn-lg">
                        Subscribe
                      </button>
                    </div>
                  </div>
                </form>
              </div>

            </p>
          </div>
        </div>
      </div>
    </section>
    <footer id="subfooter">
      <div class="container">

        <div class="col-md-5 col-sm-6">

          <h4>Recent posts</h4>

          <div class="blog-entries">

            <div class="item same-height-row clearfix">
              <div class="article same-height-always">
                <a href="../redux-vs-usereducer/index.html">

                  <img data-lazy-src="//img/posts/redux-vs-usereducer/banner.jpg" data-is-thumb="is-thumb"
                    class="img-lazy img-responsive" alt="React&#39;s useReducer vs Redux">

                </a>
              </div>
              <div class="name same-height-always">
                <h5><a href="../redux-vs-usereducer/index.html">React&#39;s useReducer vs Redux</a></h5>
              </div>
            </div>

            <div class="item same-height-row clearfix">
              <div class="article same-height-always">
                <a href="../publish-npm-package-node/index.html">

                  <img data-lazy-src="//img/posts/publish-npm-package-node/banner.jpg" data-is-thumb="is-thumb"
                    class="img-lazy img-responsive" alt="How to publish a npm package?">

                </a>
              </div>
              <div class="name same-height-always">
                <h5><a href="../publish-npm-package-node/index.html">How to publish a npm package?</a></h5>
              </div>
            </div>

            <div class="item same-height-row clearfix">
              <div class="article same-height-always">
                <a href="../react-scroll-to-item/index.html">

                  <img data-lazy-src="//img/posts/react-scroll-to-item/banner.jpg" data-is-thumb="is-thumb"
                    class="img-lazy img-responsive" alt="How to Scroll to Item in React?">

                </a>
              </div>
              <div class="name same-height-always">
                <h5><a href="../react-scroll-to-item/index.html">How to Scroll to Item in React?</a></h5>
              </div>
            </div>

          </div>

          <hr class="hidden-md hidden-lg hidden-sm">

        </div>



        <div class="col-md-5 col-md-offset-2 col-sm-6">

          <h4>About Me</h4>

          <div class="blog-entries">
            <div class="item same-height-row clearfix">
              <div class="profile same-height-always">
                <img class="img-lazy img-responsive" data-lazy-src="//img/page/profile.jpg" alt="profile">
              </div>
              <div class="name same-height-always">
                <p>
                  Hi, I'm Chris - a Midvale, Utah-based consulting software developer. Find out more <a
                    href="../about/index.html">about me</a>, <a href="../work-with-me/index.html">work with me</a>, or
                  have a look at my social media profiles below.
                </p>
              </div>
            </div>
          </div>

        </div>



      </div>

    </footer>


    <footer id="copyright">
      <div class="container">
        <div class="row">
          <div class="col-md-4">
            <ul class="info list-inline quicklinks pull-left">

              <li>© Chris Paul</li>

            </ul>
          </div>
          <div class="col-md-4">
            
          </div>
          <div class="col-md-4">
            <ul class="info list-inline quicklinks pull-right">

              <li><a aria-label="quicklinks" href="../legal/index.html">Legal Notice</a></li>

            </ul>
          </div>
        </div>
      </div>
    </footer>


  </div>



  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>

  <script src="../js/script.js"></script>
</body>

</html>