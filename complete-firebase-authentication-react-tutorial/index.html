<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta name="viewport" content="width=device-width, initial-scale=1">



  <title>
    A Firebase in React Tutorial for Beginners [2019] - CPaul
  </title>

  <meta name="author" content="" />
  <meta name="description"
    content="A beginners tutorial to learn Firebase in React for business application with authentication, authorization and a real-time database. The tutorial gives you the perfect React Firebase boilerplate project ...">


  <meta name="theme-color" content="#38bb6c" />

  <meta name="generator" content="Hugo 0.41" />
  <link href="https://cdn-images.mailchimp.com/embedcode/horizontal-slim-10_7.css" rel="stylesheet" type="text/css">

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
  <link href="../css/bootstrap.default.css" rel="stylesheet" id="theme-stylesheet">
  <link href="../css/customizations.css" rel="stylesheet">

  <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

  <link rel="shortcut icon" href="../img/favicon/favicon.ico" type="image/x-icon" />
  <link rel="apple-touch-icon" href="../img/favicon/apple-touch-icon.png" />
  <link rel="manifest" href="../img/favicon/manifest.json">
  <link rel="mask-icon" href="../img/favicon/safari-pinned-tab.svg" color="#5bbad5">

  <link rel="alternate" href="../index.xml" type="application/rss+xml" title="CPaul">

  <meta itemprop="name" content="A Firebase in React Tutorial for Beginners [2019]">
  <meta itemprop="description"
    content="A beginners tutorial to learn Firebase in React for business application with authentication, authorization and a real-time database. The tutorial gives you the perfect React Firebase boilerplate project ...">
  <meta itemprop="image"
    content="https://chrispaul.dev/img/posts/complete-firebase-authentication-react-tutorial/banner_640.jpg">
  <meta itemprop="keywords"
    content="angular,apollo,d3,graphql,growth,javascript,machine-learning,mobx,node,react,reason,redux,tooling,vue,web-development,angular,apollo,d3,graphql,growth,javascript,machine-learning,mobx,node,react,reason,redux,tooling,web-development," />


  <meta itemprop="wordCount" content="12543">

  <meta name="keywords"
    content="react firebase, react firebase tutorial, react authentication, react firebase authentication tutorial, react session, react authorization, react protected routes">

  <meta property="og:title" content="A Firebase in React Tutorial for Beginners [2019] - CPaul">


  <meta property="og:description"
    content="A beginners tutorial to learn Firebase in React for business application with authentication, authorization and a real-time database. The tutorial gives you the perfect React Firebase boilerplate project ..." />


  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://chrispaul.dev/complete-firebase-authentication-react-tutorial/" />
  <meta property="og:image"
    content="https://chrispaul.dev/img/posts/complete-firebase-authentication-react-tutorial/banner_640.jpg" />



  <meta name="news_keywords"
    content="react firebase,react firebase tutorial,react authentication,react firebase authentication tutorial,react session,react authorization,react protected routes" />



  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:image:src"
    content="https://chrispaul.dev/img/posts/complete-firebase-authentication-react-tutorial/banner_640.jpg" />
  <meta name="twitter:title" content="A Firebase in React Tutorial for Beginners [2019]" />
  <meta name="twitter:description"
    content="A beginners tutorial to learn Firebase in React for business application with authentication, authorization and a real-time database. The tutorial gives you the perfect React Firebase boilerplate project ..." />
  <meta name="twitter:site" content="@rwieruch" />
  <meta name="twitter:domain" content="rwieruch" />



</head>


<body>

  <div id="all">

    <header>

      <div class="navbar-affixed-top" data-spy="affix" data-offset-top="200">

        <div class="navbar navbar-default yamm" role="navigation" id="navbar">

          <div class="container">
            <div class="navbar-header">
              

              <div class="navbar-buttons">
                <button type="button" class="navbar-toggle btn-template-main" data-toggle="collapse"
                  data-target="#navigation">
                  <span class="sr-only">Toggle navigation</span>
                  <i class="fa fa-align-justify"></i>
                </button>
              </div>
            </div>


            <div class="navbar-collapse collapse" id="navigation">
              <ul class="nav navbar-nav navbar-right">

                <li class="dropdown">

                  <a href="../index.html">Blog</a>

                </li>

                <li class="dropdown">

                  <a href="../work-with-me/index.html">Work with me</a>

                </li>

                <li class="dropdown">

                  <a href="../about/index.html">About</a>

                </li>

                <li class="dropdown">

                  <a style="color: #38bb6c" href="https://roadtoreact.com/">Books &amp; Courses</a>

                </li>

              </ul>
            </div>


            <div class="collapse clearfix" id="search">

              <form class="navbar-form" role="search">
                <div class="input-group">
                  <input type="text" class="form-control" placeholder="Search">
                  <span class="input-group-btn">

                    <button type="submit" class="btn btn-template-main"><i class="fa fa-search"></i></button>

                  </span>
                </div>
              </form>

            </div>


          </div>
        </div>


      </div>
    </header>

    

    



    <div class="hidden-xs">


      <section class="bar background-image-fixed-2 no-mb color-white text-center">
        <div class="dark-mask"></div>
        <div class="container">
          <div class="row">
            <div class="col-md-12">
              <h3 class="lead">Never miss an article about web development, JavaScript and self-growth.</h3>
              <h2 class="text-uppercase newsletter">Take Part</h2>
            </div>

            <div class="col-md-12">
              <p class="text-center">
                <div id="mc_embed_signup">
                  <form action="https://www.getrevue.co/profile/rwieruch/add_subscriber" method="post" id="revue-form"
                    name="revue-form" target="_blank">
                    <div id="mc_embed_signup_scroll">
                      <input class="email" placeholder="email address" type="email" name="member[email]"
                        id="member_email">
                      <div>
                        <button type="submit" value="Subscribe" name="member[subscribe]" id="member_submit"
                          class="btn btn-template-transparent-black btn-lg">
                          Subscribe
                        </button>
                      </div>
                    </div>
                  </form>
                </div>

              </p>
            </div>
          </div>
        </div>
      </section>
    </div>

    <div id="content">
      <div class="container">

        <div class="row">

          <article class="col-md-8 col-md-offset-2" id="blog-post" itemprop="blogPosts" itemscope
            itemtype="http://schema.org/BlogPosting">

            <div id="post-content" itemprop="articleBody">

              <header>
                <h1 itemprop="name headline">A Firebase in React Tutorial for Beginners [2019]</h1>
              </header>

              

              <p class="text-muted text-uppercase mb-small text-center">
                <span itemprop="author publisher">

                </span>


                <time datetime="2018-11-20" itemprop="datePublished">
                  November 20, 2018
                </time>



                <span class="hidden-xs hidden-sm"> - <a target="_blank" rel="noopener noreferrer"
                    href="https://github.com/rwieruch/blog_chriswieruch_content/blob/master/complete-firebase-authentication-react-tutorial.md">
                    Edit this Post on GitHub
                  </a>
                </span>

              </p>



              <div>


              </div>

              <div class="post-image-primary">
                <div class="pinterest-pinner-wrapper" itemscope itemtype="http://schema.org/ImageObject">
                  <div class="pinterest-pinner">
                    <a data-pin-do="buttonPin" data-pin-save="true" data-pin-tall="true"
                      href="https://www.pinterest.com/pin/create/button/?url=https%3a%2f%2fchrispaul.dev%2fcomplete-firebase-authentication-react-tutorial%2f&amp;media=https://chrispaul.dev/img%2fposts%2fcomplete-firebase-authentication-react-tutorial%2fbanner.jpg&amp;description=">
                    </a>
                  </div>

                  <img class="img-lazy img-responsive"
                    data-lazy-src="/src="/img/posts/complete-firebase-authentication-react-tutorial/banner.jpg"
                    data-is-src-set="is-src-set" alt="react firebase" itemprop="image" />
                </div>
              </div>


              <p>
                <em>
                  Interested in reading this tutorial as one of many chapters in my advanced React with Firebase book?
                  Checkout the entire <a href="https://roadtoreact.com">The Road to React with Firebase</a> book that
                  teaches you to create business web applications without the need to create a backend application with
                  a database yourself.
                </em>
              </p>

              <p>This comprehensive tutorial walks you through a real-world application using React and Firebase. React
                is used to display applications in web browsers and to store local state in components, while Firebase
                is used for authentication, authorization, and managing a realtime database.</p>

              <p>After you&rsquo;ve mastered the basics of React, I always recommend moving on to advanced topics like
                authentication, authorization, and connecting React applications to databases. These operations make up
                the fundamentals real business applications need. Don&rsquo;t worry about implementing the backend
                application that manages it all yourself, as Firebase provides the perfect alternative. I have seen real
                businesses go from zero to profitable with only React and Firebase as their tools, myself included. No
                backend application with Node.js was needed, and this tutorial was created to show you how.</p>

              <p>50% of this tutorial&rsquo;s outcome can seen <a target="_blank" rel="noopener noreferrer"
                  href="https://react-firebase-authentication.wieruch.com/">here</a>. Security reasons prevent me from
                showing everything there, though the remaining material can be found in the book. To keep the guide
                updated, here is a list of the primary libraries and their versions used in this tutorial:</p>

              <ul>
                <li>React 16.7</li>
                <li>React Router 4</li>
                <li>Firebase 4</li>
              </ul>

              <p>Please let me know if the tutorial needs any updates for others learning about the topic, and
                don&rsquo;t hesitate to point out improvements in the comments, or you can visit the article directly on
                GitHub to open issues or pull requests.</p>

              <h2 class="chapter-header" id="requirements">Requirements</h2>

              <p>The requirements for this tutorial are a working <a href="../developer-setup/index.html">editor or
                  IDE/terminal</a>, and recent versions of <a target="_blank" rel="noopener noreferrer"
                  href="https://nodejs.org/en/">node and npm</a>. You should have learned about React in the first
                place. <a href="../the-road-to-learn-react/index.html">The Road to learn React</a> is a free ebook that
                provides all the fundamentals of React. You will build a larger application in plain React, and
                transition from JavaScript ES5 to JavaScript ES6 and beyond. This tutorial will not dive into all the
                details taught in the ebook, so take the chance to grab your copy of it to learn those first.</p>

              <div class="box-inline col-md-12">
                <div class="col-md-12 text-center">
                  <h2 class="newsletter">The Road to learn React</h2>
                  <div class="col-md-4">
                    <img class="img-lazy img-responsive" data-lazy-src="//img/page/cover.png" alt="package">
                  </div>
                  <p class="lead">
                    Build a Hacker News App along the way. No setup configuration. No tooling. No Redux. Plain React in
                    200+ pages of learning material. Pay what you want like <strong>50.000+ readers</strong>.
                  </p>
                  <a class="btn btn-template-main" href="https://roadtoreact.com/" target="_blank"
                    rel="noopener noreferrer">
                    Get the Book <i class="fa fa-chevron-right"></i>
                  </a>
                </div>
              </div>


              <h2 class="chapter-header" id="toc">Table of Contents</h2>

              <ul>
                <li><a href="#react-application-setup">React Application Setup: create-react-app</a></li>
                <li><a href="#react-router-setup">React Router for Firebase Auth</a></li>
                <li>Firebase Setup

                  <ul>
                    <li><a href="#react-firebase">Firebase in React Setup</a></li>
                    <li><a href="#react-firebase-context-api">Provide Firebase in React</a></li>
                  </ul>
                </li>
                <li>Firebase Authentication in React

                  <ul>
                    <li><a href="#firebase-authentication">Firebase&rsquo;s Authentication API</a></li>
                    <li><a href="#react-firebase-sign-up">Sign Up with React and Firebase</a></li>
                    <li><a href="#react-firebase-sign-in">Sign In with React and Firebase</a></li>
                    <li><a href="#react-firebase-sign-out">Sign Out with React and Firebase</a></li>
                    <li><a href="#react-firebase-session-handling">Session Handling with Firebase/React</a></li>
                    <li><a href="#react-firebase-session-handling-higher-order-components">Session Handling with
                        Higher-Order Components</a></li>
                    <li><a href="#react-firebase-password">Password Reset and Password Change with Firebase</a></li>
                  </ul>
                </li>
                <li>Firebase Authorization in React

                  <ul>
                    <li><a href="#react-firebase-protected-routes">Protected Routes in React with Authorization</a></li>
                  </ul>
                </li>
                <li>Firebase Realtime Database in React

                  <ul>
                    <li><a href="#react-firebase-realtime-database">Firebase Realtime Database in React</a></li>
                    <li><a href="#react-firebase-realtime-database-user-management">Manage Users with Firebase&rsquo;s
                        Realtime Database in React</a></li>
                  </ul>
                </li>
              </ul>

              <h2 class="chapter-header" id="react-application-setup">React Application Setup: create-react-app</h2>

              <p>Let&rsquo;s get started with the React + Firebase application we are going to build together. The
                application should be the perfect starter project to realize your ideas. It should be possible to
                display information with React, to navigate from URL to URL with React Router and to store and retrieve
                data with Firebase. Also the application will have everything that&rsquo;s needed to register, login and
                logout users. In the end, you should be able to implement any feature on top of this application to
                create well-rounded React applications.</p>

              <p>If you lack information on how to setup your React development environment, checkout these setup guides
                for <a href="../react-js-macos-setup/index.html">MacOS</a> and <a
                  href="../react-js-windows-setup/index.html">Windows</a>. Now, there are two ways to begin with this
                application: either follow my guidance in this section; or find a starter project in this <a
                  target="_blank" rel="noopener noreferrer"
                  href="https://github.com/the-road-to-react-with-firebase/react-firebase-authentication-starter-kit">GitHub
                  repository</a> and follow its installation instructions. This section will show how to set up the same
                project from scratch, whereas the starter project grants instant access without setting up the
                folder/file structure yourself.</p>

              <p>The application we are going to build with React and Firebase will be set up with Facebook&rsquo;s
                official React boilerplate project, called <a target="_blank" rel="noopener noreferrer"
                  href="https://github.com/facebookincubator/create-react-app">create-react-app</a>. You can install it
                globally on the command line once, after which it becomes available whenever you need it.</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #06b6ef">npm</span> <span style="color: #06b6ef">install</span> <span style="color: #5bc4bf">-</span><span style="color: #06b6ef">g</span> <span style="color: #06b6ef">create</span><span style="color: #5bc4bf">-</span><span style="color: #06b6ef">react</span><span style="color: #5bc4bf">-</span><span style="color: #06b6ef">app</span>
</code></pre>
              </div>


              <p>After the installation, set up your project with it on the command line whereas the name for the
                project is up to you. Afterward, navigate on the command line into the project:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #06b6ef">create</span><span style="color: #5bc4bf">-</span><span style="color: #06b6ef">react</span><span style="color: #5bc4bf">-</span><span style="color: #06b6ef">app</span> <span style="color: #06b6ef">react</span><span style="color: #5bc4bf">-</span><span style="color: #06b6ef">firebase</span><span style="color: #5bc4bf">-</span><span style="color: #06b6ef">authentication</span>
<span style="color: #06b6ef">cd</span> <span style="color: #06b6ef">react</span><span style="color: #5bc4bf">-</span><span style="color: #06b6ef">firebase</span><span style="color: #5bc4bf">-</span><span style="color: #06b6ef">authentication</span>
</code></pre>
              </div>


              <p>Now you have the following command on your command line to start your application. You can start your
                application and visit it in the browser:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #06b6ef">npm</span> <span style="color: #06b6ef">start</span>
</code></pre>
              </div>


              <p>Now we&rsquo;ll set up the project for our needs. First, get rid of the files from the boilerplate
                React project, since we won&rsquo;t be using them. From the command line, head to your <em>src/</em>
                folder and execute it:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #06b6ef">cd</span> <span style="color: #06b6ef">src</span>
<span style="color: #06b6ef">rm</span> <span style="color: #06b6ef">App</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">js</span> <span style="color: #06b6ef">App</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">test</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">js</span> <span style="color: #06b6ef">App</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">css</span> <span style="color: #06b6ef">logo</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">svg</span>
</code></pre>
              </div>


              <p>Second, create a <em>components/</em> folder in your application&rsquo;s <em>src/</em> folder on the
                command line. This is where all your components will be implemented. Also, the App component that you
                have removed in the previous step will be recreated here:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #06b6ef">mkdir</span> <span style="color: #06b6ef">components</span>
</code></pre>
              </div>


              <p>Create a dedicated folder for each component we will implement for this application. For the sake of
                readability, I split up the commands into multiple lines:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #06b6ef">cd</span> <span style="color: #06b6ef">components</span>
<span style="color: #06b6ef">mkdir</span> <span style="color: #06b6ef">Account</span> <span style="color: #06b6ef">Admin</span> <span style="color: #06b6ef">App</span> <span style="color: #06b6ef">Home</span> <span style="color: #06b6ef">Landing</span> <span style="color: #06b6ef">SignIn</span> <span style="color: #06b6ef">SignOut</span> <span style="color: #06b6ef">SignUp</span>
<span style="color: #06b6ef">mkdir</span> <span style="color: #06b6ef">Navigation</span> <span style="color: #06b6ef">PasswordChange</span> <span style="color: #06b6ef">PasswordForget</span>
<span style="color: #06b6ef">mkdir</span> <span style="color: #06b6ef">Session</span> <span style="color: #06b6ef">Firebase</span>
</code></pre>
              </div>


              <p>In each folder, create an <em>index.js</em> file for the component. Navigate into a folder, create the
                file, and navigate out again. Repeat these steps for every component. You can choose to name your
                folders/files differently, but that&rsquo;s how I liked to do it for my applications.</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #06b6ef">cd</span> <span style="color: #06b6ef">App</span>
<span style="color: #06b6ef">touch</span> <span style="color: #06b6ef">index</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">js</span>
<span style="color: #06b6ef">cd</span> <span style="color: #e7e9db">..</span>
</code></pre>
              </div>


              <p>Next, implement a basic React component for each file you created. For the App component in
                <em>src/components/App/index.js</em>, it could look like the following:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">App</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">(</span>
  <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">div</span><span style="color: #5bc4bf">&gt;</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">h1</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">App</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/h1&gt;</span>
  <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/div&gt;</span>
<span style="color: #e7e9db">);</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">App</span><span style="color: #e7e9db">;</span>
</code></pre>
              </div>


              <p>Fix the relative path to the App component in the <em>src/index.js</em> file. Since you have moved the
                App component to the <em>src/components</em> folder, you need to add the <em>/components</em> subpath to
                it.</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #06b6ef">ReactDOM</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react-dom&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">import</span> <span style="color: #48b685">&#39;./index.css&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #5bc4bf">*</span> <span style="color: #06b6ef">as</span> <span style="color: #06b6ef">serviceWorker</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;./serviceWorker&#39;</span><span style="color: #e7e9db">;</span>

<span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #06b6ef">App</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;./components/App&#39;</span><span style="color: #e7e9db">;</span>
</span>
<span style="color: #06b6ef">ReactDOM</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">render</span><span style="color: #e7e9db">(</span><span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">App</span> <span style="color: #5bc4bf">/&gt;</span><span style="color: #e7e9db">,</span> <span style="color: #e7e9db">document.</span><span style="color: #06b6ef">getElementById</span><span style="color: #e7e9db">(</span><span style="color: #48b685">&#39;root&#39;</span><span style="color: #e7e9db">));</span>

<span style="color: #06b6ef">serviceWorker</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">unregister</span><span style="color: #e7e9db">();</span>
</code></pre>
              </div>


              <p>Then, create one more folder in your <em>src/</em> folder:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #06b6ef">mkdir</span> <span style="color: #06b6ef">constants</span>
</code></pre>
              </div>


              <p>The folder should be located next to <em>src/components/</em>. Move into <em>src/constants/</em> and
                create two files for the application&rsquo;s routing and roles management later:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #06b6ef">cd</span> <span style="color: #06b6ef">constants</span>
<span style="color: #06b6ef">touch</span> <span style="color: #06b6ef">routes</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">js</span> <span style="color: #06b6ef">roles</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">js</span>
<span style="color: #06b6ef">cd</span> <span style="color: #e7e9db">..</span>
</code></pre>
              </div>


              <p>The application with its folders and files is set up, and you can verify this by running it on the
                command line and accessing it through a browser. Check the starter project on GitHub I linked in the
                beginning of this section to verify whether you have set up everything properly.</p>

              <h3 id="exercises">Exercises:</h3>

              <ul>
                <li>Familiarize yourself with the folder structure of a project.</li>
                <li>Optionally, introduce a test for your App component and test the application.</li>
                <li>Optionally, introduce <a href="../create-react-app-css-modules/index.html">CSS Modules</a>, <a
                    href="../create-react-app-with-sass-support/index.html">SASS</a> or <a target="_blank"
                    rel="noopener noreferrer" href="https://www.styled-components.com">Styled Components</a> and style
                  the application.</li>
                <li>Optionally, introduce <a href="../git-essential-commands/index.html">Git and keep track of your
                    changes by having your project on GitHub</a>.</li>
              </ul>

              <h2 class="chapter-header" id="react-router-setup">React Router for Firebase Auth</h2>

              <p>Since we are building a larger application in the following sections, it would be great to have a
                couple of pages (e.g. landing page, account page, admin page, sign up page, sign in page) to split the
                application into multiple URLs (e.g. /landing, /account, /admin). These URLs or subpaths of a domain are
                called routes in a client-side web application. Let&rsquo;s implement the routing with <a
                  target="_blank" rel="noopener noreferrer" href="https://github.com/ReactTraining/react-router">React
                  Router</a> before we dive into Firebase for the realtime database and authentication/authorization. If
                you haven&rsquo;t used React Router before, it should be straightforward to pick up the basics
                throughout building this application.</p>

              <p>The application should have multiple routes. For instance, a user should be able to visit a public
                landing page, and also use sign up and sign in pages to enter the application as an authenticated user.
                If a user is authenticated, it is possible to visit protected pages like account or admin pages whereas
                the latter is only accessible by authenticated users with an admin role. You can consolidate all the
                routes of your application in a well-defined <em>src/constants/routes.js</em> constants file:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">export</span> <span style="color: #815ba4">const</span> <span style="color: #06b6ef">LANDING</span> <span style="color: #5bc4bf">=</span> <span style="color: #48b685">&#39;/&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">export</span> <span style="color: #815ba4">const</span> <span style="color: #06b6ef">SIGN_UP</span> <span style="color: #5bc4bf">=</span> <span style="color: #48b685">&#39;/signup&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">export</span> <span style="color: #815ba4">const</span> <span style="color: #06b6ef">SIGN_IN</span> <span style="color: #5bc4bf">=</span> <span style="color: #48b685">&#39;/signin&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">export</span> <span style="color: #815ba4">const</span> <span style="color: #06b6ef">HOME</span> <span style="color: #5bc4bf">=</span> <span style="color: #48b685">&#39;/home&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">export</span> <span style="color: #815ba4">const</span> <span style="color: #06b6ef">ACCOUNT</span> <span style="color: #5bc4bf">=</span> <span style="color: #48b685">&#39;/account&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">export</span> <span style="color: #815ba4">const</span> <span style="color: #06b6ef">ADMIN</span> <span style="color: #5bc4bf">=</span> <span style="color: #48b685">&#39;/admin&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">export</span> <span style="color: #815ba4">const</span> <span style="color: #06b6ef">PASSWORD_FORGET</span> <span style="color: #5bc4bf">=</span> <span style="color: #48b685">&#39;/pw-forget&#39;</span><span style="color: #e7e9db">;</span>
</code></pre>
              </div>


              <p>Each route represents a page in your application. For instance, the sign up page should be reachable in
                development mode via <em><a href="http://localhost:3000/signup">http://localhost:3000/signup</a></em>
                and in production mode via <em><a href="http://yourdomain/signup">http://yourdomain/signup</a></em>.</p>

              <p>First, you will have a <strong>sign up page</strong> (register page) and a <strong>sign in
                  page</strong> (login page). You can take any web application as the blueprint to structure these
                routes for a well-rounded authentication experience. Take the following scenario: A user visits your web
                application, is convinced by your service, and finds the button in the top-level navigation to sign in
                to your application. But the user has no account yet, so a sign up button is presented as an alternative
                on the sign in page.</p>

              <div class="post-image-primary">
                <div class="pinterest-pinner-wrapper" itemscope itemtype="http://schema.org/ImageObject">
                  <div class="pinterest-pinner">
                    <a data-pin-do="buttonPin" data-pin-save="true" data-pin-tall="true"
                      href="https://www.pinterest.com/pin/create/button/?url=https%3a%2f%2fchrispaul.dev%2fcomplete-firebase-authentication-react-tutorial%2f&amp;media=https://chrispaul.dev/img%2fposts%2fcomplete-firebase-authentication-react-tutorial%2fsign.jpg&amp;description=">
                    </a>
                  </div>

                  <img class="img-lazy img-responsive"
                    data-lazy-src="/src="/img/posts/complete-firebase-authentication-react-tutorial/sign.jpg"
                    data-is-src-set="is-src-set" alt="react firebase login" itemprop="image" />
                </div>
              </div>


              <p>Second, there will be a <strong>landing page</strong> and a <strong>home page</strong>. The landing
                page is your default route (e.g. <em><a href="http://yourdomain/">http://yourdomain/</a></em>).
                That&rsquo;s the place where a user ends up when visiting your web application. The user doesn&rsquo;t
                need to be authenticated to go this route. On the other hand, the home page is a <strong>protected
                  route</strong>, which users can only access if they have been authenticated. You will implement the
                protection of the route using authorization mechanisms for this application.</p>

              <p>Third, next to the <strong>home page</strong>, there will be protected <strong>account page</strong>
                and <strong>admin page</strong> as well. On the account page, a user can reset or change a password. It
                is secured by authorization as well, so it is only reachable for authenticated users. On the admin page,
                a user authorized as admin will be able to manage this application&rsquo;s users. The admin page is
                protected on a more fine-grained level, because it is only accessible for authenticated admin users.</p>

              <div class="row">
                <div class="col-xs-8 col-centered">
                  <div class="post-image-primary">
                    <div class="pinterest-pinner-wrapper" itemscope itemtype="http://schema.org/ImageObject">
                      <div class="pinterest-pinner">
                        <a data-pin-do="buttonPin" data-pin-save="true" data-pin-tall="true"
                          href="https://www.pinterest.com/pin/create/button/?url=https%3a%2f%2fchrispaul.dev%2fcomplete-firebase-authentication-react-tutorial%2f&amp;media=https://chrispaul.dev/img%2fposts%2fcomplete-firebase-authentication-react-tutorial%2faccount.jpg&amp;description=">
                        </a>
                      </div>

                      <img class="img-lazy img-responsive"
                        data-lazy-src="/src="/img/posts/complete-firebase-authentication-react-tutorial/account.jpg"
                        data-is-src-set="is-src-set" alt="react firebase account" itemprop="image" />
                    </div>
                  </div>

                </div>
              </div>

              <p>Lastly, the <strong>password forget</strong> component will be exposed on another non-protected page, a
                <strong>password forget page</strong>, as well. It is used for users who are not authenticated and
                forgot about their password.</p>

              <div class="post-image-primary">
                <div class="pinterest-pinner-wrapper" itemscope itemtype="http://schema.org/ImageObject">
                  <div class="pinterest-pinner">
                    <a data-pin-do="buttonPin" data-pin-save="true" data-pin-tall="true"
                      href="https://www.pinterest.com/pin/create/button/?url=https%3a%2f%2fchrispaul.dev%2fcomplete-firebase-authentication-react-tutorial%2f&amp;media=https://chrispaul.dev/img%2fposts%2fcomplete-firebase-authentication-react-tutorial%2fpassword-reset.jpg&amp;description=">
                    </a>
                  </div>

                  <img class="img-lazy img-responsive"
                    data-lazy-src="/src="/img/posts/complete-firebase-authentication-react-tutorial/password-reset.jpg"
                    data-is-src-set="is-src-set" alt="react firebase password" itemprop="image" />
                </div>
              </div>


              <p>We&rsquo;ve completed the routes for this React with Firebase application. I find it exciting to build
                a well-rounded application with you, because it can be used as a boilerplate project that gives you
                authentication, authorization, and a database. These are foundational pillars for any web-based
                application.</p>

              <p>Now, all these routes need to be accessible to the user. First, you need a router for your web
                application, which is responsible to map routes to React components. React Router is a popular package
                to enable routing, so install it on the command line:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #06b6ef">npm</span> <span style="color: #06b6ef">install</span> <span style="color: #06b6ef">react</span><span style="color: #5bc4bf">-</span><span style="color: #06b6ef">router</span><span style="color: #5bc4bf">-</span><span style="color: #06b6ef">dom</span>
</code></pre>
              </div>


              <p>The best way to start is implementing a Navigation component that will be used in the App component.
                The App component is the perfect place to render the Navigation component, because it always renders the
                Navigation component but replaces the other components (pages) based on the routes. Basically, the App
                component is the container where all your fixed components are going (e.g. navigation bar, side bar,
                footer), but also your components that are displayed depending on the route in the URL (e.g. account
                page, login page, password forget page).</p>

              <p>First, the App component will use the Navigation component that is not implemented yet. Also, it uses
                the Router component provided by React Router. The Router makes it possible to navigate from URL-to-URL
                on the client-side application without another request to a web server for every route change. The
                application is only fetched once from a web server, after which all routing is done on the client-side
                with React Router.</p>

              <p>In <em>src/components/App/index.js</em> file:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>
<span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">BrowserRouter</span> <span style="color: #06b6ef">as</span> <span style="color: #06b6ef">Router</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react-router-dom&#39;</span><span style="color: #e7e9db">;</span>
</span>
<span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #06b6ef">Navigation</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../Navigation&#39;</span><span style="color: #e7e9db">;</span>
</span>
<span style="color: #815ba4">const</span> <span style="color: #06b6ef">App</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">(</span>
<span style="background-color: #4f424c">  <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Router</span><span style="color: #5bc4bf">&gt;</span>
</span><span style="background-color: #4f424c">    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Navigation</span> <span style="color: #5bc4bf">/&gt;</span>
</span><span style="background-color: #4f424c">  <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/Router&gt;</span>
</span><span style="color: #e7e9db">);</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">App</span><span style="color: #e7e9db">;</span>
</code></pre>
              </div>


              <p>Second, implement the Navigation component. It uses the Link component of React Router to enable
                navigation to different routes. These routes were defined previously in your constants file. Let&rsquo;s
                import all of them and give every Link component a specific route.</p>

              <p>In <em>src/components/Navigation/index.js</em> file:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>
<span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">Link</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react-router-dom&#39;</span><span style="color: #e7e9db">;</span>
</span>
<span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #5bc4bf">*</span> <span style="color: #06b6ef">as</span> <span style="color: #06b6ef">ROUTES</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../../constants/routes&#39;</span><span style="color: #e7e9db">;</span>
</span>
<span style="color: #815ba4">const</span> <span style="color: #06b6ef">Navigation</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">(</span>
  <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">div</span><span style="color: #5bc4bf">&gt;</span>
<span style="background-color: #4f424c">    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">ul</span><span style="color: #5bc4bf">&gt;</span>
</span><span style="background-color: #4f424c">      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">li</span><span style="color: #5bc4bf">&gt;</span>
</span><span style="background-color: #4f424c">        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Link</span> <span style="color: #06b6ef">to</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">ROUTES</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">SIGN_IN</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">Sign</span> <span style="color: #06b6ef">In</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/Link&gt;</span>
</span><span style="background-color: #4f424c">      <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/li&gt;</span>
</span><span style="background-color: #4f424c">      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">li</span><span style="color: #5bc4bf">&gt;</span>
</span><span style="background-color: #4f424c">        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Link</span> <span style="color: #06b6ef">to</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">ROUTES</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">LANDING</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">Landing</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/Link&gt;</span>
</span><span style="background-color: #4f424c">      <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/li&gt;</span>
</span><span style="background-color: #4f424c">      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">li</span><span style="color: #5bc4bf">&gt;</span>
</span><span style="background-color: #4f424c">        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Link</span> <span style="color: #06b6ef">to</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">ROUTES</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">HOME</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">Home</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/Link&gt;</span>
</span><span style="background-color: #4f424c">      <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/li&gt;</span>
</span><span style="background-color: #4f424c">      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">li</span><span style="color: #5bc4bf">&gt;</span>
</span><span style="background-color: #4f424c">        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Link</span> <span style="color: #06b6ef">to</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">ROUTES</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">ACCOUNT</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">Account</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/Link&gt;</span>
</span><span style="background-color: #4f424c">      <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/li&gt;</span>
</span><span style="background-color: #4f424c">      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">li</span><span style="color: #5bc4bf">&gt;</span>
</span><span style="background-color: #4f424c">        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Link</span> <span style="color: #06b6ef">to</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">ROUTES</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">ADMIN</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">Admin</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/Link&gt;</span>
</span><span style="background-color: #4f424c">      <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/li&gt;</span>
</span><span style="background-color: #4f424c">    <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/ul&gt;</span>
</span>  <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/div&gt;</span>
<span style="color: #e7e9db">);</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">Navigation</span><span style="color: #e7e9db">;</span>
</code></pre>
              </div>


              <p>Now, run your application again and verify that the links show up in your browser, and that once you
                click a link, the URL changes. Notice that even though the URL changes, the displayed content
                doesn&rsquo;t change. The navigation is only there to enable navigation through your application. But no
                one knows what to render on each route. That&rsquo;s where the <em>route to component</em> mapping comes
                in. In your App component, you can specify which components should show up according to corresponding
                routes with the help of the Route component from React Router.</p>

              <p>In <em>src/components/App/index.js</em> file:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span>
  <span style="color: #06b6ef">BrowserRouter</span> <span style="color: #06b6ef">as</span> <span style="color: #06b6ef">Router</span><span style="color: #e7e9db">,</span>
<span style="background-color: #4f424c">  <span style="color: #06b6ef">Route</span><span style="color: #e7e9db">,</span>
</span><span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react-router-dom&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">import</span> <span style="color: #06b6ef">Navigation</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../Navigation&#39;</span><span style="color: #e7e9db">;</span>
<span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #06b6ef">LandingPage</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../Landing&#39;</span><span style="color: #e7e9db">;</span>
</span><span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #06b6ef">SignUpPage</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../SignUp&#39;</span><span style="color: #e7e9db">;</span>
</span><span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #06b6ef">SignInPage</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../SignIn&#39;</span><span style="color: #e7e9db">;</span>
</span><span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #06b6ef">PasswordForgetPage</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../PasswordForget&#39;</span><span style="color: #e7e9db">;</span>
</span><span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #06b6ef">HomePage</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../Home&#39;</span><span style="color: #e7e9db">;</span>
</span><span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #06b6ef">AccountPage</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../Account&#39;</span><span style="color: #e7e9db">;</span>
</span><span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #06b6ef">AdminPage</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../Admin&#39;</span><span style="color: #e7e9db">;</span>
</span>
<span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #5bc4bf">*</span> <span style="color: #06b6ef">as</span> <span style="color: #06b6ef">ROUTES</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../../constants/routes&#39;</span><span style="color: #e7e9db">;</span>
</span>
<span style="color: #815ba4">const</span> <span style="color: #06b6ef">App</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">(</span>
  <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Router</span><span style="color: #5bc4bf">&gt;</span>
<span style="background-color: #4f424c">    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">div</span><span style="color: #5bc4bf">&gt;</span>
</span>      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Navigation</span> <span style="color: #5bc4bf">/&gt;</span>
<span style="background-color: #4f424c">
</span><span style="background-color: #4f424c">      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">hr</span> <span style="color: #5bc4bf">/&gt;</span>
</span><span style="background-color: #4f424c">
</span><span style="background-color: #4f424c">      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Route</span> <span style="color: #06b6ef">exact</span> <span style="color: #06b6ef">path</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">ROUTES</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">LANDING</span><span style="color: #e7e9db">}</span> <span style="color: #06b6ef">component</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">LandingPage</span><span style="color: #e7e9db">}</span> <span style="color: #5bc4bf">/&gt;</span>
</span><span style="background-color: #4f424c">      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Route</span> <span style="color: #06b6ef">path</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">ROUTES</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">SIGN_UP</span><span style="color: #e7e9db">}</span> <span style="color: #06b6ef">component</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">SignUpPage</span><span style="color: #e7e9db">}</span> <span style="color: #5bc4bf">/&gt;</span>
</span><span style="background-color: #4f424c">      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Route</span> <span style="color: #06b6ef">path</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">ROUTES</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">SIGN_IN</span><span style="color: #e7e9db">}</span> <span style="color: #06b6ef">component</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">SignInPage</span><span style="color: #e7e9db">}</span> <span style="color: #5bc4bf">/&gt;</span>
</span><span style="background-color: #4f424c">      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Route</span> <span style="color: #06b6ef">path</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">ROUTES</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">PASSWORD_FORGET</span><span style="color: #e7e9db">}</span> <span style="color: #06b6ef">component</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">PasswordForgetPage</span><span style="color: #e7e9db">}</span> <span style="color: #5bc4bf">/&gt;</span>
</span><span style="background-color: #4f424c">      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Route</span> <span style="color: #06b6ef">path</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">ROUTES</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">HOME</span><span style="color: #e7e9db">}</span> <span style="color: #06b6ef">component</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">HomePage</span><span style="color: #e7e9db">}</span> <span style="color: #5bc4bf">/&gt;</span>
</span><span style="background-color: #4f424c">      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Route</span> <span style="color: #06b6ef">path</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">ROUTES</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">ACCOUNT</span><span style="color: #e7e9db">}</span> <span style="color: #06b6ef">component</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">AccountPage</span><span style="color: #e7e9db">}</span> <span style="color: #5bc4bf">/&gt;</span>
</span><span style="background-color: #4f424c">      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Route</span> <span style="color: #06b6ef">path</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">ROUTES</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">ADMIN</span><span style="color: #e7e9db">}</span> <span style="color: #06b6ef">component</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">AdminPage</span><span style="color: #e7e9db">}</span> <span style="color: #5bc4bf">/&gt;</span>
</span><span style="background-color: #4f424c">    <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/div&gt;</span>
</span>  <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/Router&gt;</span>
<span style="color: #e7e9db">);</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">App</span><span style="color: #e7e9db">;</span>
</code></pre>
              </div>


              <p>If a route matches a path prop, the respective component will be displayed; thus, all the page
                components in the App component are exchangeable by changing the route, but the Navigation component
                stays fixed independently of any route changes. This is how you enable a static frame with various
                components (e.g. Navigation) around your dynamic pages driven by routes. It&rsquo;s all made possible by
                <a href="../react-component-composition/index.html">React&rsquo;s powerful composition</a>.</p>

              <p>Previously, you created basic components for each page component used by our routes. Now you should be
                able to start the application again. When you click through the links in the Navigation component, the
                displayed page component should change according to the URL. The routes for the PasswordForget and
                SignUp components are not used in the Navigation component, but will be defined elsewhere later. For
                now, you have successfully implemented fundamental routing for this application.</p>

              <h3 id="exercises-1">Exercises:</h3>

              <ul>
                <li>Learn more about <a target="_blank" rel="noopener noreferrer"
                    href="https://reacttraining.com/react-router/web/guides/quick-start">React Router</a></li>
                <li>Confirm your <a target="_blank" rel="noopener noreferrer" href="http://bit.ly/2VmQnNi">source code
                    for the last section</a></li>
              </ul>

              <h2 class="chapter-header" id="react-firebase">Firebase in React Setup</h2>

              <p>The main focus here is using Firebase in React for the application we&rsquo;ll build together.
                Firebase, bought by Google in 2014, enables realtime databases, extensive authentication and
                authorization, and even for deployment. You can build real-world applications with React and Firebase
                without worrying about implementing a backend application. All the things a backend application would
                handle, like authentication and a database, is handled by Firebase. Many businesses use React and
                Firebase to power their applications, as it is the ultimate combination to launch an <a target="_blank"
                  rel="noopener noreferrer" href="https://en.wikipedia.org/wiki/Minimum_viable_product">MVP</a>.</p>

              <p>To start, sign up on the <a target="_blank" rel="noopener noreferrer"
                  href="https://firebase.google.com/">official Firebase website</a>. After you have created a Firebase
                account, you should be able to create projects and be granted access to the project dashboard.
                We&rsquo;ll begin by creating a project for this application on their platform whereas the project can
                have any name. In the case of this application, run it on the free pricing plan. If you want to scale
                your application later, you can change the plan. Follow this <a
                  href="../firebase-tutorial/index.html">visual Firebase setup and introduction guide</a> to learn more
                about Firebase&rsquo;s dashboard and features. It would also give you first guidelines on how to acivate
                Firebase&rsquo;s Realtime Database instead of Firebase&rsquo;s Cloud Firestore.</p>

              <p>Next, find the project&rsquo;s configuration in the settings on your project&rsquo;s dashboard. There,
                you&rsquo;ll have access to all the necessary information: secrets, keys, ids and other details to set
                up your application. Copy these in the next step to your React application.</p>

              <div class="row">
                <div class="col-xs-8 col-centered">
                  <div class="post-image-primary">
                    <div class="pinterest-pinner-wrapper" itemscope itemtype="http://schema.org/ImageObject">
                      <div class="pinterest-pinner">
                        <a data-pin-do="buttonPin" data-pin-save="true" data-pin-tall="true"
                          href="https://www.pinterest.com/pin/create/button/?url=https%3a%2f%2fchrispaul.dev%2fcomplete-firebase-authentication-react-tutorial%2f&amp;media=https://chrispaul.dev/img%2fposts%2fcomplete-firebase-authentication-react-tutorial%2ffirebase-config.jpg&amp;description=">
                        </a>
                      </div>

                      <img class="img-lazy img-responsive"
                        data-lazy-src="/src="/img/posts/complete-firebase-authentication-react-tutorial/firebase-config.jpg"
                        data-is-src-set="is-src-set" alt="firebase config" itemprop="image" />
                    </div>
                  </div>

                </div>
              </div>

              <p>Sometimes the Firebase website doesn&rsquo;t make it easy to find this page. Since it&rsquo;s moved
                around with every iteration of the website, I cannot give you any clear advice where to find it on your
                dashboard. This is an opportunity to familiarize yourself with Firebase project&rsquo;s dashboard while
                you search for the configuration.</p>

              <div class="post-image-primary">
                <div class="pinterest-pinner-wrapper" itemscope itemtype="http://schema.org/ImageObject">
                  <div class="pinterest-pinner">
                    <a data-pin-do="buttonPin" data-pin-save="true" data-pin-tall="true"
                      href="https://www.pinterest.com/pin/create/button/?url=https%3a%2f%2fchrispaul.dev%2fcomplete-firebase-authentication-react-tutorial%2f&amp;media=https://chrispaul.dev/img%2fposts%2fcomplete-firebase-authentication-react-tutorial%2ffirebase-web-settings.jpg&amp;description=">
                    </a>
                  </div>

                  <img class="img-lazy img-responsive"
                    data-lazy-src="/src="/img/posts/complete-firebase-authentication-react-tutorial/firebase-web-settings.jpg"
                    data-is-src-set="is-src-set" alt="firebase web settings" itemprop="image" />
                </div>
              </div>


              <p>Now that we&rsquo;ve completed the Firebase setup, you can return to your application in your
                editor/IDE to add the Firebase configuration. First, install Firebase for your application on the
                command line:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #06b6ef">npm</span> <span style="color: #06b6ef">install</span> <span style="color: #06b6ef">firebase</span>
</code></pre>
              </div>


              <p>Next, we&rsquo;ll create a new file for the Firebase setup. We will use a JavaScript class to
                encapsulate all Firebase functionalities, realtime database, and authentication, as a well-defined API
                for the rest of the application. You need only instantiate the class once, after which it can use it
                then to interact with the Firebase API, your custom Firebase interface.</p>

              <p>Let&rsquo;s start by copying the configuration from your Firebase project&rsquo;s dashboard on their
                website to your application as a configuration object in a new
                <em>src/components/Firebase/firebase.js</em> file. Make sure to replace the capitalized keys with the
                corresponding keys from your copied configuration:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">const</span> <span style="color: #06b6ef">config</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">{</span>
  <span style="color: #06b6ef">apiKey</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">YOUR_API_KEY</span><span style="color: #e7e9db">,</span>
  <span style="color: #06b6ef">authDomain</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">YOUR_AUTH_DOMAIN</span><span style="color: #e7e9db">,</span>
  <span style="color: #06b6ef">databaseURL</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">YOUR_DATABASE_URL</span><span style="color: #e7e9db">,</span>
  <span style="color: #06b6ef">projectId</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">YOUR_PROJECT_ID</span><span style="color: #e7e9db">,</span>
  <span style="color: #06b6ef">storageBucket</span><span style="color: #5bc4bf">:</span> <span style="color: #48b685">&#39;&#39;</span><span style="color: #e7e9db">,</span>
  <span style="color: #06b6ef">messagingSenderId</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">YOUR_MESSAGING_SENDER_ID</span><span style="color: #e7e9db">,</span>
<span style="color: #e7e9db">};</span>
</code></pre>
              </div>


              <p>As alternative, you can also use environment variables in React applications, but you have to use the
                <code>REACT_APP</code> prefix when you use create-react-app to set up the application:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">const</span> <span style="color: #06b6ef">config</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">{</span>
<span style="background-color: #4f424c">  <span style="color: #06b6ef">apiKey</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">process</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">env</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">REACT_APP_API_KEY</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">  <span style="color: #06b6ef">authDomain</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">process</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">env</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">REACT_APP_AUTH_DOMAIN</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">  <span style="color: #06b6ef">databaseURL</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">process</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">env</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">REACT_APP_DATABASE_URL</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">  <span style="color: #06b6ef">projectId</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">process</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">env</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">REACT_APP_PROJECT_ID</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">  <span style="color: #06b6ef">storageBucket</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">process</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">env</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">REACT_APP_STORAGE_BUCKET</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">  <span style="color: #06b6ef">messagingSenderId</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">process</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">env</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">REACT_APP_MESSAGING_SENDER_ID</span><span style="color: #e7e9db">,</span>
</span><span style="color: #e7e9db">};</span>
</code></pre>
              </div>


              <p>Now you can define the environmental variables in a new <em>.env</em> file in your project&rsquo;s root
                folder. The <em>.env</em> file can also be added to your <em>.gitginore</em> file (in case you are using
                git), so your Firebase credentials are not exposed publicly on a platform like GitHub.</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #06b6ef">REACT_APP_API_KEY</span><span style="color: #5bc4bf">=</span><span style="color: #06b6ef">XXXXxxxx</span>
<span style="color: #06b6ef">REACT_APP_AUTH_DOMAIN</span><span style="color: #5bc4bf">=</span><span style="color: #06b6ef">xxxxXXXX</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">firebaseapp</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">com</span>
<span style="color: #06b6ef">REACT_APP_DATABASE_URL</span><span style="color: #5bc4bf">=</span><span style="color: #06b6ef">https</span><span style="color: #5bc4bf">:</span><span style="color: #776e71">//xxxXXXX.firebaseio.com</span>
<span style="color: #06b6ef">REACT_APP_PROJECT_ID</span><span style="color: #5bc4bf">=</span><span style="color: #06b6ef">xxxxXXXX</span>
<span style="color: #06b6ef">REACT_APP_STORAGE_BUCKET</span><span style="color: #5bc4bf">=</span><span style="color: #06b6ef">xxxxXXXX</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">appspot</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">com</span>
<span style="color: #06b6ef">REACT_APP_MESSAGING_SENDER_ID</span><span style="color: #5bc4bf">=</span><span style="color: #06b6ef">xxxxXXXX</span>
</code></pre>
              </div>


              <p>Both ways work. You can define the configuration inline in source code or as environment variables.
                Environmental variables are more secure, and should be used when uploading your project to a version
                control system like git, though we will be continuing with the Firebase setup. Import firebase from the
                library you installed earlier, and then use it within a new Firebase class to initialize firebase with
                the configuration:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #06b6ef">app</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;firebase/app&#39;</span><span style="color: #e7e9db">;</span>
</span>
<span style="color: #815ba4">const</span> <span style="color: #06b6ef">config</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">{</span>
  <span style="color: #06b6ef">apiKey</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">process</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">env</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">REACT_APP_API_KEY</span><span style="color: #e7e9db">,</span>
  <span style="color: #06b6ef">authDomain</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">process</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">env</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">REACT_APP_AUTH_DOMAIN</span><span style="color: #e7e9db">,</span>
  <span style="color: #06b6ef">databaseURL</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">process</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">env</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">REACT_APP_DATABASE_URL</span><span style="color: #e7e9db">,</span>
  <span style="color: #06b6ef">projectId</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">process</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">env</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">REACT_APP_PROJECT_ID</span><span style="color: #e7e9db">,</span>
  <span style="color: #06b6ef">storageBucket</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">process</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">env</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">REACT_APP_STORAGE_BUCKET</span><span style="color: #e7e9db">,</span>
  <span style="color: #06b6ef">messagingSenderId</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">process</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">env</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">REACT_APP_MESSAGING_SENDER_ID</span><span style="color: #e7e9db">,</span>
<span style="color: #e7e9db">};</span>

<span style="background-color: #4f424c"><span style="color: #815ba4">class</span> <span style="color: #06b6ef">Firebase</span> <span style="color: #e7e9db">{</span>
</span><span style="background-color: #4f424c">  <span style="color: #06b6ef">constructor</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
</span><span style="background-color: #4f424c">    <span style="color: #06b6ef">app</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">initializeApp</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">config</span><span style="color: #e7e9db">);</span>
</span><span style="background-color: #4f424c">  <span style="color: #e7e9db">}</span>
</span><span style="background-color: #4f424c"><span style="color: #e7e9db">}</span>
</span>
<span style="background-color: #4f424c"><span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">Firebase</span><span style="color: #e7e9db">;</span>
</span></code></pre>
              </div>


              <p>That&rsquo;s all that is needed for a firebase configuration in your application. Optionally, you can
                create a second Firebase project on the Firebase website to have one project for your development
                environment and one project for your production environment. That way, you never mix data in the
                Firebase database in development mode with data from your deployed application (production mode). If you
                decide to create projects for both environments, use the two configuration objects in your Firebase
                setup and decide which one you take depending on the development/production environment:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">app</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;firebase/app&#39;</span><span style="color: #e7e9db">;</span>

<span style="background-color: #4f424c"><span style="color: #815ba4">const</span> <span style="color: #06b6ef">prodConfig</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">{</span>
</span><span style="background-color: #4f424c">  <span style="color: #06b6ef">apiKey</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">process</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">env</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">REACT_APP_PROD_API_KEY</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">  <span style="color: #06b6ef">authDomain</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">process</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">env</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">REACT_APP_PROD_AUTH_DOMAIN</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">  <span style="color: #06b6ef">databaseURL</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">process</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">env</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">REACT_APP_PROD_DATABASE_URL</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">  <span style="color: #06b6ef">projectId</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">process</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">env</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">REACT_APP_PROD_PROJECT_ID</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">  <span style="color: #06b6ef">storageBucket</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">process</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">env</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">REACT_APP_PROD_STORAGE_BUCKET</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">  <span style="color: #06b6ef">messagingSenderId</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">process</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">env</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">REACT_APP_PROD_MESSAGING_SENDER_ID</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c"><span style="color: #e7e9db">};</span>
</span>
<span style="background-color: #4f424c"><span style="color: #815ba4">const</span> <span style="color: #06b6ef">devConfig</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">{</span>
</span><span style="background-color: #4f424c">  <span style="color: #06b6ef">apiKey</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">process</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">env</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">REACT_APP_DEV_API_KEY</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">  <span style="color: #06b6ef">authDomain</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">process</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">env</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">REACT_APP_DEV_AUTH_DOMAIN</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">  <span style="color: #06b6ef">databaseURL</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">process</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">env</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">REACT_APP_DEV_DATABASE_URL</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">  <span style="color: #06b6ef">projectId</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">process</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">env</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">REACT_APP_DEV_PROJECT_ID</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">  <span style="color: #06b6ef">storageBucket</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">process</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">env</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">REACT_APP_DEV_STORAGE_BUCKET</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">  <span style="color: #06b6ef">messagingSenderId</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">process</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">env</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">REACT_APP_DEV_MESSAGING_SENDER_ID</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c"><span style="color: #e7e9db">};</span>
</span>
<span style="background-color: #4f424c"><span style="color: #815ba4">const</span> <span style="color: #06b6ef">config</span> <span style="color: #5bc4bf">=</span>
</span><span style="background-color: #4f424c">  <span style="color: #06b6ef">process</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">env</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">NODE_ENV</span> <span style="color: #5bc4bf">===</span> <span style="color: #48b685">&#39;production&#39;</span> <span style="color: #5bc4bf">?</span> <span style="color: #06b6ef">prodConfig</span> <span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">devConfig</span><span style="color: #e7e9db">;</span>
</span>
<span style="color: #815ba4">class</span> <span style="color: #06b6ef">Firebase</span> <span style="color: #e7e9db">{</span>
  <span style="color: #06b6ef">constructor</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
    <span style="color: #06b6ef">app</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">initializeApp</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">config</span><span style="color: #e7e9db">);</span>
  <span style="color: #e7e9db">}</span>
<span style="color: #e7e9db">}</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">Firebase</span><span style="color: #e7e9db">;</span>
</code></pre>
              </div>


              <p>An alternate way to implement this is to specify a dedicated <em>.env.development</em> and
                <em>.env.production</em> file for both kinds of environment variables in your project. Each file is used
                to define environmental variables for the matching environment. Defining a configuration becomes
                straightforward again, because you don&rsquo;t have to select the correct configuration yourself.</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">app</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;firebase/app&#39;</span><span style="color: #e7e9db">;</span>

<span style="background-color: #4f424c"><span style="color: #815ba4">const</span> <span style="color: #06b6ef">config</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">{</span>
</span><span style="background-color: #4f424c">  <span style="color: #06b6ef">apiKey</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">process</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">env</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">REACT_APP_API_KEY</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">  <span style="color: #06b6ef">authDomain</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">process</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">env</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">REACT_APP_AUTH_DOMAIN</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">  <span style="color: #06b6ef">databaseURL</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">process</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">env</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">REACT_APP_DATABASE_URL</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">  <span style="color: #06b6ef">projectId</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">process</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">env</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">REACT_APP_PROJECT_ID</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">  <span style="color: #06b6ef">storageBucket</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">process</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">env</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">REACT_APP_STORAGE_BUCKET</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">  <span style="color: #06b6ef">messagingSenderId</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">process</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">env</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">REACT_APP_MESSAGING_SENDER_ID</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c"><span style="color: #e7e9db">};</span>
</span>
<span style="color: #815ba4">class</span> <span style="color: #06b6ef">Firebase</span> <span style="color: #e7e9db">{</span>
  <span style="color: #06b6ef">constructor</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
    <span style="color: #06b6ef">app</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">initializeApp</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">config</span><span style="color: #e7e9db">);</span>
  <span style="color: #e7e9db">}</span>
<span style="color: #e7e9db">}</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">Firebase</span><span style="color: #e7e9db">;</span>
</code></pre>
              </div>


              <p>Whether you used environment variables, defined the configuration inline, used only one Firebase
                project, or multiple projects for each environment, you configured Firebase for your React application.
                The next section will show you how a Firebase instance created from the Firebase class is used in React.
              </p>

              <h3 id="exercises-2">Exercises:</h3>

              <ul>
                <li>Read more about the <a target="_blank" rel="noopener noreferrer"
                    href="https://firebase.google.com/docs/web/setup">Firebase Setup for Web Applications</a></li>
                <li>Read more about <a target="_blank" rel="noopener noreferrer"
                    href="https://firebase.google.com/pricing/">Firebase&rsquo;s Pricing Plans</a> to know better about
                  the limitations of the free plan.</li>
                <li>Confirm your <a target="_blank" rel="noopener noreferrer" href="http://bit.ly/2VqqWKP">source code
                    for the last section</a></li>
              </ul>

              <h2 class="chapter-header" id="react-firebase-context-api">Provide Firebase in React</h2>

              <p>You created a Firebase class, but you are not using it in your React application yet. In this section,
                we&rsquo;ll connect the Firebase with the React world. The simple approach is to create a Firebase
                instance with the Firebase class, and then import the instance (or class) in every React component where
                it&rsquo;s needed. That&rsquo;s not the best approach though, for two reasons:</p>

              <ul>
                <li>It is more difficult to test your React components.</li>
                <li>It is more error prone, because Firebase should only be initialized once in your application (<a
                    target="_blank" rel="noopener noreferrer"
                    href="https://en.wikipedia.org/wiki/Singleton_pattern">singleton</a>) and by exposing the Firebase
                  class to every React component, you could end up by mistake with multiple Firebase instances.</li>
              </ul>

              <p>An alternative way is to use <a href="../react-context-api/index.html">React&rsquo;s Context API</a> to
                provide a Firebase instance once at the top-level of your component hierarchy. Create a new
                <em>src/components/Firebase/context.js</em> file in your Firebase module and provide the following
                implementation details:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">FirebaseContext</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">React</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">createContext</span><span style="color: #e7e9db">(</span><span style="color: #815ba4">null</span><span style="color: #e7e9db">);</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">FirebaseContext</span><span style="color: #e7e9db">;</span>
</code></pre>
              </div>


              <p>The <code>createContext()</code> function essentially creates two components. The
                <code>FirebaseContext.Provider</code> component is used to provide a Firebase instance once at the
                top-level of your React component tree, which we will do in this section; and the
                <code>FirebaseContext.Consumer</code> component is used to retrieve the Firebase instance if it is
                needed in the React component. For a well-encapsulated Firebase module, we&rsquo;ll define a
                <em>index.js</em> file in our Firebase folder that exports all necessary functionalities (Firebase
                class, Firebase context for Consumer and Provider components):</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">FirebaseContext</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;./context&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #06b6ef">Firebase</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;./firebase&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">Firebase</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">export</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">FirebaseContext</span> <span style="color: #e7e9db">};</span>
</code></pre>
              </div>


              <p>The Firebase Context from the Firebase module (folder) is used to provide a Firebase instance to your
                entire application in the <em>src/index.js</em> file. You only need to create the Firebase instance with
                the Firebase class and pass it as value prop to the React&rsquo;s Context:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #06b6ef">ReactDOM</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react-dom&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">import</span> <span style="color: #48b685">&#39;./index.css&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #5bc4bf">*</span> <span style="color: #06b6ef">as</span> <span style="color: #06b6ef">serviceWorker</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;./serviceWorker&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">import</span> <span style="color: #06b6ef">App</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;./components/App&#39;</span><span style="color: #e7e9db">;</span>
<span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #06b6ef">Firebase</span><span style="color: #e7e9db">,</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">FirebaseContext</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;./components/Firebase&#39;</span><span style="color: #e7e9db">;</span>
</span>
<span style="color: #06b6ef">ReactDOM</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">render</span><span style="color: #e7e9db">(</span>
<span style="background-color: #4f424c">  <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">FirebaseContext</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">Provider</span> <span style="color: #06b6ef">value</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #815ba4">new</span> <span style="color: #06b6ef">Firebase</span><span style="color: #e7e9db">()}</span><span style="color: #5bc4bf">&gt;</span>
</span>    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">App</span> <span style="color: #5bc4bf">/&gt;</span>
<span style="background-color: #4f424c">  <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/FirebaseContext.Provider&gt;,</span>
</span>  <span style="color: #e7e9db">document.</span><span style="color: #06b6ef">getElementById</span><span style="color: #e7e9db">(</span><span style="color: #48b685">&#39;root&#39;</span><span style="color: #e7e9db">),</span>
<span style="color: #e7e9db">);</span>

<span style="color: #06b6ef">serviceWorker</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">unregister</span><span style="color: #e7e9db">();</span>
</code></pre>
              </div>


              <p>Doing it this way, we can be assured that Firebase is only instantiated once and that it is injected
                via React&rsquo;s Context API to React&rsquo;s component tree. Now, every component that is interested
                in using Firebase has access to the Firebase instance with a <code>FirebaseContext.Consumer</code>
                component. Even though you will see it first-hand later for this application, the following code snippet
                shows how it would work:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">import</span>  <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">FirebaseContext</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../Firebase&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">SomeComponent</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">(</span>
  <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">FirebaseContext</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">Consumer</span><span style="color: #5bc4bf">&gt;</span>
    <span style="color: #e7e9db">{</span><span style="color: #06b6ef">firebase</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
      <span style="color: #815ba4">return</span> <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">div</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">I</span><span style="color: #ef6155">&#39;</span><span style="color: #06b6ef">ve</span> <span style="color: #06b6ef">access</span> <span style="color: #06b6ef">to</span> <span style="color: #06b6ef">Firebase</span> <span style="color: #06b6ef">and</span> <span style="color: #06b6ef">render</span> <span style="color: #06b6ef">something</span><span style="color: #e7e9db">.</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/div&gt;;</span>
    <span style="color: #e7e9db">}}</span>
  <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/FirebaseContext.Consumer&gt;</span>
<span style="color: #e7e9db">);</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">SomeComponent</span><span style="color: #e7e9db">;</span>
</code></pre>
              </div>


              <p>Firebase and React are now connected, the fundamental step to make the layers communicate with each
                other. Next, we will implement the interface for the Firebase class on our side to communicate with the
                Firebase API.</p>

              <h3 id="exercises-3">Exercises:</h3>

              <ul>
                <li>Read more about <a href="../react-context-api/index.html">React&rsquo;s Context API</a></li>
                <li>Confirm your <a target="_blank" rel="noopener noreferrer" href="http://bit.ly/2VrUms0">source code
                    for the last section</a></li>
              </ul>

              <h2 class="chapter-header" id="firebase-authentication">Firebase&#39;s Authentication API</h2>

              <p>In the previous section, you created a Firebase project on the official Firebase website. This section
                will implement the interface of your Firebase class that enables communication between the class and the
                Firebase authentication API. In the sections afterward, you will use the interface of the Firebase class
                in your React components.</p>

              <p>First, we need to activate one of the available authentication providers on Firebase&rsquo;s website.
                On your project&rsquo;s Firebase dashboard, you can find a menu item which says
                &ldquo;Authentication&rdquo;. Select it and click &ldquo;Sign-In Method&rdquo; menu item afterward.
                There you can enable the authentication with Email/Password:</p>

              <div class="post-image-primary">
                <div class="pinterest-pinner-wrapper" itemscope itemtype="http://schema.org/ImageObject">
                  <div class="pinterest-pinner">
                    <a data-pin-do="buttonPin" data-pin-save="true" data-pin-tall="true"
                      href="https://www.pinterest.com/pin/create/button/?url=https%3a%2f%2fchrispaul.dev%2fcomplete-firebase-authentication-react-tutorial%2f&amp;media=https://chrispaul.dev/img%2fposts%2fcomplete-firebase-authentication-react-tutorial%2ffirebase-authentication-methods.jpg&amp;description=">
                    </a>
                  </div>

                  <img class="img-lazy img-responsive"
                    data-lazy-src="/src="/img/posts/complete-firebase-authentication-react-tutorial/firebase-authentication-methods.jpg"
                    data-is-src-set="is-src-set" alt="firebase authentication providers" itemprop="image" />
                </div>
              </div>


              <p>Second, we will implement the authentication API for our Firebase class. Import and instantiate the
                package from Firebase responsible for all the authentication in your
                <em>src/components/Firebase/firebase.js</em> file:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">app</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;firebase/app&#39;</span><span style="color: #e7e9db">;</span>
<span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #48b685">&#39;firebase/auth&#39;</span><span style="color: #e7e9db">;</span>
</span>
<span style="color: #815ba4">const</span> <span style="color: #06b6ef">config</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">{</span>
  <span style="color: #06b6ef">apiKey</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">process</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">env</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">REACT_APP_API_KEY</span><span style="color: #e7e9db">,</span>
  <span style="color: #06b6ef">authDomain</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">process</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">env</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">REACT_APP_AUTH_DOMAIN</span><span style="color: #e7e9db">,</span>
  <span style="color: #06b6ef">databaseURL</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">process</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">env</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">REACT_APP_DATABASE_URL</span><span style="color: #e7e9db">,</span>
  <span style="color: #06b6ef">projectId</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">process</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">env</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">REACT_APP_PROJECT_ID</span><span style="color: #e7e9db">,</span>
  <span style="color: #06b6ef">storageBucket</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">process</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">env</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">REACT_APP_STORAGE_BUCKET</span><span style="color: #e7e9db">,</span>
  <span style="color: #06b6ef">messagingSenderId</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">process</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">env</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">REACT_APP_MESSAGING_SENDER_ID</span><span style="color: #e7e9db">,</span>
<span style="color: #e7e9db">};</span>

<span style="color: #815ba4">class</span> <span style="color: #06b6ef">Firebase</span> <span style="color: #e7e9db">{</span>
  <span style="color: #06b6ef">constructor</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
    <span style="color: #06b6ef">app</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">initializeApp</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">config</span><span style="color: #e7e9db">);</span>

<span style="background-color: #4f424c">    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">auth</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">app</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">auth</span><span style="color: #e7e9db">();</span>
</span>  <span style="color: #e7e9db">}</span>
<span style="color: #e7e9db">}</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">Firebase</span><span style="color: #e7e9db">;</span>
</code></pre>
              </div>


              <p>Let&rsquo;s define all the authentication functions as class methods step by step. They will serve our
                communication channel from the Firebase class to the Firebase API. First, the sign up function
                (registration) takes email and password parameters for its function signature and uses an official
                Firebase API endpoint to create a user:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">app</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;firebase/app&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #48b685">&#39;firebase/auth&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">config</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">{</span> <span style="color: #e7e9db">...</span> <span style="color: #e7e9db">};</span>

<span style="color: #815ba4">class</span> <span style="color: #06b6ef">Firebase</span> <span style="color: #e7e9db">{</span>
  <span style="color: #06b6ef">constructor</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
    <span style="color: #06b6ef">app</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">initializeApp</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">config</span><span style="color: #e7e9db">);</span>

    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">auth</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">app</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">auth</span><span style="color: #e7e9db">();</span>
  <span style="color: #e7e9db">}</span>

<span style="background-color: #4f424c">  <span style="color: #776e71">// *** Auth API ***</span>
</span>
<span style="background-color: #4f424c">  <span style="color: #06b6ef">doCreateUserWithEmailAndPassword</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">(</span><span style="color: #06b6ef">email</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">password</span><span style="color: #e7e9db">)</span> <span style="color: #5bc4bf">=&gt;</span>
</span><span style="background-color: #4f424c">    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">auth</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">createUserWithEmailAndPassword</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">email</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">password</span><span style="color: #e7e9db">);</span>
</span><span style="color: #e7e9db">}</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">Firebase</span><span style="color: #e7e9db">;</span>
</code></pre>
              </div>


              <p>We&rsquo;ll also set up the login/sign-in function, which takes email and password parameters, as well:
              </p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">app</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;firebase/app&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #48b685">&#39;firebase/auth&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">config</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">{</span> <span style="color: #e7e9db">...</span> <span style="color: #e7e9db">};</span>

<span style="color: #815ba4">class</span> <span style="color: #06b6ef">Firebase</span> <span style="color: #e7e9db">{</span>
  <span style="color: #06b6ef">constructor</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
    <span style="color: #06b6ef">app</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">initializeApp</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">config</span><span style="color: #e7e9db">);</span>

    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">auth</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">app</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">auth</span><span style="color: #e7e9db">();</span>
  <span style="color: #e7e9db">}</span>

  <span style="color: #776e71">// *** Auth API ***</span>

  <span style="color: #06b6ef">doCreateUserWithEmailAndPassword</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">(</span><span style="color: #06b6ef">email</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">password</span><span style="color: #e7e9db">)</span> <span style="color: #5bc4bf">=&gt;</span>
    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">auth</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">createUserWithEmailAndPassword</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">email</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">password</span><span style="color: #e7e9db">);</span>

<span style="background-color: #4f424c">  <span style="color: #06b6ef">doSignInWithEmailAndPassword</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">(</span><span style="color: #06b6ef">email</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">password</span><span style="color: #e7e9db">)</span> <span style="color: #5bc4bf">=&gt;</span>
</span><span style="background-color: #4f424c">    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">auth</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">signInWithEmailAndPassword</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">email</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">password</span><span style="color: #e7e9db">);</span>
</span><span style="color: #e7e9db">}</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">Firebase</span><span style="color: #e7e9db">;</span>
</code></pre>
              </div>


              <p>These endpoints are called asynchronously, and they will need to be resolved later, as well as error
                handling. For instance, it is not possible to sign in a user who is not signed up yet since the Firebase
                API would return an error. In case of the sign out function, you don&rsquo;t need to pass any argument
                to it, because Firebase knows about the currently authenticated user. If no user is authenticated,
                nothing will happen when this function is called.</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">app</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;firebase/app&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #48b685">&#39;firebase/auth&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">config</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">{</span> <span style="color: #e7e9db">...</span> <span style="color: #e7e9db">};</span>

<span style="color: #815ba4">class</span> <span style="color: #06b6ef">Firebase</span> <span style="color: #e7e9db">{</span>
  <span style="color: #06b6ef">constructor</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
    <span style="color: #06b6ef">app</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">initializeApp</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">config</span><span style="color: #e7e9db">);</span>

    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">auth</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">app</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">auth</span><span style="color: #e7e9db">();</span>
  <span style="color: #e7e9db">}</span>

  <span style="color: #776e71">// *** Auth API ***</span>

  <span style="color: #06b6ef">doCreateUserWithEmailAndPassword</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">(</span><span style="color: #06b6ef">email</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">password</span><span style="color: #e7e9db">)</span> <span style="color: #5bc4bf">=&gt;</span>
    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">auth</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">createUserWithEmailAndPassword</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">email</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">password</span><span style="color: #e7e9db">);</span>

  <span style="color: #06b6ef">doSignInWithEmailAndPassword</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">(</span><span style="color: #06b6ef">email</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">password</span><span style="color: #e7e9db">)</span> <span style="color: #5bc4bf">=&gt;</span>
    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">auth</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">signInWithEmailAndPassword</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">email</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">password</span><span style="color: #e7e9db">);</span>

<span style="background-color: #4f424c">  <span style="color: #06b6ef">doSignOut</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">auth</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">signOut</span><span style="color: #e7e9db">();</span>
</span><span style="color: #e7e9db">}</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">Firebase</span><span style="color: #e7e9db">;</span>
</code></pre>
              </div>


              <p>There are two more authentication methods to reset and change a password for an authenticated user:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">app</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;firebase/app&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #48b685">&#39;firebase/auth&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">config</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">{</span> <span style="color: #e7e9db">...</span> <span style="color: #e7e9db">};</span>

<span style="color: #815ba4">class</span> <span style="color: #06b6ef">Firebase</span> <span style="color: #e7e9db">{</span>
  <span style="color: #06b6ef">constructor</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
    <span style="color: #06b6ef">app</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">initializeApp</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">config</span><span style="color: #e7e9db">);</span>

    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">auth</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">app</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">auth</span><span style="color: #e7e9db">();</span>
  <span style="color: #e7e9db">}</span>

  <span style="color: #776e71">// *** Auth API ***</span>

  <span style="color: #06b6ef">doCreateUserWithEmailAndPassword</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">(</span><span style="color: #06b6ef">email</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">password</span><span style="color: #e7e9db">)</span> <span style="color: #5bc4bf">=&gt;</span>
    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">auth</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">createUserWithEmailAndPassword</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">email</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">password</span><span style="color: #e7e9db">);</span>

  <span style="color: #06b6ef">doSignInWithEmailAndPassword</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">(</span><span style="color: #06b6ef">email</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">password</span><span style="color: #e7e9db">)</span> <span style="color: #5bc4bf">=&gt;</span>
    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">auth</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">signInWithEmailAndPassword</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">email</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">password</span><span style="color: #e7e9db">);</span>

  <span style="color: #06b6ef">doSignOut</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">auth</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">signOut</span><span style="color: #e7e9db">();</span>

<span style="background-color: #4f424c">  <span style="color: #06b6ef">doPasswordReset</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">email</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">auth</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">sendPasswordResetEmail</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">email</span><span style="color: #e7e9db">);</span>
</span>
<span style="background-color: #4f424c">  <span style="color: #06b6ef">doPasswordUpdate</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">password</span> <span style="color: #5bc4bf">=&gt;</span>
</span><span style="background-color: #4f424c">    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">auth</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">currentUser</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">updatePassword</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">password</span><span style="color: #e7e9db">);</span>
</span><span style="color: #e7e9db">}</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">Firebase</span><span style="color: #e7e9db">;</span>
</code></pre>
              </div>


              <p>That&rsquo;s the authentication interface for your React components that will connect to the Firebase
                API. In the next section, we will consume all the methods of your Firebase class in your React
                components.</p>

              <h3 id="exercises-4">Exercises:</h3>

              <ul>
                <li>Read more about <a target="_blank" rel="noopener noreferrer"
                    href="https://firebase.google.com/docs/auth/web/start">Firebase Authentication for Web</a></li>
                <li>Confirm your <a target="_blank" rel="noopener noreferrer" href="http://bit.ly/2VpQ1pk">source code
                    for the last section</a></li>
              </ul>

              <h2 class="chapter-header" id="react-firebase-sign-up">Sign Up with React and Firebase</h2>

              <p>We set up all the routes for your application, configured Firebase and implemented the authentication
                API for your Firebase class. It&rsquo;s also possible to use Firebase within your React components. Now
                it&rsquo;s time to use the authentication functionalities in your React components, which we&rsquo;ll
                build from scratch. I try to put most of the code in one block, because the components are not too
                small, and splitting them up step by step might be too verbose. Nevertheless, I will guide you through
                each code block afterward. The code blocks for forms can become repetitive, so they will be explained
                once well.</p>

              <p>Let&rsquo;s start with the sign up page (registration page). It consists of the page, a form, and a
                link. The form is used to sign up a new user to your application with username, email, and password. The
                link will be used on the sign in page (login page) later if a user has no account yet. It is a redirect
                to the sign up page, but not used on the sign up page itself. Implement the
                <em>src/components/SignUp/index.js</em> file the following way:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span><span style="color: #e7e9db">,</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">Link</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react-router-dom&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">import</span> <span style="color: #5bc4bf">*</span> <span style="color: #06b6ef">as</span> <span style="color: #06b6ef">ROUTES</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../../constants/routes&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">SignUpPage</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">(</span>
  <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">div</span><span style="color: #5bc4bf">&gt;</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">h1</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">SignUp</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/h1&gt;</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">SignUpForm</span> <span style="color: #5bc4bf">/&gt;</span>
  <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/div&gt;</span>
<span style="color: #e7e9db">);</span>

<span style="color: #815ba4">class</span> <span style="color: #06b6ef">SignUpForm</span> <span style="color: #815ba4">extends</span> <span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">{</span>
  <span style="color: #06b6ef">constructor</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">)</span> <span style="color: #e7e9db">{</span>
    <span style="color: #815ba4">super</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">);</span>
  <span style="color: #e7e9db">}</span>

  <span style="color: #06b6ef">onSubmit</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">event</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>

  <span style="color: #e7e9db">}</span>

  <span style="color: #06b6ef">onChange</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">event</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>

  <span style="color: #e7e9db">};</span>

  <span style="color: #06b6ef">render</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
    <span style="color: #815ba4">return</span> <span style="color: #e7e9db">(</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">form</span> <span style="color: #06b6ef">onSubmit</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">onSubmit</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span>

      <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/form&gt;</span>
    <span style="color: #e7e9db">);</span>
  <span style="color: #e7e9db">}</span>
<span style="color: #e7e9db">}</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">SignUpLink</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">(</span>
  <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">p</span><span style="color: #5bc4bf">&gt;</span>
    <span style="color: #06b6ef">Don</span><span style="color: #ef6155">&#39;</span><span style="color: #06b6ef">t</span> <span style="color: #06b6ef">have</span> <span style="color: #06b6ef">an</span> <span style="color: #06b6ef">account</span><span style="color: #5bc4bf">?</span> <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Link</span> <span style="color: #06b6ef">to</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">ROUTES</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">SIGN_UP</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">Sign</span> <span style="color: #06b6ef">Up</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/Link&gt;</span>
  <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/p&gt;</span>
<span style="color: #e7e9db">);</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">SignUpPage</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">export</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">SignUpForm</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">SignUpLink</span> <span style="color: #e7e9db">};</span>
</code></pre>
              </div>


              <p>The SignUpForm component is the only React class component in this file, because it has to manage the
                form state in React&rsquo;s local state. There are two pieces missing in the current SignUpForm
                component: the form content in the render method in terms of input fields to capture the information
                (email address, password, etc.) of a user and the implementation of the <code>onSubmit</code> class
                method when a user signs up eventually.</p>

              <p>First, let&rsquo;s initialize the state of the component. It will capture the user information such as
                username, email, and password. There will be a second password field/state for a password confirmation.
                In addition, there is an error state to capture an error object in case of the sign up request to the
                Firebase API fails. The state is initialized by an object destructuring. This way, we can use the
                initial state object to reset the state after a successful sign up.</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #e7e9db">...</span>

<span style="background-color: #4f424c"><span style="color: #815ba4">const</span> <span style="color: #06b6ef">INITIAL_STATE</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">{</span>
</span><span style="background-color: #4f424c">  <span style="color: #06b6ef">username</span><span style="color: #5bc4bf">:</span> <span style="color: #48b685">&#39;&#39;</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">  <span style="color: #06b6ef">email</span><span style="color: #5bc4bf">:</span> <span style="color: #48b685">&#39;&#39;</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">  <span style="color: #06b6ef">passwordOne</span><span style="color: #5bc4bf">:</span> <span style="color: #48b685">&#39;&#39;</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">  <span style="color: #06b6ef">passwordTwo</span><span style="color: #5bc4bf">:</span> <span style="color: #48b685">&#39;&#39;</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">  <span style="color: #06b6ef">error</span><span style="color: #5bc4bf">:</span> <span style="color: #815ba4">null</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c"><span style="color: #e7e9db">};</span>
</span>
<span style="color: #815ba4">class</span> <span style="color: #06b6ef">SignUpForm</span> <span style="color: #815ba4">extends</span> <span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">{</span>
  <span style="color: #06b6ef">constructor</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">)</span> <span style="color: #e7e9db">{</span>
    <span style="color: #815ba4">super</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">);</span>

<span style="background-color: #4f424c">    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">state</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">{</span> <span style="color: #e7e9db">...</span><span style="color: #06b6ef">INITIAL_STATE</span> <span style="color: #e7e9db">};</span>
</span>  <span style="color: #e7e9db">}</span>

  <span style="color: #e7e9db">...</span>

<span style="color: #e7e9db">}</span>

<span style="color: #e7e9db">...</span>
</code></pre>
              </div>


              <p>Let&rsquo;s implement all the input fields to capture the information in the render method of the
                component. The input fields need to update the local state of the component by using a
                <code>onChange</code> handler.</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #e7e9db">...</span>

<span style="color: #815ba4">class</span> <span style="color: #06b6ef">SignUpForm</span> <span style="color: #815ba4">extends</span> <span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">{</span>

  <span style="color: #e7e9db">...</span>

<span style="background-color: #4f424c">  <span style="color: #06b6ef">onChange</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">event</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
</span><span style="background-color: #4f424c">    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">setState</span><span style="color: #e7e9db">({</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">event</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">target</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">name</span><span style="color: #e7e9db">]</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">event</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">target</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">value</span> <span style="color: #e7e9db">});</span>
</span><span style="background-color: #4f424c">  <span style="color: #e7e9db">};</span>
</span>
  <span style="color: #06b6ef">render</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
<span style="background-color: #4f424c">    <span style="color: #815ba4">const</span> <span style="color: #e7e9db">{</span>
</span><span style="background-color: #4f424c">      <span style="color: #06b6ef">username</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">      <span style="color: #06b6ef">email</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">      <span style="color: #06b6ef">passwordOne</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">      <span style="color: #06b6ef">passwordTwo</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">      <span style="color: #06b6ef">error</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">    <span style="color: #e7e9db">}</span> <span style="color: #5bc4bf">=</span> <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">state</span><span style="color: #e7e9db">;</span>
</span>
    <span style="color: #815ba4">return</span> <span style="color: #e7e9db">(</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">form</span> <span style="color: #06b6ef">onSubmit</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">onSubmit</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span>
<span style="background-color: #4f424c">        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">input</span>
</span><span style="background-color: #4f424c">          <span style="color: #06b6ef">name</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;username&quot;</span>
</span><span style="background-color: #4f424c">          <span style="color: #06b6ef">value</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">username</span><span style="color: #e7e9db">}</span>
</span><span style="background-color: #4f424c">          <span style="color: #06b6ef">onChange</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">onChange</span><span style="color: #e7e9db">}</span>
</span><span style="background-color: #4f424c">          <span style="color: #06b6ef">type</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;text&quot;</span>
</span><span style="background-color: #4f424c">          <span style="color: #06b6ef">placeholder</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;Full Name&quot;</span>
</span><span style="background-color: #4f424c">        <span style="color: #5bc4bf">/&gt;</span>
</span><span style="background-color: #4f424c">        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">input</span>
</span><span style="background-color: #4f424c">          <span style="color: #06b6ef">name</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;email&quot;</span>
</span><span style="background-color: #4f424c">          <span style="color: #06b6ef">value</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">email</span><span style="color: #e7e9db">}</span>
</span><span style="background-color: #4f424c">          <span style="color: #06b6ef">onChange</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">onChange</span><span style="color: #e7e9db">}</span>
</span><span style="background-color: #4f424c">          <span style="color: #06b6ef">type</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;text&quot;</span>
</span><span style="background-color: #4f424c">          <span style="color: #06b6ef">placeholder</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;Email Address&quot;</span>
</span><span style="background-color: #4f424c">        <span style="color: #5bc4bf">/&gt;</span>
</span><span style="background-color: #4f424c">        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">input</span>
</span><span style="background-color: #4f424c">          <span style="color: #06b6ef">name</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;passwordOne&quot;</span>
</span><span style="background-color: #4f424c">          <span style="color: #06b6ef">value</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">passwordOne</span><span style="color: #e7e9db">}</span>
</span><span style="background-color: #4f424c">          <span style="color: #06b6ef">onChange</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">onChange</span><span style="color: #e7e9db">}</span>
</span><span style="background-color: #4f424c">          <span style="color: #06b6ef">type</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;password&quot;</span>
</span><span style="background-color: #4f424c">          <span style="color: #06b6ef">placeholder</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;Password&quot;</span>
</span><span style="background-color: #4f424c">        <span style="color: #5bc4bf">/&gt;</span>
</span><span style="background-color: #4f424c">        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">input</span>
</span><span style="background-color: #4f424c">          <span style="color: #06b6ef">name</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;passwordTwo&quot;</span>
</span><span style="background-color: #4f424c">          <span style="color: #06b6ef">value</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">passwordTwo</span><span style="color: #e7e9db">}</span>
</span><span style="background-color: #4f424c">          <span style="color: #06b6ef">onChange</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">onChange</span><span style="color: #e7e9db">}</span>
</span><span style="background-color: #4f424c">          <span style="color: #06b6ef">type</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;password&quot;</span>
</span><span style="background-color: #4f424c">          <span style="color: #06b6ef">placeholder</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;Confirm Password&quot;</span>
</span><span style="background-color: #4f424c">        <span style="color: #5bc4bf">/&gt;</span>
</span><span style="background-color: #4f424c">        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">button</span> <span style="color: #06b6ef">type</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;submit&quot;</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">Sign</span> <span style="color: #06b6ef">Up</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/button&gt;</span>
</span><span style="background-color: #4f424c">
</span><span style="background-color: #4f424c">        <span style="color: #e7e9db">{</span><span style="color: #06b6ef">error</span> <span style="color: #5bc4bf">&amp;&amp;</span> <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">p</span><span style="color: #5bc4bf">&gt;</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">error</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">message</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/p&gt;}</span>
</span>      <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/form&gt;</span>
    <span style="color: #e7e9db">);</span>
  <span style="color: #e7e9db">}</span>
<span style="color: #e7e9db">}</span>

<span style="color: #e7e9db">...</span>
</code></pre>
              </div>


              <p>Let&rsquo;s take the last implemented code block apart. All the input fields implement the
                unidirectional data flow of React; thus, each input field gets a value from the local state and updates
                the value in the local state with a <code>onChange</code> handler. The input fields are controlled by
                the local state of the component and don&rsquo;t control their own states. <a
                  href="../react-controlled-components/index.html">They are controlled components</a>.</p>

              <p>In the last part of the form, there is an optional error message from an error object. The error
                objects from Firebase have this message property by default, so you can rely on it to display the proper
                text for your application&rsquo;s user. However, the message is only shown when there is an actual error
                using a <a href="../conditional-rendering-react/index.html">conditional rendering</a>.</p>

              <p>One piece in the form is missing: validation. Let&rsquo;s use an <code>isInvalid</code> boolean to
                enable or disable the submit button.</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #e7e9db">...</span>

<span style="color: #815ba4">class</span> <span style="color: #06b6ef">SignUpForm</span> <span style="color: #815ba4">extends</span> <span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">{</span>

  <span style="color: #e7e9db">...</span>

  <span style="color: #06b6ef">render</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
    <span style="color: #815ba4">const</span> <span style="color: #e7e9db">{</span>
      <span style="color: #06b6ef">username</span><span style="color: #e7e9db">,</span>
      <span style="color: #06b6ef">email</span><span style="color: #e7e9db">,</span>
      <span style="color: #06b6ef">passwordOne</span><span style="color: #e7e9db">,</span>
      <span style="color: #06b6ef">passwordTwo</span><span style="color: #e7e9db">,</span>
      <span style="color: #06b6ef">error</span><span style="color: #e7e9db">,</span>
    <span style="color: #e7e9db">}</span> <span style="color: #5bc4bf">=</span> <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">state</span><span style="color: #e7e9db">;</span>

<span style="background-color: #4f424c">    <span style="color: #815ba4">const</span> <span style="color: #06b6ef">isInvalid</span> <span style="color: #5bc4bf">=</span>
</span><span style="background-color: #4f424c">      <span style="color: #06b6ef">passwordOne</span> <span style="color: #5bc4bf">!==</span> <span style="color: #06b6ef">passwordTwo</span> <span style="color: #5bc4bf">||</span>
</span><span style="background-color: #4f424c">      <span style="color: #06b6ef">passwordOne</span> <span style="color: #5bc4bf">===</span> <span style="color: #48b685">&#39;&#39;</span> <span style="color: #5bc4bf">||</span>
</span><span style="background-color: #4f424c">      <span style="color: #06b6ef">email</span> <span style="color: #5bc4bf">===</span> <span style="color: #48b685">&#39;&#39;</span> <span style="color: #5bc4bf">||</span>
</span><span style="background-color: #4f424c">      <span style="color: #06b6ef">username</span> <span style="color: #5bc4bf">===</span> <span style="color: #48b685">&#39;&#39;</span><span style="color: #e7e9db">;</span>
</span>
    <span style="color: #815ba4">return</span> <span style="color: #e7e9db">(</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">form</span> <span style="color: #06b6ef">onSubmit</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">onSubmit</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">input</span>
        <span style="color: #e7e9db">...</span>
<span style="background-color: #4f424c">        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">button</span> <span style="color: #06b6ef">disabled</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">isInvalid</span><span style="color: #e7e9db">}</span> <span style="color: #06b6ef">type</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;submit&quot;</span><span style="color: #5bc4bf">&gt;</span>
</span>          <span style="color: #06b6ef">Sign</span> <span style="color: #06b6ef">Up</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/button&gt;</span>

        <span style="color: #e7e9db">{</span><span style="color: #06b6ef">error</span> <span style="color: #5bc4bf">&amp;&amp;</span> <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">p</span><span style="color: #5bc4bf">&gt;</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">error</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">message</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/p&gt;}</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/form&gt;</span>
    <span style="color: #e7e9db">);</span>
  <span style="color: #e7e9db">}</span>
<span style="color: #e7e9db">}</span>

<span style="color: #e7e9db">...</span>
</code></pre>
              </div>


              <p>The user is only allowed to sign up if both passwords are the same, and if the username, email and at
                least one password are filled with a string. This is password confirmation in a common sign up process.
              </p>

              <p>You should be able to visit the <em>/signup</em> route in your browser after starting your application
                to confirm that the form with all its input fields shows up. You should also be able to type into it
                (confirmation that the local state updates are working) and able to enable the submit button by
                providing all input fields a string (confirmation that the validation works).</p>

              <p>What&rsquo;s missing in the component is the <code>onSubmit()</code> class method, which will pass all
                the form data to the Firebase authentication API via your authentication interface in the Firebase
                class:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #e7e9db">...</span>

<span style="color: #815ba4">class</span> <span style="color: #06b6ef">SignUpForm</span> <span style="color: #815ba4">extends</span> <span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">{</span>

  <span style="color: #e7e9db">...</span>

  <span style="color: #06b6ef">onSubmit</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">event</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
<span style="background-color: #4f424c">    <span style="color: #815ba4">const</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">username</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">email</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">passwordOne</span> <span style="color: #e7e9db">}</span> <span style="color: #5bc4bf">=</span> <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">state</span><span style="color: #e7e9db">;</span>
</span><span style="background-color: #4f424c">
</span><span style="background-color: #4f424c">    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">firebase</span>
</span><span style="background-color: #4f424c">      <span style="color: #e7e9db">.</span><span style="color: #06b6ef">doCreateUserWithEmailAndPassword</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">email</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">passwordOne</span><span style="color: #e7e9db">)</span>
</span><span style="background-color: #4f424c">      <span style="color: #e7e9db">.</span><span style="color: #06b6ef">then</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">authUser</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
</span><span style="background-color: #4f424c">        <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">setState</span><span style="color: #e7e9db">({</span> <span style="color: #e7e9db">...</span><span style="color: #06b6ef">INITIAL_STATE</span> <span style="color: #e7e9db">});</span>
</span><span style="background-color: #4f424c">      <span style="color: #e7e9db">})</span>
</span><span style="background-color: #4f424c">      <span style="color: #e7e9db">.</span><span style="color: #815ba4">catch</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">error</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
</span><span style="background-color: #4f424c">        <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">setState</span><span style="color: #e7e9db">({</span> <span style="color: #06b6ef">error</span> <span style="color: #e7e9db">});</span>
</span><span style="background-color: #4f424c">      <span style="color: #e7e9db">});</span>
</span><span style="background-color: #4f424c">
</span><span style="background-color: #4f424c">    <span style="color: #06b6ef">event</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">preventDefault</span><span style="color: #e7e9db">();</span>
</span>  <span style="color: #e7e9db">};</span>

  <span style="color: #e7e9db">...</span>
<span style="color: #e7e9db">}</span>

<span style="color: #e7e9db">...</span>
</code></pre>
              </div>


              <p>The code is not working yet, but let&rsquo;s break down what we have so far. All the necessary
                information passed to the authentication API can be destructured from the local state. You will only
                need one password property, because both password strings should be the same after the validation.</p>

              <p>Next, call the sign up function defined in the previous section in the Firebase class, which takes the
                email and the password property. The username is not used yet for the sign up process, but will be used
                later.</p>

              <p>If the request resolves successfully, you can set the local state of the component to its initial state
                to empty the input fields. If the request is rejected, you will run into the catch block and set the
                error object in the local state. An error message should show up in the form due to the conditional
                rendering in your component&rsquo;s render method.</p>

              <p>Also, the <code>preventDefault()</code> method on the event prevents a reload of the browser which
                otherwise would be a natural behavior when using a submit in a form. Note that the signed up user object
                from the Firebase API is available in the callback function of the then block in our request. You will
                use it later with the username.</p>

              <p>You may have also noticed that one essential piece is missing: We didn&rsquo;t make the Firebase
                instance available in the SignUpForm <a
                  href="../react-pass-props-to-component/index.html">component&rsquo;s props</a> yet. Let&rsquo;s change
                this by utilizing our Firebase Context in the SignUpPage component, and by passing the Firebase instance
                to the SignUpForm.</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span><span style="color: #e7e9db">,</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">Link</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react-router-dom&#39;</span><span style="color: #e7e9db">;</span>

<span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">FirebaseContext</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../Firebase&#39;</span><span style="color: #e7e9db">;</span>
</span><span style="color: #815ba4">import</span> <span style="color: #5bc4bf">*</span> <span style="color: #06b6ef">as</span> <span style="color: #06b6ef">ROUTES</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../../constants/routes&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">SignUpPage</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">(</span>
  <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">div</span><span style="color: #5bc4bf">&gt;</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">h1</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">SignUp</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/h1&gt;</span>
<span style="background-color: #4f424c">    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">FirebaseContext</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">Consumer</span><span style="color: #5bc4bf">&gt;</span>
</span><span style="background-color: #4f424c">      <span style="color: #e7e9db">{</span><span style="color: #06b6ef">firebase</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">SignUpForm</span> <span style="color: #06b6ef">firebase</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">firebase</span><span style="color: #e7e9db">}</span> <span style="color: #5bc4bf">/&gt;</span><span style="color: #e7e9db">}</span>
</span><span style="background-color: #4f424c">    <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/FirebaseContext.Consumer&gt;</span>
</span>  <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/div&gt;</span>
<span style="color: #e7e9db">);</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">INITIAL_STATE</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">{</span> <span style="color: #e7e9db">...</span> <span style="color: #e7e9db">};</span>

<span style="color: #815ba4">class</span> <span style="color: #06b6ef">SignUpForm</span> <span style="color: #815ba4">extends</span> <span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">{</span>
  <span style="color: #e7e9db">...</span>
<span style="color: #e7e9db">}</span>

<span style="color: #e7e9db">...</span>
</code></pre>
              </div>


              <p>Now the registration of a new user should work. However, I&rsquo;d like to make one improvement on how
                we access the Firebase instance here. Rather than using a <a
                  href="../react-render-props-pattern/index.html">render prop component</a>, which is automatically
                given with React&rsquo;s Context Consumer component, it may be simpler to use a <a
                  href="../gentle-introduction-higher-order-components/index.html">higher-order component</a>.
                Let&rsquo;s implement this higher-order component in the <em>src/components/Firebase/context.js</em>:
              </p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">FirebaseContext</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">React</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">createContext</span><span style="color: #e7e9db">(</span><span style="color: #815ba4">null</span><span style="color: #e7e9db">);</span>

<span style="background-color: #4f424c"><span style="color: #815ba4">export</span> <span style="color: #815ba4">const</span> <span style="color: #06b6ef">withFirebase</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">Component</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #06b6ef">props</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">(</span>
</span><span style="background-color: #4f424c">  <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">FirebaseContext</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">Consumer</span><span style="color: #5bc4bf">&gt;</span>
</span><span style="background-color: #4f424c">    <span style="color: #e7e9db">{</span><span style="color: #06b6ef">firebase</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">{...</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">}</span> <span style="color: #06b6ef">firebase</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">firebase</span><span style="color: #e7e9db">}</span> <span style="color: #5bc4bf">/&gt;</span><span style="color: #e7e9db">}</span>
</span><span style="background-color: #4f424c">  <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/FirebaseContext.Consumer&gt;</span>
</span><span style="background-color: #4f424c"><span style="color: #e7e9db">);</span>
</span>
<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">FirebaseContext</span><span style="color: #e7e9db">;</span>
</code></pre>
              </div>


              <p>Next, make it available via our Firebase module in the <em>src/components/Firebase/index.js</em> file:
              </p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #06b6ef">FirebaseContext</span><span style="color: #e7e9db">,</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">withFirebase</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;./context&#39;</span><span style="color: #e7e9db">;</span>
</span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">Firebase</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;./firebase&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">Firebase</span><span style="color: #e7e9db">;</span>

<span style="background-color: #4f424c"><span style="color: #815ba4">export</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">FirebaseContext</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">withFirebase</span> <span style="color: #e7e9db">};</span>
</span></code></pre>
              </div>


              <p>Now, instead of using the Firebase Context directly in the SignUpPage, which doesn&rsquo;t need to know
                about the Firebase instance, use the higher-order component to wrap your SignUpForm. Afterward, the
                SignUpForm has access to the Firebase instance via the higher-order component. It&rsquo;s also possible
                to use the SignUpForm as standalone without the SignUpPage, because it is responsible to get the
                Firebase instance via the higher-order component.</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span><span style="color: #e7e9db">,</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">Link</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react-router-dom&#39;</span><span style="color: #e7e9db">;</span>

<span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">withFirebase</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../Firebase&#39;</span><span style="color: #e7e9db">;</span>
</span><span style="color: #815ba4">import</span> <span style="color: #5bc4bf">*</span> <span style="color: #06b6ef">as</span> <span style="color: #06b6ef">ROUTES</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../../constants/routes&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">SignUpPage</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">(</span>
  <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">div</span><span style="color: #5bc4bf">&gt;</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">h1</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">SignUp</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/h1&gt;</span>
<span style="background-color: #4f424c">    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">SignUpForm</span> <span style="color: #5bc4bf">/&gt;</span>
</span>  <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/div&gt;</span>
<span style="color: #e7e9db">);</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">INITIAL_STATE</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">{</span> <span style="color: #e7e9db">...</span> <span style="color: #e7e9db">};</span>

<span style="background-color: #4f424c"><span style="color: #815ba4">class</span> <span style="color: #06b6ef">SignUpFormBase</span> <span style="color: #815ba4">extends</span> <span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">{</span>
</span>  <span style="color: #e7e9db">...</span>
<span style="color: #e7e9db">}</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">SignUpLink</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">...</span>

<span style="background-color: #4f424c"><span style="color: #815ba4">const</span> <span style="color: #06b6ef">SignUpForm</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">withFirebase</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">SignUpFormBase</span><span style="color: #e7e9db">);</span>
</span>
<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">SignUpPage</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">export</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">SignUpForm</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">SignUpLink</span> <span style="color: #e7e9db">};</span>
</code></pre>
              </div>


              <p>When a user signs up to your application, you want to redirect the user to another page. It could be
                the user&rsquo;s home page, a protected route for only authenticated users. You will need the help of
                React Router to redirect the user after a successful sign up.</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span><span style="color: #e7e9db">,</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>
<span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">Link</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">withRouter</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react-router-dom&#39;</span><span style="color: #e7e9db">;</span>
</span>
<span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">withFirebase</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../Firebase&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #5bc4bf">*</span> <span style="color: #06b6ef">as</span> <span style="color: #06b6ef">ROUTES</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../../constants/routes&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #e7e9db">...</span>

<span style="color: #815ba4">class</span> <span style="color: #06b6ef">SignUpFormBase</span> <span style="color: #815ba4">extends</span> <span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">{</span>

  <span style="color: #e7e9db">...</span>

  <span style="color: #06b6ef">onSubmit</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">(</span><span style="color: #06b6ef">event</span><span style="color: #e7e9db">)</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
    <span style="color: #815ba4">const</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">username</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">email</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">passwordOne</span> <span style="color: #e7e9db">}</span> <span style="color: #5bc4bf">=</span> <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">state</span><span style="color: #e7e9db">;</span>

    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">firebase</span>
      <span style="color: #e7e9db">.</span><span style="color: #06b6ef">doCreateUserWithEmailAndPassword</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">email</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">passwordOne</span><span style="color: #e7e9db">)</span>
      <span style="color: #e7e9db">.</span><span style="color: #06b6ef">then</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">authUser</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
        <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">setState</span><span style="color: #e7e9db">({</span> <span style="color: #e7e9db">...</span><span style="color: #06b6ef">INITIAL_STATE</span> <span style="color: #e7e9db">});</span>
<span style="background-color: #4f424c">        <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">history</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">push</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">ROUTES</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">HOME</span><span style="color: #e7e9db">);</span>
</span>      <span style="color: #e7e9db">})</span>
      <span style="color: #e7e9db">.</span><span style="color: #815ba4">catch</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">error</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
        <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">setState</span><span style="color: #e7e9db">({</span> <span style="color: #06b6ef">error</span> <span style="color: #e7e9db">});</span>
      <span style="color: #e7e9db">});</span>

    <span style="color: #06b6ef">event</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">preventDefault</span><span style="color: #e7e9db">();</span>
  <span style="color: #e7e9db">}</span>

  <span style="color: #e7e9db">...</span>
<span style="color: #e7e9db">}</span>

<span style="color: #e7e9db">...</span>

<span style="background-color: #4f424c"><span style="color: #815ba4">const</span> <span style="color: #06b6ef">SignUpForm</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">withRouter</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">withFirebase</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">SignUpFormBase</span><span style="color: #e7e9db">));</span>
</span>
<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">SignUpPage</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">export</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">SignUpForm</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">SignUpLink</span> <span style="color: #e7e9db">};</span>
</code></pre>
              </div>


              <p>Let&rsquo;s take the previous code block apart again. To redirect a user to another page
                programmatically, we need access to React Router to redirect the user to another page. Fortunately, the
                React Router node package offers a higher-order component to make the router properties accessible in
                the props of a component. Any component that goes in the <code>withRouter()</code> higher-order
                component gains access to all the properties of the router, so when passing the enhanced SignUpFormBase
                component to the <code>withRouter()</code> higher-order component, it has access to the props of the
                router. The relevant property from the router props is the <code>history</code> object, because it
                allows us to redirect a user to another page by pushing a route to it.</p>

              <p>The history object of the router can be used in the <code>onSubmit()</code> class method eventually. If
                a request resolves successfully, you can push any route to the history object. Since the pushed
                <em>/home</em> route is defined in our App component with a matching component to be rendered, the
                displayed page component will change after the redirect.</p>

              <p>There is one improvement that we can make for the higher-order components used for the SignUpForm.
                Nesting functions (higher-order components) into each other like we did before can become verbose. A
                better way is to compose the higher-order components instead. To do this, install <a target="_blank"
                  rel="noopener noreferrer" href="https://github.com/acdlite/recompose">recompose</a> for your
                application on the command line:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #06b6ef">npm</span> <span style="color: #06b6ef">install</span> <span style="color: #06b6ef">recompose</span>
</code></pre>
              </div>


              <p>You can use recompose to organize your higher-order components. Since the higher-order components
                don&rsquo;t depend on each other, the order doesn&rsquo;t matter. Otherwise, it may be good to know that
                the compose function applies the higher-order components from right to left.</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span><span style="color: #e7e9db">,</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">Link</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">withRouter</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react-router-dom&#39;</span><span style="color: #e7e9db">;</span>
<span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">compose</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;recompose&#39;</span><span style="color: #e7e9db">;</span>
</span>
<span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">withFirebase</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../Firebase&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #5bc4bf">*</span> <span style="color: #06b6ef">as</span> <span style="color: #06b6ef">ROUTES</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../../constants/routes&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #e7e9db">...</span>

<span style="background-color: #4f424c"><span style="color: #815ba4">const</span> <span style="color: #06b6ef">SignUpForm</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">compose</span><span style="color: #e7e9db">(</span>
</span><span style="background-color: #4f424c">  <span style="color: #06b6ef">withRouter</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">  <span style="color: #06b6ef">withFirebase</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c"><span style="color: #e7e9db">)(</span><span style="color: #06b6ef">SignUpFormBase</span><span style="color: #e7e9db">);</span>
</span>
<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">SignUpPage</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">export</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">SignUpForm</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">SignUpLink</span> <span style="color: #e7e9db">};</span>
</code></pre>
              </div>


              <p>Run your application again. If you signed up a user successfully, it should redirect to the home page.
                If the sign up fails, you should see an error message. Try to sign up a user with the same email address
                twice and verify that a similar error message shows up: &ldquo;The email address is already in use by
                another account.&rdquo;. Congratulations, you signed up your first user via Firebase authentication.</p>

              <h3 id="exercises-5">Exercises:</h3>

              <ul>
                <li>Read more about <a href="../react-fetching-data/index.html">data fetching in React</a></li>
                <li>Read more about <a href="../gentle-introduction-higher-order-components/index.html">higher-order
                    components in React</a></li>
                <li>Read more about <a href="../react-render-props-pattern/index.html">render prop components in
                    React</a></li>
                <li>Confirm your <a target="_blank" rel="noopener noreferrer" href="http://bit.ly/2VkrTEA">source code
                    for the last section</a></li>
              </ul>

              <h2 class="chapter-header" id="react-firebase-sign-in">Sign In with React and Firebase</h2>

              <p>A sign up automatically results in a sign in/login by the user. We cannot rely on this mechanic,
                however, since a user could be signed up but not signed in. Let&rsquo;s implement the login with
                Firebase now. It is similar to the sign up mechanism and components, so this time we won&rsquo;t split
                it into so many code blocks. Implement the <em>src/components/SignIn/index.js</em> file:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span><span style="color: #e7e9db">,</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">withRouter</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react-router-dom&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">compose</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;recompose&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">SignUpLink</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../SignUp&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">withFirebase</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../Firebase&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #5bc4bf">*</span> <span style="color: #06b6ef">as</span> <span style="color: #06b6ef">ROUTES</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../../constants/routes&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">SignInPage</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">(</span>
  <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">div</span><span style="color: #5bc4bf">&gt;</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">h1</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">SignIn</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/h1&gt;</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">SignInForm</span> <span style="color: #5bc4bf">/&gt;</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">SignUpLink</span> <span style="color: #5bc4bf">/&gt;</span>
  <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/div&gt;</span>
<span style="color: #e7e9db">);</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">INITIAL_STATE</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">{</span>
  <span style="color: #06b6ef">email</span><span style="color: #5bc4bf">:</span> <span style="color: #48b685">&#39;&#39;</span><span style="color: #e7e9db">,</span>
  <span style="color: #06b6ef">password</span><span style="color: #5bc4bf">:</span> <span style="color: #48b685">&#39;&#39;</span><span style="color: #e7e9db">,</span>
  <span style="color: #06b6ef">error</span><span style="color: #5bc4bf">:</span> <span style="color: #815ba4">null</span><span style="color: #e7e9db">,</span>
<span style="color: #e7e9db">};</span>

<span style="color: #815ba4">class</span> <span style="color: #06b6ef">SignInFormBase</span> <span style="color: #815ba4">extends</span> <span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">{</span>
  <span style="color: #06b6ef">constructor</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">)</span> <span style="color: #e7e9db">{</span>
    <span style="color: #815ba4">super</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">);</span>

    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">state</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">{</span> <span style="color: #e7e9db">...</span><span style="color: #06b6ef">INITIAL_STATE</span> <span style="color: #e7e9db">};</span>
  <span style="color: #e7e9db">}</span>

  <span style="color: #06b6ef">onSubmit</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">event</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
    <span style="color: #815ba4">const</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">email</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">password</span> <span style="color: #e7e9db">}</span> <span style="color: #5bc4bf">=</span> <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">state</span><span style="color: #e7e9db">;</span>

    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">firebase</span>
      <span style="color: #e7e9db">.</span><span style="color: #06b6ef">doSignInWithEmailAndPassword</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">email</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">password</span><span style="color: #e7e9db">)</span>
      <span style="color: #e7e9db">.</span><span style="color: #06b6ef">then</span><span style="color: #e7e9db">(()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
        <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">setState</span><span style="color: #e7e9db">({</span> <span style="color: #e7e9db">...</span><span style="color: #06b6ef">INITIAL_STATE</span> <span style="color: #e7e9db">});</span>
        <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">history</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">push</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">ROUTES</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">HOME</span><span style="color: #e7e9db">);</span>
      <span style="color: #e7e9db">})</span>
      <span style="color: #e7e9db">.</span><span style="color: #815ba4">catch</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">error</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
        <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">setState</span><span style="color: #e7e9db">({</span> <span style="color: #06b6ef">error</span> <span style="color: #e7e9db">});</span>
      <span style="color: #e7e9db">});</span>

    <span style="color: #06b6ef">event</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">preventDefault</span><span style="color: #e7e9db">();</span>
  <span style="color: #e7e9db">};</span>

  <span style="color: #06b6ef">onChange</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">event</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">setState</span><span style="color: #e7e9db">({</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">event</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">target</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">name</span><span style="color: #e7e9db">]</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">event</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">target</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">value</span> <span style="color: #e7e9db">});</span>
  <span style="color: #e7e9db">};</span>

  <span style="color: #06b6ef">render</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
    <span style="color: #815ba4">const</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">email</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">password</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">error</span> <span style="color: #e7e9db">}</span> <span style="color: #5bc4bf">=</span> <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">state</span><span style="color: #e7e9db">;</span>

    <span style="color: #815ba4">const</span> <span style="color: #06b6ef">isInvalid</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">password</span> <span style="color: #5bc4bf">===</span> <span style="color: #48b685">&#39;&#39;</span> <span style="color: #5bc4bf">||</span> <span style="color: #06b6ef">email</span> <span style="color: #5bc4bf">===</span> <span style="color: #48b685">&#39;&#39;</span><span style="color: #e7e9db">;</span>

    <span style="color: #815ba4">return</span> <span style="color: #e7e9db">(</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">form</span> <span style="color: #06b6ef">onSubmit</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">onSubmit</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">input</span>
          <span style="color: #06b6ef">name</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;email&quot;</span>
          <span style="color: #06b6ef">value</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">email</span><span style="color: #e7e9db">}</span>
          <span style="color: #06b6ef">onChange</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">onChange</span><span style="color: #e7e9db">}</span>
          <span style="color: #06b6ef">type</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;text&quot;</span>
          <span style="color: #06b6ef">placeholder</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;Email Address&quot;</span>
        <span style="color: #5bc4bf">/&gt;</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">input</span>
          <span style="color: #06b6ef">name</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;password&quot;</span>
          <span style="color: #06b6ef">value</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">password</span><span style="color: #e7e9db">}</span>
          <span style="color: #06b6ef">onChange</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">onChange</span><span style="color: #e7e9db">}</span>
          <span style="color: #06b6ef">type</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;password&quot;</span>
          <span style="color: #06b6ef">placeholder</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;Password&quot;</span>
        <span style="color: #5bc4bf">/&gt;</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">button</span> <span style="color: #06b6ef">disabled</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">isInvalid</span><span style="color: #e7e9db">}</span> <span style="color: #06b6ef">type</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;submit&quot;</span><span style="color: #5bc4bf">&gt;</span>
          <span style="color: #06b6ef">Sign</span> <span style="color: #06b6ef">In</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/button&gt;</span>

        <span style="color: #e7e9db">{</span><span style="color: #06b6ef">error</span> <span style="color: #5bc4bf">&amp;&amp;</span> <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">p</span><span style="color: #5bc4bf">&gt;</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">error</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">message</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/p&gt;}</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/form&gt;</span>
    <span style="color: #e7e9db">);</span>
  <span style="color: #e7e9db">}</span>
<span style="color: #e7e9db">}</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">SignInForm</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">compose</span><span style="color: #e7e9db">(</span>
  <span style="color: #06b6ef">withRouter</span><span style="color: #e7e9db">,</span>
  <span style="color: #06b6ef">withFirebase</span><span style="color: #e7e9db">,</span>
<span style="color: #e7e9db">)(</span><span style="color: #06b6ef">SignInFormBase</span><span style="color: #e7e9db">);</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">SignInPage</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">export</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">SignInForm</span> <span style="color: #e7e9db">};</span>
</code></pre>
              </div>


              <p>It is almost the same as the sign up form. Its input fields capture all the necessary information like
                username and password. A validation step makes sure the email and password are set before performing the
                request by enabling or disabling the submit button. The authentication API is used again, this time with
                a function to sign in the user rather than sign them up. If sign in succeeds, the local state is updated
                with the initial state and the user is redirected again. If the sign in fails, an error object is stored
                in the local state and an error message appears. The SignUpLink, which was defined earlier in the SignUp
                module, is used on the sign in page. It lets users sign up if they don&rsquo;t have an account, and it
                is found on the sign in page.</p>

              <h3 id="exercises-6">Exercises:</h3>

              <ul>
                <li>Familiarize yourself with the SignIn and SignInForm components.

                  <ul>
                    <li>If they are mysterious to you, checkout the previous section with the implementation of the
                      SignUpForm again</li>
                  </ul>
                </li>
                <li>Confirm your <a target="_blank" rel="noopener noreferrer" href="http://bit.ly/2VnEzup">source code
                    for the last section</a></li>
              </ul>

              <h2 class="chapter-header" id="react-firebase-sign-out">Sign Out with React and Firebase</h2>

              <p>To complete the authentication loop, next we&rsquo;ll implement the sign out component. The component
                is just a button that appears within the Navigation component. Since we can use the previously-defined
                authentication API to sign out a user, passing functionality to a button in a React component is fairly
                straightforward. Implement the SignOutButton component in the <em>src/components/SignOut/index.js</em>
                file:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">withFirebase</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../Firebase&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">SignOutButton</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">({</span> <span style="color: #06b6ef">firebase</span> <span style="color: #e7e9db">})</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">(</span>
  <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">button</span> <span style="color: #06b6ef">type</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;button&quot;</span> <span style="color: #06b6ef">onClick</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">firebase</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">doSignOut</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span>
    <span style="color: #06b6ef">Sign</span> <span style="color: #06b6ef">Out</span>
  <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/button&gt;</span>
<span style="color: #e7e9db">);</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">withFirebase</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">SignOutButton</span><span style="color: #e7e9db">);</span>
</code></pre>
              </div>


              <p>The SignOutButton has access to the Firebase instance using the higher-order component again. Now, use
                the SignOutButton in the Navigation component in your <em>src/components/Navigation/index.js</em> file:
              </p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">Link</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react-router-dom&#39;</span><span style="color: #e7e9db">;</span>

<span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #06b6ef">SignOutButton</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../SignOut&#39;</span><span style="color: #e7e9db">;</span>
</span><span style="color: #815ba4">import</span> <span style="color: #5bc4bf">*</span> <span style="color: #06b6ef">as</span> <span style="color: #06b6ef">ROUTES</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../../constants/routes&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">Navigation</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">(</span>
  <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">div</span><span style="color: #5bc4bf">&gt;</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">ul</span><span style="color: #5bc4bf">&gt;</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">li</span><span style="color: #5bc4bf">&gt;</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Link</span> <span style="color: #06b6ef">to</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">ROUTES</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">SIGN_IN</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">Sign</span> <span style="color: #06b6ef">In</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/Link&gt;</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/li&gt;</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">li</span><span style="color: #5bc4bf">&gt;</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Link</span> <span style="color: #06b6ef">to</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">ROUTES</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">LANDING</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">Landing</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/Link&gt;</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/li&gt;</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">li</span><span style="color: #5bc4bf">&gt;</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Link</span> <span style="color: #06b6ef">to</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">ROUTES</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">HOME</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">Home</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/Link&gt;</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/li&gt;</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">li</span><span style="color: #5bc4bf">&gt;</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Link</span> <span style="color: #06b6ef">to</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">ROUTES</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">ACCOUNT</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">Account</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/Link&gt;</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/li&gt;</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">li</span><span style="color: #5bc4bf">&gt;</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Link</span> <span style="color: #06b6ef">to</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">ROUTES</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">ADMIN</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">Admin</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/Link&gt;</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/li&gt;</span>
<span style="background-color: #4f424c">      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">li</span><span style="color: #5bc4bf">&gt;</span>
</span><span style="background-color: #4f424c">        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">SignOutButton</span> <span style="color: #5bc4bf">/&gt;</span>
</span><span style="background-color: #4f424c">      <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/li&gt;</span>
</span>    <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/ul&gt;</span>
  <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/div&gt;</span>
<span style="color: #e7e9db">);</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">Navigation</span><span style="color: #e7e9db">;</span>
</code></pre>
              </div>


              <p>Regarding components, everything is set to fulfil a full authentication roundtrip. Users can sign up
                (register), sign in (login), and sign out (logout).</p>

              <h3 id="exercises-7">Exercises:</h3>

              <ul>
                <li>Read more about <a target="_blank" rel="noopener noreferrer"
                    href="https://firebase.google.com/docs/auth/web/password-auth">Firebase Authentication with
                    E-Mail/Password</a></li>
                <li>Confirm your <a target="_blank" rel="noopener noreferrer" href="http://bit.ly/2VpQ9oO">source code
                    for the last section</a></li>
              </ul>

              <h2 class="chapter-header" id="react-firebase-session-handling">Session Handling with Firebase/React</h2>

              <p>This section is the most important one for the authentication process. You have all the components
                needed to fulfil an authentication roundtrip in React, and all that&rsquo;s missing is an overseer for
                the session state. Logic regarding the current authenticated user needs to be stored and made accessible
                to other components. This is often the point where developers start to use a state management library
                like <a href="../redux-mobx-confusion/index.html">Redux or MobX</a>. Without these, we&rsquo;ll make due
                using <a href="../react-global-state-without-redux/index.html">global state</a> instead of state
                management libraries.</p>

              <p>Since our application is made under the umbrella of App component, it&rsquo;s sufficient to manage the
                session state in the App component using React&rsquo;s local state. The App component only needs to keep
                track of an authenticated user (session). If a user is authenticated, store it in the local state and
                pass the authenticated user object down to all components that are interested in it. Otherwise, pass the
                authenticated user down as <code>null</code>. That way, all components interested in it can adjust their
                behavior (e.g. use conditional rendering) based on the session state. For instance, the Navigation
                component is interested because it has to show different options to authenticated and non authenticated
                users. The SignOut component shouldn&rsquo;t show up for a non authenticated user, for example.</p>

              <p>We handle session handling in the App component in the <em>src/components/App/index.js</em> file.
                Because the component handles local state now, you have to refactor it to a class component. It manages
                the local state of a <code>authUser</code> object, and then passes it to the Navigation component.</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span><span style="color: #e7e9db">,</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>
</span><span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">BrowserRouter</span> <span style="color: #06b6ef">as</span> <span style="color: #06b6ef">Router</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">Route</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react-router-dom&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #e7e9db">...</span>

<span style="background-color: #4f424c"><span style="color: #815ba4">class</span> <span style="color: #06b6ef">App</span> <span style="color: #815ba4">extends</span> <span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">{</span>
</span><span style="background-color: #4f424c">  <span style="color: #06b6ef">constructor</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">)</span> <span style="color: #e7e9db">{</span>
</span><span style="background-color: #4f424c">    <span style="color: #815ba4">super</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">);</span>
</span><span style="background-color: #4f424c">
</span><span style="background-color: #4f424c">    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">state</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">{</span>
</span><span style="background-color: #4f424c">      <span style="color: #06b6ef">authUser</span><span style="color: #5bc4bf">:</span> <span style="color: #815ba4">null</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">    <span style="color: #e7e9db">};</span>
</span><span style="background-color: #4f424c">  <span style="color: #e7e9db">}</span>
</span>
<span style="background-color: #4f424c">  <span style="color: #06b6ef">render</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
</span><span style="background-color: #4f424c">    <span style="color: #815ba4">return</span> <span style="color: #e7e9db">(</span>
</span>      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Router</span><span style="color: #5bc4bf">&gt;</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">div</span><span style="color: #5bc4bf">&gt;</span>
<span style="background-color: #4f424c">          <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Navigation</span> <span style="color: #06b6ef">authUser</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">state</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">authUser</span><span style="color: #e7e9db">}</span> <span style="color: #5bc4bf">/&gt;</span>
</span>
          <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">hr</span><span style="color: #5bc4bf">/&gt;</span>

          <span style="color: #e7e9db">...</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/div&gt;</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/Router&gt;</span>
<span style="background-color: #4f424c">    <span style="color: #e7e9db">);</span>
</span><span style="background-color: #4f424c">  <span style="color: #e7e9db">}</span>
</span><span style="background-color: #4f424c"><span style="color: #e7e9db">}</span>
</span>
<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">App</span><span style="color: #e7e9db">;</span>
</code></pre>
              </div>


              <p>The Navigation component can be made aware of authenticated user to display different options. It
                should either show the available links for an authenticated user or a non authenticated user.</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">Link</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react-router-dom&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">import</span> <span style="color: #06b6ef">SignOutButton</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../SignOut&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #5bc4bf">*</span> <span style="color: #06b6ef">as</span> <span style="color: #06b6ef">ROUTES</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../../constants/routes&#39;</span><span style="color: #e7e9db">;</span>

<span style="background-color: #4f424c"><span style="color: #815ba4">const</span> <span style="color: #06b6ef">Navigation</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">({</span> <span style="color: #06b6ef">authUser</span> <span style="color: #e7e9db">})</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">(</span>
</span><span style="background-color: #4f424c">  <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">div</span><span style="color: #5bc4bf">&gt;</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">authUser</span> <span style="color: #5bc4bf">?</span> <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">NavigationAuth</span> <span style="color: #5bc4bf">/&gt;</span> <span style="color: #5bc4bf">:</span> <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">NavigationNonAuth</span> <span style="color: #5bc4bf">/&gt;</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/div&gt;</span>
</span><span style="background-color: #4f424c"><span style="color: #e7e9db">);</span>
</span>
<span style="background-color: #4f424c"><span style="color: #815ba4">const</span> <span style="color: #06b6ef">NavigationAuth</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">(</span>
</span><span style="background-color: #4f424c">  <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">ul</span><span style="color: #5bc4bf">&gt;</span>
</span><span style="background-color: #4f424c">    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">li</span><span style="color: #5bc4bf">&gt;</span>
</span><span style="background-color: #4f424c">      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Link</span> <span style="color: #06b6ef">to</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">ROUTES</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">LANDING</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">Landing</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/Link&gt;</span>
</span><span style="background-color: #4f424c">    <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/li&gt;</span>
</span><span style="background-color: #4f424c">    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">li</span><span style="color: #5bc4bf">&gt;</span>
</span><span style="background-color: #4f424c">      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Link</span> <span style="color: #06b6ef">to</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">ROUTES</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">HOME</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">Home</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/Link&gt;</span>
</span><span style="background-color: #4f424c">    <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/li&gt;</span>
</span><span style="background-color: #4f424c">    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">li</span><span style="color: #5bc4bf">&gt;</span>
</span><span style="background-color: #4f424c">      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Link</span> <span style="color: #06b6ef">to</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">ROUTES</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">ACCOUNT</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">Account</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/Link&gt;</span>
</span><span style="background-color: #4f424c">    <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/li&gt;</span>
</span><span style="background-color: #4f424c">    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">li</span><span style="color: #5bc4bf">&gt;</span>
</span><span style="background-color: #4f424c">      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">SignOutButton</span> <span style="color: #5bc4bf">/&gt;</span>
</span><span style="background-color: #4f424c">    <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/li&gt;</span>
</span><span style="background-color: #4f424c">  <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/ul&gt;</span>
</span><span style="background-color: #4f424c"><span style="color: #e7e9db">);</span>
</span>
<span style="background-color: #4f424c"><span style="color: #815ba4">const</span> <span style="color: #06b6ef">NavigationNonAuth</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">(</span>
</span><span style="background-color: #4f424c">  <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">ul</span><span style="color: #5bc4bf">&gt;</span>
</span><span style="background-color: #4f424c">    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">li</span><span style="color: #5bc4bf">&gt;</span>
</span><span style="background-color: #4f424c">      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Link</span> <span style="color: #06b6ef">to</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">ROUTES</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">LANDING</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">Landing</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/Link&gt;</span>
</span><span style="background-color: #4f424c">    <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/li&gt;</span>
</span><span style="background-color: #4f424c">    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">li</span><span style="color: #5bc4bf">&gt;</span>
</span><span style="background-color: #4f424c">      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Link</span> <span style="color: #06b6ef">to</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">ROUTES</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">SIGN_IN</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">Sign</span> <span style="color: #06b6ef">In</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/Link&gt;</span>
</span><span style="background-color: #4f424c">    <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/li&gt;</span>
</span><span style="background-color: #4f424c">  <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/ul&gt;</span>
</span><span style="background-color: #4f424c"><span style="color: #e7e9db">);</span>
</span>
<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">Navigation</span><span style="color: #e7e9db">;</span>
</code></pre>
              </div>


              <p>Let&rsquo;s see where the <code>authUser</code> (authenticated user) comes from in the App component.
                Firebase offers a listener function to get the authenticated user from Firebase:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #e7e9db">...</span>

<span style="color: #815ba4">import</span> <span style="color: #5bc4bf">*</span> <span style="color: #06b6ef">as</span> <span style="color: #06b6ef">ROUTES</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../constants/routes&#39;</span><span style="color: #e7e9db">;</span>
<span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">withFirebase</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../Firebase&#39;</span><span style="color: #e7e9db">;</span>
</span>
<span style="color: #815ba4">class</span> <span style="color: #06b6ef">App</span> <span style="color: #815ba4">extends</span> <span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">{</span>
  <span style="color: #06b6ef">constructor</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">)</span> <span style="color: #e7e9db">{</span>
    <span style="color: #815ba4">super</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">);</span>

    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">state</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">{</span>
      <span style="color: #06b6ef">authUser</span><span style="color: #5bc4bf">:</span> <span style="color: #815ba4">null</span><span style="color: #e7e9db">,</span>
    <span style="color: #e7e9db">};</span>
  <span style="color: #e7e9db">}</span>

<span style="background-color: #4f424c">  <span style="color: #06b6ef">componentDidMount</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
</span><span style="background-color: #4f424c">    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">firebase</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">auth</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">onAuthStateChanged</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">authUser</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
</span><span style="background-color: #4f424c">      <span style="color: #06b6ef">authUser</span>
</span><span style="background-color: #4f424c">        <span style="color: #5bc4bf">?</span> <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">setState</span><span style="color: #e7e9db">({</span> <span style="color: #06b6ef">authUser</span> <span style="color: #e7e9db">})</span>
</span><span style="background-color: #4f424c">        <span style="color: #5bc4bf">:</span> <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">setState</span><span style="color: #e7e9db">({</span> <span style="color: #06b6ef">authUser</span><span style="color: #5bc4bf">:</span> <span style="color: #815ba4">null</span> <span style="color: #e7e9db">});</span>
</span><span style="background-color: #4f424c">    <span style="color: #e7e9db">});</span>
</span><span style="background-color: #4f424c">  <span style="color: #e7e9db">}</span>
</span>
  <span style="color: #e7e9db">...</span>

<span style="color: #e7e9db">}</span>

<span style="background-color: #4f424c"><span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">withFirebase</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">App</span><span style="color: #e7e9db">);</span>
</span></code></pre>
              </div>


              <p>The helper function <code>onAuthStateChanged()</code> receives a function as parameter that has access
                to the authenticated user. Also, the passed function is called every time something changes for the
                authenticated user. It is called when a user signs up, signs in, and signs out. If a user signs out, the
                <code>authUser</code> object becomes null, so the <code>authUser</code> property in the local state is
                set to null and all components depending on it adjust their behavior (e.g. display different options
                like the Navigation component).</p>

              <p>We also want to avoid memory leaks that lead to <a
                  href="../react-warning-cant-call-setstate-on-an-unmounted-component/index.html">performance
                  issues</a>, so we&rsquo;ll remove the listener if the component unmounts.</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #e7e9db">...</span>

<span style="color: #815ba4">class</span> <span style="color: #06b6ef">App</span> <span style="color: #815ba4">extends</span> <span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">{</span>
  <span style="color: #e7e9db">...</span>

  <span style="color: #06b6ef">componentDidMount</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
<span style="background-color: #4f424c">    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">listener</span> <span style="color: #5bc4bf">=</span> <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">firebase</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">auth</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">onAuthStateChanged</span><span style="color: #e7e9db">(</span>
</span>      <span style="color: #06b6ef">authUser</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
        <span style="color: #06b6ef">authUser</span>
          <span style="color: #5bc4bf">?</span> <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">setState</span><span style="color: #e7e9db">({</span> <span style="color: #06b6ef">authUser</span> <span style="color: #e7e9db">})</span>
          <span style="color: #5bc4bf">:</span> <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">setState</span><span style="color: #e7e9db">({</span> <span style="color: #06b6ef">authUser</span><span style="color: #5bc4bf">:</span> <span style="color: #815ba4">null</span> <span style="color: #e7e9db">});</span>
      <span style="color: #e7e9db">},</span>
    <span style="color: #e7e9db">);</span>
  <span style="color: #e7e9db">}</span>

<span style="background-color: #4f424c">  <span style="color: #06b6ef">componentWillUnmount</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
</span><span style="background-color: #4f424c">    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">listener</span><span style="color: #e7e9db">();</span>
</span><span style="background-color: #4f424c">  <span style="color: #e7e9db">}</span>
</span>
  <span style="color: #e7e9db">...</span>

<span style="color: #e7e9db">}</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">withFirebase</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">App</span><span style="color: #e7e9db">);</span>
</code></pre>
              </div>


              <p>Start your application and verify that your sign up, sign in, and sign out functionality works, and
                that the Navigation component displays the options depending on the session state (authenticated user).
              </p>

              <p>Congratulations, you have successfully implemented the authentication process with Firebase in React.
                Everything in the following sections reagrding authentication is considered extra, to improve the
                developer&rsquo;s experience and add a couple of useful features along the way.</p>

              <h3 id="exercises-8">Exercises:</h3>

              <ul>
                <li>Read more about <a target="_blank" rel="noopener noreferrer"
                    href="https://firebase.google.com/docs/auth/web/manage-users">Firebase&rsquo;s Authenticated
                    User</a></li>
                <li>Confirm your <a target="_blank" rel="noopener noreferrer" href="http://bit.ly/2VrULL2">source code
                    for the last section</a></li>
              </ul>

              <h2 class="chapter-header" id="react-firebase-session-handling-higher-order-components">Session Handling
                with Higher-Order Components</h2>

              <p>We added a basic version of session handling in the last section. However, the authenticated user still
                needs to be passed down from the App component to interested parties. That can become tedious over time,
                because the authenticated user has to be passed through all components until it reaches all the leaf
                components. You used the React Context API to pass down the Firebase instance to any component before.
                Here, you will do the same for the authenticated user. In a new
                <em>src/components/Session/context.js</em> file, place the following new React Context for the session
                (authenticated user):</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">AuthUserContext</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">React</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">createContext</span><span style="color: #e7e9db">(</span><span style="color: #815ba4">null</span><span style="color: #e7e9db">);</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">AuthUserContext</span><span style="color: #e7e9db">;</span>
</code></pre>
              </div>


              <p>Next, import and export it from the <em>src/components/Session/index.js</em> file that is the entry
                point to this module:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">AuthUserContext</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;./context&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">export</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">AuthUserContext</span> <span style="color: #e7e9db">};</span>
</code></pre>
              </div>


              <p>The App component can use the new context to provide the authenticated user to components that are
                interested in it:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #e7e9db">...</span>

<span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">AuthUserContext</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../Session&#39;</span><span style="color: #e7e9db">;</span>
</span>
<span style="color: #815ba4">class</span> <span style="color: #06b6ef">App</span> <span style="color: #815ba4">extends</span> <span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">{</span>
  <span style="color: #e7e9db">...</span>

  <span style="color: #06b6ef">render</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
    <span style="color: #815ba4">return</span> <span style="color: #e7e9db">(</span>
<span style="background-color: #4f424c">      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">AuthUserContext</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">Provider</span> <span style="color: #06b6ef">value</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">state</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">authUser</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span>
</span>        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Router</span><span style="color: #5bc4bf">&gt;</span>
          <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">div</span><span style="color: #5bc4bf">&gt;</span>
<span style="background-color: #4f424c">            <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Navigation</span> <span style="color: #5bc4bf">/&gt;</span>
</span>
            <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">hr</span> <span style="color: #5bc4bf">/&gt;</span>

            <span style="color: #e7e9db">...</span>
          <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/div&gt;</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/Router&gt;</span>
<span style="background-color: #4f424c">      <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/AuthUserContext.Provider&gt;</span>
</span>    <span style="color: #e7e9db">);</span>
  <span style="color: #e7e9db">}</span>
<span style="color: #e7e9db">}</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">withFirebase</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">App</span><span style="color: #e7e9db">);</span>
</code></pre>
              </div>


              <p>The <code>authUser</code> doesn&rsquo;t need to be passed to the Navigation component anymore. Instead,
                the Navigation component uses the new context to consume the authenticated user:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #e7e9db">...</span>

<span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">AuthUserContext</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../Session&#39;</span><span style="color: #e7e9db">;</span>
</span>
<span style="background-color: #4f424c"><span style="color: #815ba4">const</span> <span style="color: #06b6ef">Navigation</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">(</span>
</span>  <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">div</span><span style="color: #5bc4bf">&gt;</span>
<span style="background-color: #4f424c">    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">AuthUserContext</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">Consumer</span><span style="color: #5bc4bf">&gt;</span>
</span><span style="background-color: #4f424c">      <span style="color: #e7e9db">{</span><span style="color: #06b6ef">authUser</span> <span style="color: #5bc4bf">=&gt;</span>
</span><span style="background-color: #4f424c">        <span style="color: #06b6ef">authUser</span> <span style="color: #5bc4bf">?</span> <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">NavigationAuth</span> <span style="color: #5bc4bf">/&gt;</span> <span style="color: #5bc4bf">:</span> <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">NavigationNonAuth</span> <span style="color: #5bc4bf">/&gt;</span>
</span><span style="background-color: #4f424c">      <span style="color: #e7e9db">}</span>
</span><span style="background-color: #4f424c">    <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/AuthUserContext.Consumer&gt;</span>
</span>  <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/div&gt;</span>
<span style="color: #e7e9db">);</span>
</code></pre>
              </div>


              <p>The application works the same as before, except any component can simply use React&rsquo;s Context to
                consume the authenticated user. To keep the App component clean and concise, I like to extract the
                session handling for the authenticated user to a separate higher-order component in a new
                <em>src/components/Session/withAuthentication.js</em> file:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">withAuthentication</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">Component</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
  <span style="color: #815ba4">class</span> <span style="color: #06b6ef">WithAuthentication</span> <span style="color: #815ba4">extends</span> <span style="color: #06b6ef">React</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">{</span>
    <span style="color: #06b6ef">render</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
      <span style="color: #815ba4">return</span> <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">{...</span><span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">}</span> <span style="color: #5bc4bf">/&gt;</span><span style="color: #e7e9db">;</span>
    <span style="color: #e7e9db">}</span>
  <span style="color: #e7e9db">}</span>

  <span style="color: #815ba4">return</span> <span style="color: #06b6ef">WithAuthentication</span><span style="color: #e7e9db">;</span>
<span style="color: #e7e9db">};</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">withAuthentication</span><span style="color: #e7e9db">;</span>
</code></pre>
              </div>


              <p>Move all logic that deals with the authenticated user from the App component to it:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>

<span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #06b6ef">AuthUserContext</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;./context&#39;</span><span style="color: #e7e9db">;</span>
</span><span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">withFirebase</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../Firebase&#39;</span><span style="color: #e7e9db">;</span>
</span>
<span style="color: #815ba4">const</span> <span style="color: #06b6ef">withAuthentication</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">Component</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
  <span style="color: #815ba4">class</span> <span style="color: #06b6ef">WithAuthentication</span> <span style="color: #815ba4">extends</span> <span style="color: #06b6ef">React</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">{</span>
<span style="background-color: #4f424c">    <span style="color: #06b6ef">constructor</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">)</span> <span style="color: #e7e9db">{</span>
</span><span style="background-color: #4f424c">      <span style="color: #815ba4">super</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">);</span>
</span><span style="background-color: #4f424c">
</span><span style="background-color: #4f424c">      <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">state</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">{</span>
</span><span style="background-color: #4f424c">        <span style="color: #06b6ef">authUser</span><span style="color: #5bc4bf">:</span> <span style="color: #815ba4">null</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">      <span style="color: #e7e9db">};</span>
</span><span style="background-color: #4f424c">    <span style="color: #e7e9db">}</span>
</span>
<span style="background-color: #4f424c">    <span style="color: #06b6ef">componentDidMount</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
</span><span style="background-color: #4f424c">      <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">listener</span> <span style="color: #5bc4bf">=</span> <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">firebase</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">auth</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">onAuthStateChanged</span><span style="color: #e7e9db">(</span>
</span><span style="background-color: #4f424c">        <span style="color: #06b6ef">authUser</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
</span><span style="background-color: #4f424c">          <span style="color: #06b6ef">authUser</span>
</span><span style="background-color: #4f424c">            <span style="color: #5bc4bf">?</span> <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">setState</span><span style="color: #e7e9db">({</span> <span style="color: #06b6ef">authUser</span> <span style="color: #e7e9db">})</span>
</span><span style="background-color: #4f424c">            <span style="color: #5bc4bf">:</span> <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">setState</span><span style="color: #e7e9db">({</span> <span style="color: #06b6ef">authUser</span><span style="color: #5bc4bf">:</span> <span style="color: #815ba4">null</span> <span style="color: #e7e9db">});</span>
</span><span style="background-color: #4f424c">        <span style="color: #e7e9db">},</span>
</span><span style="background-color: #4f424c">      <span style="color: #e7e9db">);</span>
</span><span style="background-color: #4f424c">    <span style="color: #e7e9db">}</span>
</span>
<span style="background-color: #4f424c">    <span style="color: #06b6ef">componentWillUnmount</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
</span><span style="background-color: #4f424c">      <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">listener</span><span style="color: #e7e9db">();</span>
</span><span style="background-color: #4f424c">    <span style="color: #e7e9db">}</span>
</span>
    <span style="color: #06b6ef">render</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
<span style="background-color: #4f424c">      <span style="color: #815ba4">return</span> <span style="color: #e7e9db">(</span>
</span><span style="background-color: #4f424c">        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">AuthUserContext</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">Provider</span> <span style="color: #06b6ef">value</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">state</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">authUser</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span>
</span><span style="background-color: #4f424c">          <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">{...</span><span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">}</span> <span style="color: #5bc4bf">/&gt;</span>
</span><span style="background-color: #4f424c">        <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/AuthUserContext.Provider&gt;</span>
</span><span style="background-color: #4f424c">      <span style="color: #e7e9db">);</span>
</span>    <span style="color: #e7e9db">}</span>
  <span style="color: #e7e9db">}</span>

<span style="background-color: #4f424c">  <span style="color: #815ba4">return</span> <span style="color: #06b6ef">withFirebase</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">WithAuthentication</span><span style="color: #e7e9db">);</span>
</span><span style="color: #e7e9db">};</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">withAuthentication</span><span style="color: #e7e9db">;</span>
</code></pre>
              </div>


              <p>As you can see, it also uses the new React Context to provide the authenticated user. The App component
                will not be in charge of it anymore. Next, export the higher-order component from the
                <em>src/components/Session/index.js</em> file, so that it can be used in the App component after:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">AuthUserContext</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;./context&#39;</span><span style="color: #e7e9db">;</span>
<span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #06b6ef">withAuthentication</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;./withAuthentication&#39;</span><span style="color: #e7e9db">;</span>
</span>
<span style="background-color: #4f424c"><span style="color: #815ba4">export</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">AuthUserContext</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">withAuthentication</span> <span style="color: #e7e9db">};</span>
</span></code></pre>
              </div>


              <p>The App component becomes a function component again, without the additional business logic for the
                authenticated user. Now, it uses the higher-order component to make the authenticated user available for
                all other components below of the App component:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>
</span><span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">BrowserRouter</span> <span style="color: #06b6ef">as</span> <span style="color: #06b6ef">Router</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">Route</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react-router-dom&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">import</span> <span style="color: #06b6ef">Navigation</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../Navigation&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #06b6ef">LandingPage</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../Landing&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #06b6ef">SignUpPage</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../SignUp&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #06b6ef">SignInPage</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../SignIn&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #06b6ef">PasswordForgetPage</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../PasswordForget&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #06b6ef">HomePage</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../Home&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #06b6ef">AccountPage</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../Account&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #06b6ef">AdminPage</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../Admin&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">import</span> <span style="color: #5bc4bf">*</span> <span style="color: #06b6ef">as</span> <span style="color: #06b6ef">ROUTES</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../../constants/routes&#39;</span><span style="color: #e7e9db">;</span>
<span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">withAuthentication</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../Session&#39;</span><span style="color: #e7e9db">;</span>
</span>
<span style="background-color: #4f424c"><span style="color: #815ba4">const</span> <span style="color: #06b6ef">App</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">(</span>
</span>  <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Router</span><span style="color: #5bc4bf">&gt;</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">div</span><span style="color: #5bc4bf">&gt;</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Navigation</span> <span style="color: #5bc4bf">/&gt;</span>

      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">hr</span> <span style="color: #5bc4bf">/&gt;</span>

      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Route</span> <span style="color: #06b6ef">exact</span> <span style="color: #06b6ef">path</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">ROUTES</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">LANDING</span><span style="color: #e7e9db">}</span> <span style="color: #06b6ef">component</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">LandingPage</span><span style="color: #e7e9db">}</span> <span style="color: #5bc4bf">/&gt;</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Route</span> <span style="color: #06b6ef">path</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">ROUTES</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">SIGN_UP</span><span style="color: #e7e9db">}</span> <span style="color: #06b6ef">component</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">SignUpPage</span><span style="color: #e7e9db">}</span> <span style="color: #5bc4bf">/&gt;</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Route</span> <span style="color: #06b6ef">path</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">ROUTES</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">SIGN_IN</span><span style="color: #e7e9db">}</span> <span style="color: #06b6ef">component</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">SignInPage</span><span style="color: #e7e9db">}</span> <span style="color: #5bc4bf">/&gt;</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Route</span>
        <span style="color: #06b6ef">path</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">ROUTES</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">PASSWORD_FORGET</span><span style="color: #e7e9db">}</span>
        <span style="color: #06b6ef">component</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">PasswordForgetPage</span><span style="color: #e7e9db">}</span>
      <span style="color: #5bc4bf">/&gt;</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Route</span> <span style="color: #06b6ef">path</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">ROUTES</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">HOME</span><span style="color: #e7e9db">}</span> <span style="color: #06b6ef">component</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">HomePage</span><span style="color: #e7e9db">}</span> <span style="color: #5bc4bf">/&gt;</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Route</span> <span style="color: #06b6ef">path</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">ROUTES</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">ACCOUNT</span><span style="color: #e7e9db">}</span> <span style="color: #06b6ef">component</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">AccountPage</span><span style="color: #e7e9db">}</span> <span style="color: #5bc4bf">/&gt;</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Route</span> <span style="color: #06b6ef">path</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">ROUTES</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">ADMIN</span><span style="color: #e7e9db">}</span> <span style="color: #06b6ef">component</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">AdminPage</span><span style="color: #e7e9db">}</span> <span style="color: #5bc4bf">/&gt;</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/div&gt;</span>
  <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/Router&gt;</span>
<span style="background-color: #4f424c"><span style="color: #e7e9db">);</span>
</span>
<span style="background-color: #4f424c"><span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">withAuthentication</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">App</span><span style="color: #e7e9db">);</span>
</span></code></pre>
              </div>


              <p>Start the application and verify that it still works. You didn&rsquo;t change any behavior in this
                section, but shielded away the more complex logic into a higher-order component. Also, the application
                now passes the authenticated user implicitly via React&rsquo;s Context, rather than explicitly through
                the component tree using props.</p>

              <h3 id="exercises-9">Exercises:</h3>

              <ul>
                <li>Check again your Firebase Context and higher-order component implementation in the
                  <em>src/components/Firebase</em> module, which is quite similar to what you have done in this section.
                </li>
                <li>Confirm your <a target="_blank" rel="noopener noreferrer" href="http://bit.ly/2VjYz0R">source code
                    for the last section</a></li>
              </ul>

              <h2 class="chapter-header" id="react-firebase-password">Password Reset and Password Change with Firebase
              </h2>

              <p>Let&rsquo;s take a step back from the higher-order components, React Context API, and session handling.
                In this section, we will implement two additional features available in the Firebase authentication API,
                the ability to retrieve (password forget) and change a password.</p>

              <h3 id="firebase-password-forget">Password Forget</h3>

              <p>Let&rsquo;s start by implementing the password forget feature. Since you already implemented the
                interface in your Firebase class, you can use it in components. The following file adds most of the
                password reset logic in a form again. We already used a couple of those forms before, so it
                shouldn&rsquo;t be different now. Add this in the <em>src/components/PasswordForget/index.js</em> file:
              </p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span><span style="color: #e7e9db">,</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">Link</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react-router-dom&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">withFirebase</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../Firebase&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #5bc4bf">*</span> <span style="color: #06b6ef">as</span> <span style="color: #06b6ef">ROUTES</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../../constants/routes&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">PasswordForgetPage</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">(</span>
  <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">div</span><span style="color: #5bc4bf">&gt;</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">h1</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">PasswordForget</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/h1&gt;</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">PasswordForgetForm</span> <span style="color: #5bc4bf">/&gt;</span>
  <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/div&gt;</span>
<span style="color: #e7e9db">);</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">INITIAL_STATE</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">{</span>
  <span style="color: #06b6ef">email</span><span style="color: #5bc4bf">:</span> <span style="color: #48b685">&#39;&#39;</span><span style="color: #e7e9db">,</span>
  <span style="color: #06b6ef">error</span><span style="color: #5bc4bf">:</span> <span style="color: #815ba4">null</span><span style="color: #e7e9db">,</span>
<span style="color: #e7e9db">};</span>

<span style="color: #815ba4">class</span> <span style="color: #06b6ef">PasswordForgetFormBase</span> <span style="color: #815ba4">extends</span> <span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">{</span>
  <span style="color: #06b6ef">constructor</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">)</span> <span style="color: #e7e9db">{</span>
    <span style="color: #815ba4">super</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">);</span>

    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">state</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">{</span> <span style="color: #e7e9db">...</span><span style="color: #06b6ef">INITIAL_STATE</span> <span style="color: #e7e9db">};</span>
  <span style="color: #e7e9db">}</span>

  <span style="color: #06b6ef">onSubmit</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">event</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
    <span style="color: #815ba4">const</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">email</span> <span style="color: #e7e9db">}</span> <span style="color: #5bc4bf">=</span> <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">state</span><span style="color: #e7e9db">;</span>

    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">firebase</span>
      <span style="color: #e7e9db">.</span><span style="color: #06b6ef">doPasswordReset</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">email</span><span style="color: #e7e9db">)</span>
      <span style="color: #e7e9db">.</span><span style="color: #06b6ef">then</span><span style="color: #e7e9db">(()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
        <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">setState</span><span style="color: #e7e9db">({</span> <span style="color: #e7e9db">...</span><span style="color: #06b6ef">INITIAL_STATE</span> <span style="color: #e7e9db">});</span>
      <span style="color: #e7e9db">})</span>
      <span style="color: #e7e9db">.</span><span style="color: #815ba4">catch</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">error</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
        <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">setState</span><span style="color: #e7e9db">({</span> <span style="color: #06b6ef">error</span> <span style="color: #e7e9db">});</span>
      <span style="color: #e7e9db">});</span>

    <span style="color: #06b6ef">event</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">preventDefault</span><span style="color: #e7e9db">();</span>
  <span style="color: #e7e9db">};</span>

  <span style="color: #06b6ef">onChange</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">event</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">setState</span><span style="color: #e7e9db">({</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">event</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">target</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">name</span><span style="color: #e7e9db">]</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">event</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">target</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">value</span> <span style="color: #e7e9db">});</span>
  <span style="color: #e7e9db">};</span>

  <span style="color: #06b6ef">render</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
    <span style="color: #815ba4">const</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">email</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">error</span> <span style="color: #e7e9db">}</span> <span style="color: #5bc4bf">=</span> <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">state</span><span style="color: #e7e9db">;</span>

    <span style="color: #815ba4">const</span> <span style="color: #06b6ef">isInvalid</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">email</span> <span style="color: #5bc4bf">===</span> <span style="color: #48b685">&#39;&#39;</span><span style="color: #e7e9db">;</span>

    <span style="color: #815ba4">return</span> <span style="color: #e7e9db">(</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">form</span> <span style="color: #06b6ef">onSubmit</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">onSubmit</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">input</span>
          <span style="color: #06b6ef">name</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;email&quot;</span>
          <span style="color: #06b6ef">value</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">state</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">email</span><span style="color: #e7e9db">}</span>
          <span style="color: #06b6ef">onChange</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">onChange</span><span style="color: #e7e9db">}</span>
          <span style="color: #06b6ef">type</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;text&quot;</span>
          <span style="color: #06b6ef">placeholder</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;Email Address&quot;</span>
        <span style="color: #5bc4bf">/&gt;</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">button</span> <span style="color: #06b6ef">disabled</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">isInvalid</span><span style="color: #e7e9db">}</span> <span style="color: #06b6ef">type</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;submit&quot;</span><span style="color: #5bc4bf">&gt;</span>
          <span style="color: #06b6ef">Reset</span> <span style="color: #06b6ef">My</span> <span style="color: #06b6ef">Password</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/button&gt;</span>

        <span style="color: #e7e9db">{</span><span style="color: #06b6ef">error</span> <span style="color: #5bc4bf">&amp;&amp;</span> <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">p</span><span style="color: #5bc4bf">&gt;</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">error</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">message</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/p&gt;}</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/form&gt;</span>
    <span style="color: #e7e9db">);</span>
  <span style="color: #e7e9db">}</span>
<span style="color: #e7e9db">}</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">PasswordForgetLink</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">(</span>
  <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">p</span><span style="color: #5bc4bf">&gt;</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Link</span> <span style="color: #06b6ef">to</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">ROUTES</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">PASSWORD_FORGET</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">Forgot</span> <span style="color: #06b6ef">Password</span><span style="color: #5bc4bf">?&lt;</span><span style="color: #ef6155">/Link&gt;</span>
  <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/p&gt;</span>
<span style="color: #e7e9db">);</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">PasswordForgetPage</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">PasswordForgetForm</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">withFirebase</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">PasswordForgetFormBase</span><span style="color: #e7e9db">);</span>

<span style="color: #815ba4">export</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">PasswordForgetForm</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">PasswordForgetLink</span> <span style="color: #e7e9db">};</span>
</code></pre>
              </div>


              <p>The code is verbose, but it it&rsquo;s no different from the sign up and sign in forms from previous
                sections. The password forget uses a form to submit the information (email address) needed by the
                Firebase authentication API to reset the password. A class method (onSubmit) ensures the information is
                send to the API. It also resets the form&rsquo;s input field on a successful request, and shows an error
                on an erroneous request. The form is validated before it is submitted as well. The file implements a
                password forget link as a component which isn&rsquo;t used directly in the form component. It is similar
                to the SignUpLink component that we used on in the SignInPage component. This link is the same, and
                it&rsquo;s still usable. If a user forgets the password after sign up, the password forget page uses the
                link in the <em>src/components/SignIn/index.js</em> file:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span><span style="color: #e7e9db">,</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">withRouter</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react-router-dom&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">compose</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;recompose&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">SignUpLink</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../SignUp&#39;</span><span style="color: #e7e9db">;</span>
<span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">PasswordForgetLink</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../PasswordForget&#39;</span><span style="color: #e7e9db">;</span>
</span><span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">withFirebase</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../Firebase&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #5bc4bf">*</span> <span style="color: #06b6ef">as</span> <span style="color: #06b6ef">ROUTES</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../../constants/routes&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">SignInPage</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">(</span>
  <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">div</span><span style="color: #5bc4bf">&gt;</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">h1</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">SignIn</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/h1&gt;</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">SignInForm</span> <span style="color: #5bc4bf">/&gt;</span>
<span style="background-color: #4f424c">    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">PasswordForgetLink</span> <span style="color: #5bc4bf">/&gt;</span>
</span>    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">SignUpLink</span> <span style="color: #5bc4bf">/&gt;</span>
  <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/div&gt;</span>
<span style="color: #e7e9db">);</span>


<span style="color: #e7e9db">...</span>
</code></pre>
              </div>


              <p>The password forget page is already matched in the App component, so you can drop the
                PasswordForgetLink component in the sign in page and know the mapping between route and component is
                complete. Start the application and reset your password. It doesn&rsquo;t matter if you are
                authenticated or not. Once you send the request, you should get an email from Firebase to update your
                password.</p>

              <h3 id="firebase-password-change">Password Change</h3>

              <p>Next we&rsquo;ll add the password change feature, which is also in your Firebase interface. You only
                need a form component to use it. Again, the form component isn&rsquo;t any different from the sign in,
                sign up, and password forget forms. In the <em>src/components/PasswordChange/index.js</em> file add the
                following component:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span><span style="color: #e7e9db">,</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">withFirebase</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../Firebase&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">INITIAL_STATE</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">{</span>
  <span style="color: #06b6ef">passwordOne</span><span style="color: #5bc4bf">:</span> <span style="color: #48b685">&#39;&#39;</span><span style="color: #e7e9db">,</span>
  <span style="color: #06b6ef">passwordTwo</span><span style="color: #5bc4bf">:</span> <span style="color: #48b685">&#39;&#39;</span><span style="color: #e7e9db">,</span>
  <span style="color: #06b6ef">error</span><span style="color: #5bc4bf">:</span> <span style="color: #815ba4">null</span><span style="color: #e7e9db">,</span>
<span style="color: #e7e9db">};</span>

<span style="color: #815ba4">class</span> <span style="color: #06b6ef">PasswordChangeForm</span> <span style="color: #815ba4">extends</span> <span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">{</span>
  <span style="color: #06b6ef">constructor</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">)</span> <span style="color: #e7e9db">{</span>
    <span style="color: #815ba4">super</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">);</span>

    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">state</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">{</span> <span style="color: #e7e9db">...</span><span style="color: #06b6ef">INITIAL_STATE</span> <span style="color: #e7e9db">};</span>
  <span style="color: #e7e9db">}</span>

  <span style="color: #06b6ef">onSubmit</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">event</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
    <span style="color: #815ba4">const</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">passwordOne</span> <span style="color: #e7e9db">}</span> <span style="color: #5bc4bf">=</span> <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">state</span><span style="color: #e7e9db">;</span>

    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">firebase</span>
      <span style="color: #e7e9db">.</span><span style="color: #06b6ef">doPasswordUpdate</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">passwordOne</span><span style="color: #e7e9db">)</span>
      <span style="color: #e7e9db">.</span><span style="color: #06b6ef">then</span><span style="color: #e7e9db">(()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
        <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">setState</span><span style="color: #e7e9db">({</span> <span style="color: #e7e9db">...</span><span style="color: #06b6ef">INITIAL_STATE</span> <span style="color: #e7e9db">});</span>
      <span style="color: #e7e9db">})</span>
      <span style="color: #e7e9db">.</span><span style="color: #815ba4">catch</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">error</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
        <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">setState</span><span style="color: #e7e9db">({</span> <span style="color: #06b6ef">error</span> <span style="color: #e7e9db">});</span>
      <span style="color: #e7e9db">});</span>

    <span style="color: #06b6ef">event</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">preventDefault</span><span style="color: #e7e9db">();</span>
  <span style="color: #e7e9db">};</span>

  <span style="color: #06b6ef">onChange</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">event</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">setState</span><span style="color: #e7e9db">({</span> <span style="color: #e7e9db">[</span><span style="color: #06b6ef">event</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">target</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">name</span><span style="color: #e7e9db">]</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">event</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">target</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">value</span> <span style="color: #e7e9db">});</span>
  <span style="color: #e7e9db">};</span>

  <span style="color: #06b6ef">render</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
    <span style="color: #815ba4">const</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">passwordOne</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">passwordTwo</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">error</span> <span style="color: #e7e9db">}</span> <span style="color: #5bc4bf">=</span> <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">state</span><span style="color: #e7e9db">;</span>

    <span style="color: #815ba4">const</span> <span style="color: #06b6ef">isInvalid</span> <span style="color: #5bc4bf">=</span>
      <span style="color: #06b6ef">passwordOne</span> <span style="color: #5bc4bf">!==</span> <span style="color: #06b6ef">passwordTwo</span> <span style="color: #5bc4bf">||</span> <span style="color: #06b6ef">passwordOne</span> <span style="color: #5bc4bf">===</span> <span style="color: #48b685">&#39;&#39;</span><span style="color: #e7e9db">;</span>

    <span style="color: #815ba4">return</span> <span style="color: #e7e9db">(</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">form</span> <span style="color: #06b6ef">onSubmit</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">onSubmit</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">input</span>
          <span style="color: #06b6ef">name</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;passwordOne&quot;</span>
          <span style="color: #06b6ef">value</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">passwordOne</span><span style="color: #e7e9db">}</span>
          <span style="color: #06b6ef">onChange</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">onChange</span><span style="color: #e7e9db">}</span>
          <span style="color: #06b6ef">type</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;password&quot;</span>
          <span style="color: #06b6ef">placeholder</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;New Password&quot;</span>
        <span style="color: #5bc4bf">/&gt;</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">input</span>
          <span style="color: #06b6ef">name</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;passwordTwo&quot;</span>
          <span style="color: #06b6ef">value</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">passwordTwo</span><span style="color: #e7e9db">}</span>
          <span style="color: #06b6ef">onChange</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">onChange</span><span style="color: #e7e9db">}</span>
          <span style="color: #06b6ef">type</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;password&quot;</span>
          <span style="color: #06b6ef">placeholder</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;Confirm New Password&quot;</span>
        <span style="color: #5bc4bf">/&gt;</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">button</span> <span style="color: #06b6ef">disabled</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">isInvalid</span><span style="color: #e7e9db">}</span> <span style="color: #06b6ef">type</span><span style="color: #5bc4bf">=</span><span style="color: #48b685">&quot;submit&quot;</span><span style="color: #5bc4bf">&gt;</span>
          <span style="color: #06b6ef">Reset</span> <span style="color: #06b6ef">My</span> <span style="color: #06b6ef">Password</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/button&gt;</span>

        <span style="color: #e7e9db">{</span><span style="color: #06b6ef">error</span> <span style="color: #5bc4bf">&amp;&amp;</span> <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">p</span><span style="color: #5bc4bf">&gt;</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">error</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">message</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/p&gt;}</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/form&gt;</span>
    <span style="color: #e7e9db">);</span>
  <span style="color: #e7e9db">}</span>
<span style="color: #e7e9db">}</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">withFirebase</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">PasswordChangeForm</span><span style="color: #e7e9db">);</span>
</code></pre>
              </div>


              <p>The component updates its local state using <code>onChange</code> handlers in the input fields. It
                validates the state before submitting a request to change the password by enabling or disabling the
                submit button, and it shows again an error message when a request fails.</p>

              <p>So far, the PasswordChangeForm is not matched by any route, because it should live on the Account page.
                The Account page could serve as the central place for users to manage their account, where it shows the
                PasswordChangeForm and PasswordResetForm, accessible by a standalone route. You already created the
                <em>src/components/Account/index.js</em> file and matched the route in the App component. You only need
                to implement it:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">PasswordForgetForm</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../PasswordForget&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #06b6ef">PasswordChangeForm</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../PasswordChange&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">AccountPage</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">(</span>
  <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">div</span><span style="color: #5bc4bf">&gt;</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">h1</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">Account</span> <span style="color: #06b6ef">Page</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/h1&gt;</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">PasswordForgetForm</span> <span style="color: #5bc4bf">/&gt;</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">PasswordChangeForm</span> <span style="color: #5bc4bf">/&gt;</span>
  <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/div&gt;</span>
<span style="color: #e7e9db">);</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">AccountPage</span><span style="color: #e7e9db">;</span>
</code></pre>
              </div>


              <p>The Account page doesn&rsquo;t have any business logic. It uses the password forget and password change
                forms in a central place. In this section, your user experience improved significantly with the password
                forget and password change features, handling scenarios where users have trouble remembering passwords.
              </p>

              <h3 id="exercises-10">Exercises:</h3>

              <ul>
                <li>Consider ways to protect the Account page and make it accessible only for authenticated users.</li>
                <li>Confirm your <a target="_blank" rel="noopener noreferrer" href="http://bit.ly/2VqWgt4">source code
                    for the last section</a></li>
              </ul>

              <h2 class="chapter-header" id="react-firebase-protected-routes">Protected Routes in React with
                Authorization</h2>

              <p>So far, all of your application&rsquo;s routes are accessible by everyone. It doesn&rsquo;t matter
                whether the user is authenticated or not authenticated. For instance, when you sign out on the home or
                account page, there is no redirect, even though these pages should be only accessible for authenticated
                users. There is no reason to show a non authenticated user the account or home page in the first place,
                because these are the places where a user accesses sensible information. In this section, so you will
                implement a protection for these routes called authorization. The protection is a <strong>broad-grained
                  authorization</strong>, which checks for authenticated users. If none is present, it redirects from a
                protected to a public route; else, it will do nothing. The condition is defined as:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">const</span> <span style="color: #06b6ef">condition</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">authUser</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #06b6ef">authUser</span> <span style="color: #5bc4bf">!=</span> <span style="color: #815ba4">null</span><span style="color: #e7e9db">;</span>

<span style="color: #776e71">// short version</span>
<span style="color: #815ba4">const</span> <span style="color: #06b6ef">condition</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">authUser</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #5bc4bf">!!</span><span style="color: #06b6ef">authUser</span><span style="color: #e7e9db">;</span>
</code></pre>
              </div>


              <p>In contrast, a more <strong>fine-grained authorization</strong> could be a role-based or
                permission-based authorization:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #776e71">// role-based authorization</span>
<span style="color: #815ba4">const</span> <span style="color: #06b6ef">condition</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">authUser</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #06b6ef">authUser</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">role</span> <span style="color: #5bc4bf">===</span> <span style="color: #48b685">&#39;ADMIN&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #776e71">// permission-based authorization</span>
<span style="color: #815ba4">const</span> <span style="color: #06b6ef">condition</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">authUser</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #06b6ef">authUser</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">permissions</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">canEditAccount</span><span style="color: #e7e9db">;</span>
</code></pre>
              </div>


              <p>Fortunately, we implement it in a way that lets you define the authorization condition (predicate) with
                flexibility, so that you can use a more generalized authorization rule, permission-based or role-based
                authorizations.</p>

              <p>Like the <code>withAuthentication</code> higher-order component, there is a
                <code>withAuthorization</code> higher-order component to shield the authorization business logic from
                your components. It can be used on any component that needs to be protected with authorization (e.g.
                home page, account page). Let&rsquo;s start to add the higher-order component in a new
                <em>src/components/Session/withAuthorization.js</em> file:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">withAuthorization</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #06b6ef">Component</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
  <span style="color: #815ba4">class</span> <span style="color: #06b6ef">WithAuthorization</span> <span style="color: #815ba4">extends</span> <span style="color: #06b6ef">React</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">{</span>
    <span style="color: #06b6ef">render</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
      <span style="color: #815ba4">return</span> <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">{...</span><span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">}</span> <span style="color: #5bc4bf">/&gt;</span><span style="color: #e7e9db">;</span>
    <span style="color: #e7e9db">}</span>
  <span style="color: #e7e9db">}</span>

  <span style="color: #815ba4">return</span> <span style="color: #06b6ef">WithAuthorization</span><span style="color: #e7e9db">;</span>
<span style="color: #e7e9db">};</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">withAuthorization</span><span style="color: #e7e9db">;</span>
</code></pre>
              </div>


              <p>So far, the higher-order component is not doing anything but taking a component as input and returning
                it as output. However, the higher-order component should be able to receive a condition function passed
                as parameter. You can decide if it should be a broad or fine-grained (role-based, permission-based)
                authorization rule. Second, it has to decide based on the condition whether it should redirect to a
                public page (public route), because the user isn&rsquo;t authorized to view the current protected page
                (protected route). Let&rsquo;s paste the implementation details for the higher-order component and go
                through it step-by-step:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>
<span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">withRouter</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react-router-dom&#39;</span><span style="color: #e7e9db">;</span>
</span><span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">compose</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;recompose&#39;</span><span style="color: #e7e9db">;</span>
</span>
<span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">withFirebase</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../Firebase&#39;</span><span style="color: #e7e9db">;</span>
</span><span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #5bc4bf">*</span> <span style="color: #06b6ef">as</span> <span style="color: #06b6ef">ROUTES</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../../constants/routes&#39;</span><span style="color: #e7e9db">;</span>
</span>
<span style="background-color: #4f424c"><span style="color: #815ba4">const</span> <span style="color: #06b6ef">withAuthorization</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">condition</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #06b6ef">Component</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
</span>  <span style="color: #815ba4">class</span> <span style="color: #06b6ef">WithAuthorization</span> <span style="color: #815ba4">extends</span> <span style="color: #06b6ef">React</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">{</span>
<span style="background-color: #4f424c">    <span style="color: #06b6ef">componentDidMount</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
</span><span style="background-color: #4f424c">      <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">listener</span> <span style="color: #5bc4bf">=</span> <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">firebase</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">auth</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">onAuthStateChanged</span><span style="color: #e7e9db">(</span>
</span><span style="background-color: #4f424c">        <span style="color: #06b6ef">authUser</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
</span><span style="background-color: #4f424c">          <span style="color: #815ba4">if</span> <span style="color: #e7e9db">(</span><span style="color: #5bc4bf">!</span><span style="color: #06b6ef">condition</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">authUser</span><span style="color: #e7e9db">))</span> <span style="color: #e7e9db">{</span>
</span><span style="background-color: #4f424c">            <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">history</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">push</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">ROUTES</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">SIGN_IN</span><span style="color: #e7e9db">);</span>
</span><span style="background-color: #4f424c">          <span style="color: #e7e9db">}</span>
</span><span style="background-color: #4f424c">        <span style="color: #e7e9db">},</span>
</span><span style="background-color: #4f424c">      <span style="color: #e7e9db">);</span>
</span><span style="background-color: #4f424c">    <span style="color: #e7e9db">}</span>
</span>
<span style="background-color: #4f424c">    <span style="color: #06b6ef">componentWillUnmount</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
</span><span style="background-color: #4f424c">      <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">listener</span><span style="color: #e7e9db">();</span>
</span><span style="background-color: #4f424c">    <span style="color: #e7e9db">}</span>
</span>
    <span style="color: #06b6ef">render</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
      <span style="color: #815ba4">return</span> <span style="color: #e7e9db">(</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">{...</span><span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">}</span> <span style="color: #5bc4bf">/&gt;</span>
      <span style="color: #e7e9db">);</span>
    <span style="color: #e7e9db">}</span>
  <span style="color: #e7e9db">}</span>

<span style="background-color: #4f424c">  <span style="color: #815ba4">return</span> <span style="color: #06b6ef">compose</span><span style="color: #e7e9db">(</span>
</span><span style="background-color: #4f424c">    <span style="color: #06b6ef">withRouter</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">    <span style="color: #06b6ef">withFirebase</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">  <span style="color: #e7e9db">)(</span><span style="color: #06b6ef">WithAuthorization</span><span style="color: #e7e9db">);</span>
</span><span style="color: #e7e9db">};</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">withAuthorization</span><span style="color: #e7e9db">;</span>
</code></pre>
              </div>


              <p>The render method displays the passed component (e.g. home page, account page) that should be protected
                by this higher-order component. We will refine this later. The real authorization logic happens in the
                <code>componentDidMount()</code> lifecycle method. Like the <code>withAuthentication()</code>
                higher-order component, it uses the Firebase listener to trigger a callback function every time the
                authenticated user changes. The authenticated user is either a <code>authUser</code> object or
                <code>null</code>. Within this function, the passed <code>condition()</code> function is executed with
                the <code>authUser</code>. If the authorization fails, for instance because the authenticated user is
                <code>null</code>, the higher-order component redirects to the sign in page. If it doesn&rsquo;t fail,
                the higher-order component does nothing and renders the passed component (e.g. home page, account page).
                To redirect a user, the higher-order component has access to the history object of the Router using the
                in-house <code>withRouter()</code> higher-order component from the React Router library.</p>

              <p>Remember to export the higher-order component from your session module into the
                <em>src/components/Sessions/index.js</em> file:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">AuthUserContext</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;./context&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #06b6ef">withAuthentication</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;./withAuthentication&#39;</span><span style="color: #e7e9db">;</span>
<span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #06b6ef">withAuthorization</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;./withAuthorization&#39;</span><span style="color: #e7e9db">;</span>
</span>
<span style="background-color: #4f424c"><span style="color: #815ba4">export</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">AuthUserContext</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">withAuthentication</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">withAuthorization</span> <span style="color: #e7e9db">};</span>
</span></code></pre>
              </div>


              <p>In the next step, you can use the higher-order component to protect your routes (e.g. /home and
                /account) with authorization rules using the passed <code>condition()</code> function. To keep it
                simple, the following two components are only protected with a broad authorization rule that checks if
                the <code>authUser</code> is not <code>null</code>. First, enhance the HomePage component with the
                higher-order component and define the authorization condition for it:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>

<span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">withAuthorization</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../Session&#39;</span><span style="color: #e7e9db">;</span>
</span>
<span style="color: #815ba4">const</span> <span style="color: #06b6ef">HomePage</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">(</span>
  <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">div</span><span style="color: #5bc4bf">&gt;</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">h1</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">Home</span> <span style="color: #06b6ef">Page</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/h1&gt;</span>
<span style="background-color: #4f424c">    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">p</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">The</span> <span style="color: #06b6ef">Home</span> <span style="color: #06b6ef">Page</span> <span style="color: #06b6ef">is</span> <span style="color: #06b6ef">accessible</span> <span style="color: #06b6ef">by</span> <span style="color: #06b6ef">every</span> <span style="color: #06b6ef">signed</span> <span style="color: #815ba4">in</span> <span style="color: #06b6ef">user</span><span style="color: #e7e9db">.</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/p&gt;</span>
</span>  <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/div&gt;</span>
<span style="color: #e7e9db">);</span>

<span style="background-color: #4f424c"><span style="color: #815ba4">const</span> <span style="color: #06b6ef">condition</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">authUser</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #5bc4bf">!!</span><span style="color: #06b6ef">authUser</span><span style="color: #e7e9db">;</span>
</span>
<span style="background-color: #4f424c"><span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">withAuthorization</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">condition</span><span style="color: #e7e9db">)(</span><span style="color: #06b6ef">HomePage</span><span style="color: #e7e9db">);</span>
</span></code></pre>
              </div>


              <p>Second, enhance the AccountPage component with the higher-order component and define the authorization
                condition. It similar to the previous usage:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">PasswordForgetForm</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../PasswordForget&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #06b6ef">PasswordChangeForm</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../PasswordChange&#39;</span><span style="color: #e7e9db">;</span>
<span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">withAuthorization</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../Session&#39;</span><span style="color: #e7e9db">;</span>
</span>
<span style="color: #815ba4">const</span> <span style="color: #06b6ef">AccountPage</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">(</span>
  <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">div</span><span style="color: #5bc4bf">&gt;</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">h1</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">Account</span> <span style="color: #06b6ef">Page</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/h1&gt;</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">PasswordForgetForm</span> <span style="color: #5bc4bf">/&gt;</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">PasswordChangeForm</span> <span style="color: #5bc4bf">/&gt;</span>
  <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/div&gt;</span>
<span style="color: #e7e9db">);</span>

<span style="background-color: #4f424c"><span style="color: #815ba4">const</span> <span style="color: #06b6ef">condition</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">authUser</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #5bc4bf">!!</span><span style="color: #06b6ef">authUser</span><span style="color: #e7e9db">;</span>
</span>
<span style="background-color: #4f424c"><span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">withAuthorization</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">condition</span><span style="color: #e7e9db">)(</span><span style="color: #06b6ef">AccountPage</span><span style="color: #e7e9db">);</span>
</span></code></pre>
              </div>


              <p>The protection of both pages/routes is almost done. One refinement can be made in the
                <code>withAuthorization</code> higher-order component using the authenticated user from the context:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">withRouter</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react-router-dom&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">compose</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;recompose&#39;</span><span style="color: #e7e9db">;</span>

<span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #06b6ef">AuthUserContext</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;./context&#39;</span><span style="color: #e7e9db">;</span>
</span><span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">withFirebase</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../Firebase&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #5bc4bf">*</span> <span style="color: #06b6ef">as</span> <span style="color: #06b6ef">ROUTES</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../../constants/routes&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">withAuthorization</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">condition</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #06b6ef">Component</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
  <span style="color: #815ba4">class</span> <span style="color: #06b6ef">WithAuthorization</span> <span style="color: #815ba4">extends</span> <span style="color: #06b6ef">React</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">{</span>
    <span style="color: #06b6ef">componentDidMount</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
      <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">listener</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">firebase</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">auth</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">onAuthStateChanged</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">authUser</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
        <span style="color: #815ba4">if</span> <span style="color: #e7e9db">(</span><span style="color: #5bc4bf">!</span><span style="color: #06b6ef">condition</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">authUser</span><span style="color: #e7e9db">))</span> <span style="color: #e7e9db">{</span>
          <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">history</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">push</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">ROUTES</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">SIGN_IN</span><span style="color: #e7e9db">);</span>
        <span style="color: #e7e9db">}</span>
      <span style="color: #e7e9db">});</span>
    <span style="color: #e7e9db">}</span>

    <span style="color: #06b6ef">componentWillUnmount</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
      <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">listener</span><span style="color: #e7e9db">();</span>
    <span style="color: #e7e9db">}</span>

    <span style="color: #06b6ef">render</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
      <span style="color: #815ba4">return</span> <span style="color: #e7e9db">(</span>
<span style="background-color: #4f424c">        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">AuthUserContext</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">Consumer</span><span style="color: #5bc4bf">&gt;</span>
</span><span style="background-color: #4f424c">          <span style="color: #e7e9db">{</span><span style="color: #06b6ef">authUser</span> <span style="color: #5bc4bf">=&gt;</span>
</span><span style="background-color: #4f424c">            <span style="color: #06b6ef">condition</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">authUser</span><span style="color: #e7e9db">)</span> <span style="color: #5bc4bf">?</span> <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">{...</span><span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">}</span> <span style="color: #5bc4bf">/&gt;</span> <span style="color: #5bc4bf">:</span> <span style="color: #815ba4">null</span>
</span><span style="background-color: #4f424c">          <span style="color: #e7e9db">}</span>
</span><span style="background-color: #4f424c">        <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/AuthUserContext.Consumer&gt;</span>
</span>      <span style="color: #e7e9db">);</span>
    <span style="color: #e7e9db">}</span>
  <span style="color: #e7e9db">}</span>

  <span style="color: #815ba4">return</span> <span style="color: #06b6ef">compose</span><span style="color: #e7e9db">(</span>
    <span style="color: #06b6ef">withRouter</span><span style="color: #e7e9db">,</span>
    <span style="color: #06b6ef">withFirebase</span><span style="color: #e7e9db">,</span>
  <span style="color: #e7e9db">)(</span><span style="color: #06b6ef">WithAuthorization</span><span style="color: #e7e9db">);</span>
<span style="color: #e7e9db">};</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">withAuthorization</span><span style="color: #e7e9db">;</span>
</code></pre>
              </div>


              <p>The improvement in the render method was needed to avoid showing the protected page before the redirect
                happens. You want to show nothing if the authenticated user doesn&rsquo;t meet the condition&rsquo;s
                criteria. Then it&rsquo;s fine if the listener is too late to redirect the user, because the
                higher-order component didn&rsquo;t show the protected component.</p>

              <p>Both routes are protected now, so we can render properties of the authenticated user in the AccountPage
                component without a null check for the authenticated user. You know the user should be there, otherwise
                the higher-order component would redirect to a public route.</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>

<span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">AuthUserContext</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">withAuthorization</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../Session&#39;</span><span style="color: #e7e9db">;</span>
</span><span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">PasswordForgetForm</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../PasswordForget&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #06b6ef">PasswordChangeForm</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../PasswordChange&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">AccountPage</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">(</span>
<span style="background-color: #4f424c">  <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">AuthUserContext</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">Consumer</span><span style="color: #5bc4bf">&gt;</span>
</span><span style="background-color: #4f424c">    <span style="color: #e7e9db">{</span><span style="color: #06b6ef">authUser</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">(</span>
</span>      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">div</span><span style="color: #5bc4bf">&gt;</span>
<span style="background-color: #4f424c">        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">h1</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">Account</span><span style="color: #5bc4bf">:</span> <span style="color: #e7e9db">{</span><span style="color: #06b6ef">authUser</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">email</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/h1&gt;</span>
</span>        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">PasswordForgetForm</span> <span style="color: #5bc4bf">/&gt;</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">PasswordChangeForm</span> <span style="color: #5bc4bf">/&gt;</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/div&gt;</span>
<span style="background-color: #4f424c">    <span style="color: #e7e9db">)}</span>
</span><span style="background-color: #4f424c">  <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/AuthUserContext.Consumer&gt;</span>
</span><span style="color: #e7e9db">);</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">condition</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">authUser</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #5bc4bf">!!</span><span style="color: #06b6ef">authUser</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">withAuthorization</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">condition</span><span style="color: #e7e9db">)(</span><span style="color: #06b6ef">AccountPage</span><span style="color: #e7e9db">);</span>
</code></pre>
              </div>


              <p>You can try it by signing out from your application and trying to access the <em>/account</em> or
                <em>/home</em> routes. Both should redirect you to the <em>/signin</em> route. It should also redirect
                you automatically when you stay on one of the routes while you sign out.</p>

              <p>You can imagine how this technique gives control over authorizations, not just by broader authorization
                rules, but more specific role-based and permission-based authorizations. For instance, an admin page
                available for users with the admin role could be protected as follows:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">import</span> <span style="color: #5bc4bf">*</span> <span style="color: #06b6ef">as</span> <span style="color: #06b6ef">ROLES</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../../constants/roles&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">AdminPage</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">(</span>
  <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">div</span><span style="color: #5bc4bf">&gt;</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">h1</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">Admin</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/h1&gt;</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">p</span><span style="color: #5bc4bf">&gt;</span>
      <span style="color: #06b6ef">Restricted</span> <span style="color: #06b6ef">area</span><span style="color: #5bc4bf">!</span> <span style="color: #06b6ef">Only</span> <span style="color: #06b6ef">users</span> <span style="color: #815ba4">with</span> <span style="color: #06b6ef">the</span> <span style="color: #06b6ef">admin</span> <span style="color: #06b6ef">role</span> <span style="color: #06b6ef">are</span> <span style="color: #06b6ef">authorized</span><span style="color: #e7e9db">.</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/p&gt;</span>
  <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/div&gt;</span>
<span style="color: #e7e9db">);</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">condition</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">authUser</span> <span style="color: #5bc4bf">=&gt;</span>
  <span style="color: #06b6ef">authUser</span> <span style="color: #5bc4bf">&amp;&amp;</span> <span style="color: #5bc4bf">!!</span><span style="color: #06b6ef">authUser</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">roles</span><span style="color: #e7e9db">[</span><span style="color: #06b6ef">ROLES</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">ADMIN</span><span style="color: #e7e9db">];</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">withAuthorization</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">condition</span><span style="color: #e7e9db">)(</span><span style="color: #06b6ef">AdminPage</span><span style="color: #e7e9db">);</span>
</code></pre>
              </div>


              <p>Don&rsquo;t worry about this yet, because we&rsquo;ll implement a role-based authorization for this
                application later. For now, you have successfully implemented a full-fledged authentication mechanisms
                with Firebase in React, added neat features such as password reset and password change, and protected
                routes with dynamic authorization conditions.</p>

              <h3 id="exercises-11">Exercises:</h3>

              <ul>
                <li>Research yourself how a role-based or permission-based authorization could be implemented.</li>
                <li>Confirm your <a target="_blank" rel="noopener noreferrer" href="http://bit.ly/2Vop4SL">source code
                    for the last section</a></li>
              </ul>

              <h2 class="chapter-header" id="react-firebase-realtime-database">Firebase Realtime Database in React</h2>

              <p>So far, only Firebase knows about your users. There is no way to retrieve a single user or a list of
                users for your application from their authentication database. They are stored internally by Firebase to
                keep the authentication secure. That&rsquo;s good, because you are never involved in storing sensible
                data like passwords. However, you can introduce the Firebase realtime database to keep track of user
                entities yourself. It makes sense, because then you can associate other domain entities (e.g. a message,
                a book, an invoice) created by your users to your users. You should keep control over your users, even
                though Firebase takes care about all the sensible data. This section will explain how to store users in
                your realtime database in Firebase. First, initialize the realtime database API for your Firebase class
                as you did earlier for the authentication API:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">app</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;firebase/app&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #48b685">&#39;firebase/auth&#39;</span><span style="color: #e7e9db">;</span>
<span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #48b685">&#39;firebase/database&#39;</span><span style="color: #e7e9db">;</span>
</span>
<span style="color: #815ba4">const</span> <span style="color: #06b6ef">config</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">{</span> <span style="color: #e7e9db">...</span> <span style="color: #e7e9db">};</span>

<span style="color: #815ba4">class</span> <span style="color: #06b6ef">Firebase</span> <span style="color: #e7e9db">{</span>
  <span style="color: #06b6ef">constructor</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
    <span style="color: #06b6ef">app</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">initializeApp</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">config</span><span style="color: #e7e9db">);</span>

    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">auth</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">app</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">auth</span><span style="color: #e7e9db">();</span>
<span style="background-color: #4f424c">    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">db</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">app</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">database</span><span style="color: #e7e9db">();</span>
</span>  <span style="color: #e7e9db">}</span>

  <span style="color: #776e71">// *** Auth API ***</span>

  <span style="color: #e7e9db">...</span>
<span style="color: #e7e9db">}</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">Firebase</span><span style="color: #e7e9db">;</span>
</code></pre>
              </div>


              <p>Second, extend the interface for your Firebase class for the user entity. It defines two new functions:
                one to get a reference to a user by identifier (uid) and one to get a reference to all users:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">app</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;firebase/app&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #48b685">&#39;firebase/auth&#39;</span><span style="color: #e7e9db">;</span>
<span style="color: #815ba4">import</span> <span style="color: #48b685">&#39;firebase/database&#39;</span><span style="color: #e7e9db">;</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">config</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">{</span> <span style="color: #e7e9db">...</span> <span style="color: #e7e9db">};</span>

<span style="color: #815ba4">class</span> <span style="color: #06b6ef">Firebase</span> <span style="color: #e7e9db">{</span>
  <span style="color: #06b6ef">constructor</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
    <span style="color: #06b6ef">app</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">initializeApp</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">config</span><span style="color: #e7e9db">);</span>

    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">auth</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">app</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">auth</span><span style="color: #e7e9db">();</span>
    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">db</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">app</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">database</span><span style="color: #e7e9db">();</span>
  <span style="color: #e7e9db">}</span>

  <span style="color: #776e71">// *** Auth API ***</span>

  <span style="color: #06b6ef">doCreateUserWithEmailAndPassword</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">(</span><span style="color: #06b6ef">email</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">password</span><span style="color: #e7e9db">)</span> <span style="color: #5bc4bf">=&gt;</span>
    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">auth</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">createUserWithEmailAndPassword</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">email</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">password</span><span style="color: #e7e9db">);</span>

  <span style="color: #06b6ef">doSignInWithEmailAndPassword</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">(</span><span style="color: #06b6ef">email</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">password</span><span style="color: #e7e9db">)</span> <span style="color: #5bc4bf">=&gt;</span>
    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">auth</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">signInWithEmailAndPassword</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">email</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">password</span><span style="color: #e7e9db">);</span>

  <span style="color: #06b6ef">doSignOut</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">auth</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">signOut</span><span style="color: #e7e9db">();</span>

  <span style="color: #06b6ef">doPasswordReset</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">email</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">auth</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">sendPasswordResetEmail</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">email</span><span style="color: #e7e9db">);</span>

  <span style="color: #06b6ef">doPasswordUpdate</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">password</span> <span style="color: #5bc4bf">=&gt;</span>
    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">auth</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">currentUser</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">updatePassword</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">password</span><span style="color: #e7e9db">);</span>

<span style="background-color: #4f424c">  <span style="color: #776e71">// *** User API ***</span>
</span>
<span style="background-color: #4f424c">  <span style="color: #06b6ef">user</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">uid</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">db</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">ref</span><span style="color: #e7e9db">(</span><span style="color: #48b685">`users/</span><span style="color: #f99b15">${</span><span style="color: #06b6ef">uid</span><span style="color: #f99b15">}</span><span style="color: #48b685">`</span><span style="color: #e7e9db">);</span>
</span>
<span style="background-color: #4f424c">  <span style="color: #06b6ef">users</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">db</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">ref</span><span style="color: #e7e9db">(</span><span style="color: #48b685">&#39;users&#39;</span><span style="color: #e7e9db">);</span>
</span><span style="color: #e7e9db">}</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">Firebase</span><span style="color: #e7e9db">;</span>
</code></pre>
              </div>


              <p>The paths in the <code>ref()</code> method match the location where your entities (users) will be
                stored in Firebase&rsquo;s realtime database API. If you delete a user at &ldquo;users/5&rdquo;, the
                user with the identifier 5 will be removed from the database. If you create a new user at
                &ldquo;users&rdquo;, Firebase creates the identifier for you and assigns all the information you pass
                for the user. The paths follow the <a target="_blank" rel="noopener noreferrer"
                  href="https://en.wikipedia.org/wiki/Representational_state_transfer">REST philosophy</a> where every
                entity (e.g. user, message, book, author) is associated with a URI, and HTTP methods are used to create,
                update, delete and get entities. In Firebase, the RESTful URI becomes a simple path, and the HTTP
                methods become Firebase&rsquo;s API.</p>

              <h3 id="exercises-12">Exercises:</h3>

              <ul>
                <li>Activate <a href="../firebase-tutorial/index.html">Firebase&rsquo;s Realtime Database</a> on your
                  Firebase Dashboard

                  <ul>
                    <li>Set your Database Rules on your Firebase Project&rsquo;s Dashboard to
                      <code>{ &quot;rules&quot;: { &quot;.read&quot;: true, &quot;.write&quot;: true } }</code> to give
                      everyone read and write access for now.</li>
                  </ul>
                </li>
                <li>Read more about <a target="_blank" rel="noopener noreferrer"
                    href="https://firebase.google.com/docs/database/web/start">Firebase&rsquo;s realtime database setup
                    for Web</a></li>
                <li>Confirm your <a target="_blank" rel="noopener noreferrer" href="http://bit.ly/2VpDkdW">source code
                    for the last section</a></li>
              </ul>

              <h2 class="chapter-header" id="react-firebase-realtime-database-user-management">Manage Users with
                Firebase&#39;s Realtime Database in React</h2>

              <p>Now, use these references in your React components to create and get users from Firebase&rsquo;s
                realtime database. The best place to add user creation is the SignUpForm component, as it is the most
                natural place to save users after signing up via the Firebase authentication API. Add another API
                request to create a user when the sign up is successful. In <em>src/components/SignUp/index.js</em>
                file:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #e7e9db">...</span>

<span style="color: #815ba4">class</span> <span style="color: #06b6ef">SignUpFormBase</span> <span style="color: #815ba4">extends</span> <span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">{</span>
  <span style="color: #06b6ef">constructor</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">)</span> <span style="color: #e7e9db">{</span>
    <span style="color: #815ba4">super</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">);</span>

    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">state</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">{</span> <span style="color: #e7e9db">...</span><span style="color: #06b6ef">INITIAL_STATE</span> <span style="color: #e7e9db">};</span>
  <span style="color: #e7e9db">}</span>

  <span style="color: #06b6ef">onSubmit</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">event</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
    <span style="color: #815ba4">const</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">username</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">email</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">passwordOne</span> <span style="color: #e7e9db">}</span> <span style="color: #5bc4bf">=</span> <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">state</span><span style="color: #e7e9db">;</span>

    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">firebase</span>
      <span style="color: #e7e9db">.</span><span style="color: #06b6ef">doCreateUserWithEmailAndPassword</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">email</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">passwordOne</span><span style="color: #e7e9db">)</span>
<span style="background-color: #4f424c">      <span style="color: #e7e9db">.</span><span style="color: #06b6ef">then</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">authUser</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
</span><span style="background-color: #4f424c">        <span style="color: #776e71">// Create a user in your Firebase realtime database</span>
</span><span style="background-color: #4f424c">        <span style="color: #815ba4">return</span> <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">firebase</span>
</span><span style="background-color: #4f424c">          <span style="color: #e7e9db">.</span><span style="color: #06b6ef">user</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">authUser</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">user</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">uid</span><span style="color: #e7e9db">)</span>
</span><span style="background-color: #4f424c">          <span style="color: #e7e9db">.</span><span style="color: #06b6ef">set</span><span style="color: #e7e9db">({</span>
</span><span style="background-color: #4f424c">            <span style="color: #06b6ef">username</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">            <span style="color: #06b6ef">email</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">          <span style="color: #e7e9db">});</span>
</span><span style="background-color: #4f424c">      <span style="color: #e7e9db">})</span>
</span>      <span style="color: #e7e9db">.</span><span style="color: #06b6ef">then</span><span style="color: #e7e9db">(()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
        <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">setState</span><span style="color: #e7e9db">({</span> <span style="color: #e7e9db">...</span><span style="color: #06b6ef">INITIAL_STATE</span> <span style="color: #e7e9db">});</span>
        <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">history</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">push</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">ROUTES</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">HOME</span><span style="color: #e7e9db">);</span>
      <span style="color: #e7e9db">})</span>
      <span style="color: #e7e9db">.</span><span style="color: #815ba4">catch</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">error</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
        <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">setState</span><span style="color: #e7e9db">({</span> <span style="color: #06b6ef">error</span> <span style="color: #e7e9db">});</span>
      <span style="color: #e7e9db">});</span>

    <span style="color: #06b6ef">event</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">preventDefault</span><span style="color: #e7e9db">();</span>
  <span style="color: #e7e9db">};</span>

  <span style="color: #e7e9db">...</span>
<span style="color: #e7e9db">}</span>

<span style="color: #e7e9db">...</span>
</code></pre>
              </div>


              <p>There are two important things happening for a new sign up via the submit handler:</p>

              <ul>
                <li>(1) It creates a user in Firebase&rsquo;s internal authentication database that is only limited
                  accessible.</li>
                <li>(2) If (1) was successful, it creates a user in Firebase&rsquo;s realtime database that is
                  accessible.</li>
              </ul>

              <p>To create a user in Firebase&rsquo;s realtime database, it uses the previously created reference from
                the Firebase class by providing the identifier (uid) of the user from Firebase&rsquo;s authentication
                database. Then the <code>set()</code> method can be used to provide data for this entity which is
                allocated for &ldquo;users/uid&rdquo;. Finally, you can use the <code>username</code> as well to provide
                additional information about your user.</p>

              <p>Note: It is fine to store user information in your own database. However, you should make sure not to
                store the password or any other sensible data of the user on your own. Firebase already deals with the
                authentication, so there is no need to store the password in your database. Many steps are necessary to
                secure sensible data (e.g. encryption), and it could be a security risk to perform it on your own.</p>

              <p>After the second Firebase request that creates the user resolves successfully, the previous business
                logic takes place again: reset the local state and redirect to the home page. To verify the user
                creation is working, retrieve all the users from the realtime database in one of your other components.
                The admin page may be a good choice for it, because it can be used by admin users to manage the
                application-wide users later. First, make the admin page available via your Navigation component:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #e7e9db">...</span>

<span style="color: #815ba4">const</span> <span style="color: #06b6ef">NavigationAuth</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">()</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">(</span>
  <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">ul</span><span style="color: #5bc4bf">&gt;</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">li</span><span style="color: #5bc4bf">&gt;</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Link</span> <span style="color: #06b6ef">to</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">ROUTES</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">LANDING</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">Landing</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/Link&gt;</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/li&gt;</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">li</span><span style="color: #5bc4bf">&gt;</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Link</span> <span style="color: #06b6ef">to</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">ROUTES</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">HOME</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">Home</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/Link&gt;</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/li&gt;</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">li</span><span style="color: #5bc4bf">&gt;</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Link</span> <span style="color: #06b6ef">to</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">ROUTES</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">ACCOUNT</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">Account</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/Link&gt;</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/li&gt;</span>
<span style="background-color: #4f424c">    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">li</span><span style="color: #5bc4bf">&gt;</span>
</span><span style="background-color: #4f424c">      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">Link</span> <span style="color: #06b6ef">to</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">ROUTES</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">ADMIN</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">Admin</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/Link&gt;</span>
</span><span style="background-color: #4f424c">    <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/li&gt;</span>
</span>    <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">li</span><span style="color: #5bc4bf">&gt;</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">SignOutButton</span> <span style="color: #5bc4bf">/&gt;</span>
    <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/li&gt;</span>
  <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/ul&gt;</span>
<span style="color: #e7e9db">);</span>

<span style="color: #e7e9db">...</span>
</code></pre>
              </div>


              <p>Next, the AdminPage component&rsquo;s <code>componentDidMount()</code> lifecycle method in
                <em>src/components/Admin/index.js</em> is the perfect place to fetch users from your Firebase realtime
                database API:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #815ba4">import</span> <span style="color: #06b6ef">React</span><span style="color: #e7e9db">,</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;react&#39;</span><span style="color: #e7e9db">;</span>

<span style="background-color: #4f424c"><span style="color: #815ba4">import</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">withFirebase</span> <span style="color: #e7e9db">}</span> <span style="color: #06b6ef">from</span> <span style="color: #48b685">&#39;../Firebase&#39;</span><span style="color: #e7e9db">;</span>
</span>
<span style="color: #815ba4">class</span> <span style="color: #06b6ef">AdminPage</span> <span style="color: #815ba4">extends</span> <span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">{</span>
  <span style="color: #06b6ef">constructor</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">)</span> <span style="color: #e7e9db">{</span>
    <span style="color: #815ba4">super</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">);</span>

<span style="background-color: #4f424c">    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">state</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">{</span>
</span><span style="background-color: #4f424c">      <span style="color: #06b6ef">loading</span><span style="color: #5bc4bf">:</span> <span style="color: #815ba4">false</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">      <span style="color: #06b6ef">users</span><span style="color: #5bc4bf">:</span> <span style="color: #e7e9db">{},</span>
</span><span style="background-color: #4f424c">    <span style="color: #e7e9db">};</span>
</span>  <span style="color: #e7e9db">}</span>

<span style="background-color: #4f424c">  <span style="color: #06b6ef">componentDidMount</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
</span><span style="background-color: #4f424c">    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">setState</span><span style="color: #e7e9db">({</span> <span style="color: #06b6ef">loading</span><span style="color: #5bc4bf">:</span> <span style="color: #815ba4">true</span> <span style="color: #e7e9db">});</span>
</span><span style="background-color: #4f424c">
</span><span style="background-color: #4f424c">    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">firebase</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">users</span><span style="color: #e7e9db">().</span><span style="color: #06b6ef">on</span><span style="color: #e7e9db">(</span><span style="color: #48b685">&#39;value&#39;</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">snapshot</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
</span><span style="background-color: #4f424c">      <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">setState</span><span style="color: #e7e9db">({</span>
</span><span style="background-color: #4f424c">        <span style="color: #06b6ef">users</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">snapshot</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">val</span><span style="color: #e7e9db">(),</span>
</span><span style="background-color: #4f424c">        <span style="color: #06b6ef">loading</span><span style="color: #5bc4bf">:</span> <span style="color: #815ba4">false</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">      <span style="color: #e7e9db">});</span>
</span><span style="background-color: #4f424c">    <span style="color: #e7e9db">});</span>
</span><span style="background-color: #4f424c">  <span style="color: #e7e9db">}</span>
</span>
  <span style="color: #06b6ef">render</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
    <span style="color: #815ba4">return</span> <span style="color: #e7e9db">(</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">div</span><span style="color: #5bc4bf">&gt;</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">h1</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">Admin</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/h1&gt;</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/div&gt;</span>
    <span style="color: #e7e9db">);</span>
  <span style="color: #e7e9db">}</span>
<span style="color: #e7e9db">}</span>

<span style="background-color: #4f424c"><span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">withFirebase</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">AdminPage</span><span style="color: #e7e9db">);</span>
</span></code></pre>
              </div>


              <p>We are using the users reference from our Firebase class to attach a listener. The listener is called
                <code>on()</code>, which receives a type and a callback function. The <code>on()</code> method registers
                a continuous listener that triggers every time something has changed, the <code>once()</code> method
                registers a listener that would be called only once. In this scenario, we are interested to keep the
                latest list of users though.</p>

              <p>Since the users are objects rather than lists when they are retrieved from the Firebase database, you
                have to restructure them as lists (arrays), which makes it easier to display them later:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #e7e9db">...</span>

<span style="color: #815ba4">class</span> <span style="color: #06b6ef">AdminPage</span> <span style="color: #815ba4">extends</span> <span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">{</span>
  <span style="color: #06b6ef">constructor</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">)</span> <span style="color: #e7e9db">{</span>
    <span style="color: #815ba4">super</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">);</span>

    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">state</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">{</span>
      <span style="color: #06b6ef">loading</span><span style="color: #5bc4bf">:</span> <span style="color: #815ba4">false</span><span style="color: #e7e9db">,</span>
<span style="background-color: #4f424c">      <span style="color: #06b6ef">users</span><span style="color: #5bc4bf">:</span> <span style="color: #e7e9db">[],</span>
</span>    <span style="color: #e7e9db">};</span>
  <span style="color: #e7e9db">}</span>

  <span style="color: #06b6ef">componentDidMount</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">setState</span><span style="color: #e7e9db">({</span> <span style="color: #06b6ef">loading</span><span style="color: #5bc4bf">:</span> <span style="color: #815ba4">true</span> <span style="color: #e7e9db">});</span>

    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">firebase</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">users</span><span style="color: #e7e9db">().</span><span style="color: #06b6ef">on</span><span style="color: #e7e9db">(</span><span style="color: #48b685">&#39;value&#39;</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">snapshot</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">{</span>
<span style="background-color: #4f424c">      <span style="color: #815ba4">const</span> <span style="color: #06b6ef">usersObject</span> <span style="color: #5bc4bf">=</span> <span style="color: #06b6ef">snapshot</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">val</span><span style="color: #e7e9db">();</span>
</span>
<span style="background-color: #4f424c">      <span style="color: #815ba4">const</span> <span style="color: #06b6ef">usersList</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">Object.</span><span style="color: #06b6ef">keys</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">usersObject</span><span style="color: #e7e9db">).</span><span style="color: #06b6ef">map</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">key</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">({</span>
</span><span style="background-color: #4f424c">        <span style="color: #e7e9db">...</span><span style="color: #06b6ef">usersObject</span><span style="color: #e7e9db">[</span><span style="color: #06b6ef">key</span><span style="color: #e7e9db">],</span>
</span><span style="background-color: #4f424c">        <span style="color: #06b6ef">uid</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">key</span><span style="color: #e7e9db">,</span>
</span><span style="background-color: #4f424c">      <span style="color: #e7e9db">}));</span>
</span>
      <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">setState</span><span style="color: #e7e9db">({</span>
<span style="background-color: #4f424c">        <span style="color: #06b6ef">users</span><span style="color: #5bc4bf">:</span> <span style="color: #06b6ef">usersList</span><span style="color: #e7e9db">,</span>
</span>        <span style="color: #06b6ef">loading</span><span style="color: #5bc4bf">:</span> <span style="color: #815ba4">false</span><span style="color: #e7e9db">,</span>
      <span style="color: #e7e9db">});</span>
    <span style="color: #e7e9db">});</span>
  <span style="color: #e7e9db">}</span>

  <span style="color: #e7e9db">...</span>
<span style="color: #e7e9db">}</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">withFirebase</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">AdminPage</span><span style="color: #e7e9db">);</span>
</code></pre>
              </div>


              <p>Remember to remove the listener to avoid memory leaks from using the same reference with the
                <code>off()</code> method:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #e7e9db">...</span>

<span style="color: #815ba4">class</span> <span style="color: #06b6ef">AdminPage</span> <span style="color: #815ba4">extends</span> <span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">{</span>
  <span style="color: #e7e9db">...</span>

<span style="background-color: #4f424c">  <span style="color: #06b6ef">componentWillUnmount</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
</span><span style="background-color: #4f424c">    <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">props</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">firebase</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">users</span><span style="color: #e7e9db">().</span><span style="color: #06b6ef">off</span><span style="color: #e7e9db">();</span>
</span><span style="background-color: #4f424c">  <span style="color: #e7e9db">}</span>
</span>
  <span style="color: #e7e9db">...</span>
<span style="color: #e7e9db">}</span>

<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">withFirebase</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">AdminPage</span><span style="color: #e7e9db">);</span>
</code></pre>
              </div>


              <p>Render your list of users in the AdminPage component or in a child component. In this case, we are
                using a child component:</p>

              <div class="highlight" style="background: #2f1e2e">
                <pre style="line-height: 125%"><code class="language-javascript" data-lang="javascript"><span></span><span style="color: #e7e9db">...</span>

<span style="color: #815ba4">class</span> <span style="color: #06b6ef">AdminPage</span> <span style="color: #815ba4">extends</span> <span style="color: #06b6ef">Component</span> <span style="color: #e7e9db">{</span>
  <span style="color: #e7e9db">...</span>

  <span style="color: #06b6ef">render</span><span style="color: #e7e9db">()</span> <span style="color: #e7e9db">{</span>
<span style="background-color: #4f424c">    <span style="color: #815ba4">const</span> <span style="color: #e7e9db">{</span> <span style="color: #06b6ef">users</span><span style="color: #e7e9db">,</span> <span style="color: #06b6ef">loading</span> <span style="color: #e7e9db">}</span> <span style="color: #5bc4bf">=</span> <span style="color: #815ba4">this</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">state</span><span style="color: #e7e9db">;</span>
</span>
    <span style="color: #815ba4">return</span> <span style="color: #e7e9db">(</span>
      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">div</span><span style="color: #5bc4bf">&gt;</span>
        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">h1</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">Admin</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/h1&gt;</span>

<span style="background-color: #4f424c">        <span style="color: #e7e9db">{</span><span style="color: #06b6ef">loading</span> <span style="color: #5bc4bf">&amp;&amp;</span> <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">div</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">Loading</span> <span style="color: #e7e9db">...</span><span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/div&gt;}</span>
</span>
<span style="background-color: #4f424c">        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">UserList</span> <span style="color: #06b6ef">users</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">users</span><span style="color: #e7e9db">}</span> <span style="color: #5bc4bf">/&gt;</span>
</span>      <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/div&gt;</span>
    <span style="color: #e7e9db">);</span>
  <span style="color: #e7e9db">}</span>
<span style="color: #e7e9db">}</span>

<span style="background-color: #4f424c"><span style="color: #815ba4">const</span> <span style="color: #06b6ef">UserList</span> <span style="color: #5bc4bf">=</span> <span style="color: #e7e9db">({</span> <span style="color: #06b6ef">users</span> <span style="color: #e7e9db">})</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">(</span>
</span><span style="background-color: #4f424c">  <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">ul</span><span style="color: #5bc4bf">&gt;</span>
</span><span style="background-color: #4f424c">    <span style="color: #e7e9db">{</span><span style="color: #06b6ef">users</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">map</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">user</span> <span style="color: #5bc4bf">=&gt;</span> <span style="color: #e7e9db">(</span>
</span><span style="background-color: #4f424c">      <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">li</span> <span style="color: #06b6ef">key</span><span style="color: #5bc4bf">=</span><span style="color: #e7e9db">{</span><span style="color: #06b6ef">user</span><span style="color: #e7e9db">.</span><span style="color: #06b6ef">uid</span><span style="color: #e7e9db">}</span><span style="color: #5bc4bf">&gt;</span>
</span><span style="background-color: #4f424c">        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">span</span><span style="color: #5bc4bf">&gt;</span>
</span><span style="background-color: #4f424c">          <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">strong</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">ID</span><span style="color: #5bc4bf">:&lt;</span><span style="color: #ef6155">/strong&gt; {user.uid}</span>
</span><span style="background-color: #4f424c">        <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/span&gt;</span>
</span><span style="background-color: #4f424c">        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">span</span><span style="color: #5bc4bf">&gt;</span>
</span><span style="background-color: #4f424c">          <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">strong</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">E</span><span style="color: #5bc4bf">-</span><span style="color: #06b6ef">Mail</span><span style="color: #5bc4bf">:&lt;</span><span style="color: #ef6155">/strong&gt; {user.email}</span>
</span><span style="background-color: #4f424c">        <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/span&gt;</span>
</span><span style="background-color: #4f424c">        <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">span</span><span style="color: #5bc4bf">&gt;</span>
</span><span style="background-color: #4f424c">          <span style="color: #5bc4bf">&lt;</span><span style="color: #06b6ef">strong</span><span style="color: #5bc4bf">&gt;</span><span style="color: #06b6ef">Username</span><span style="color: #5bc4bf">:&lt;</span><span style="color: #ef6155">/strong&gt; {user.username}</span>
</span><span style="background-color: #4f424c">        <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/span&gt;</span>
</span><span style="background-color: #4f424c">      <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/li&gt;</span>
</span><span style="background-color: #4f424c">    <span style="color: #e7e9db">))}</span>
</span><span style="background-color: #4f424c">  <span style="color: #5bc4bf">&lt;</span><span style="color: #ef6155">/ul&gt;</span>
</span><span style="background-color: #4f424c"><span style="color: #e7e9db">);</span>
</span>
<span style="color: #815ba4">export</span> <span style="color: #815ba4">default</span> <span style="color: #06b6ef">withFirebase</span><span style="color: #e7e9db">(</span><span style="color: #06b6ef">AdminPage</span><span style="color: #e7e9db">);</span>
</code></pre>
              </div>


              <p>You have gained full control of your users now. It is possible to create and retrieve users from your
                realtime database. You can decide whether this is a one-time call to the Firebase realtime database, or
                if you want to continuously listen for updates as well.</p>

              <h3 id="exercises-13">Exercises:</h3>

              <ul>
                <li>Read more about <a target="_blank" rel="noopener noreferrer"
                    href="https://firebase.google.com/docs/database/web/read-and-write">how to read and write data to
                    Firebase&rsquo;s realtime database</a></li>
                <li>Confirm your <a target="_blank" rel="noopener noreferrer" href="http://bit.ly/2VmRegY">source code
                    for the last section</a></li>
              </ul>

              <hr class="section-divider">

              <p>Everything essential is in place for Firebase authentication and Firebase realtime database for user
                management. I am interested in seeing what you will build on top of it! If you want to continue to
                follow this tutorial, get the whole book to finish this application with plenty of powerful features.
              </p>

              <div class="box-inline col-md-12">
                <div class="col-md-12 text-center">
                  <h2 class="newsletter">The Road to React with Firebase</h2>
                  <div class="col-md-4">
                    <img class="img-lazy img-responsive"
                      data-lazy-src="//img/page/the-road-to-react-with-firebase-book.jpg" alt="package">
                  </div>
                  <p class="lead">
                    Your journey to master web applications with a minimal tech stack to get you started with your
                    business and MVPs.
                  </p>
                  <a class="btn btn-template-main"
                    href="https://roadtoreact.com/course-details?courseId=THE_ROAD_TO_REACT_WITH_FIREBASE"
                    target="_blank" rel="noopener noreferrer">
                    Get the Book <i class="fa fa-chevron-right"></i>
                  </a>
                </div>
              </div>


              <p><strong>What&rsquo;s else will be included in the book?</strong></p>

              <ul>
                <li>
                  <p>Role-based Authorization: So far, you have only authorized your application on a broad level, by
                    checking for an authenticated user. In the book, you will learn how to assign roles to your users
                    and how to give them additional privileges.</p>
                </li>

                <li>
                  <p>User Management: In order to get more control over your users, I will show you how to merge
                    authentication user and database user. Then you can always assign new properties to your database
                    user while having access to it on your user after authentication too.</p>
                </li>

                <li>
                  <p>Users and Messages: Next to the user management, you will introduce a second entity for messages to
                    your application. By using both entities, user and message, we can build a chat application.</p>
                </li>

                <li>
                  <p>Read and Write Operations: In the application, you created a user and display a list of users with
                    real-time capabilities. The book continuous with the usual delete and update operations to organize
                    your users in the realtime database.</p>
                </li>

                <li>
                  <p>Offline, Double Opt-In, Social Logins: The book adds more Firebase attributes ike offline
                    capabilities, double opt-in sign ups, and social sign ups/ins via third-parties like Facebook or
                    Google.</p>
                </li>

                <li>
                  <p>Firebase Deployment: The final step in the book is to deploy an application with Firebase. The
                    books walks you through the process step-by-step to see your project online.</p>
                </li>

                <li>
                  <p>Firestore: Firebase&rsquo;s Firestore is the new Firebase Realtime Database. In the book, I may
                    show you a way to migrate to this new tech stack. Then it is up to you whether you want to use
                    Firestore or Firebase&rsquo;s Realtime Database.</p>
                </li>

                <li>
                  <p>Source Code Projects: This application is only build with React and Firebase. But what about taking
                    it on the next level to enable it for real businesses? That&rsquo;s where I want to show you how to
                    migrate the project to Redux, MobX, or Gatsby.js. You will get access to variations of this
                    application that will have additional tech when choosing the course instead of only the book:</p>

                  <ul>
                    <li>Gatsby + Firebase</li>
                    <li>React + Redux + Firebase</li>
                    <li>React + MobX + Firebase</li>
                    <li>React + Semantic UI + Firebase</li>
                    <li>React + Cloud Firestore</li>
                  </ul>
                </li>
              </ul>



              



              <div class="box-inline col-md-12">
                <div class="col-md-12 text-center">
                  <h2 class="newsletter">The Road to learn React</h2>

                  <div class="col-md-4">
                    <img class="img-lazy img-responsive" data-lazy-src="//img/page/cover.png">
                  </div>

                  <p class="lead">
                    Build a Hacker News App along the way. No setup configuration. No tooling. No Redux. Plain React in
                    200+ pages of learning material. Learn React like <strong>50.000+ readers</strong>.
                  </p>
                  <a class="btn btn-template-main" href="https://roadtoreact.com" target="_blank"
                    rel="noopener noreferrer">
                    Get the Book for free <i class="fa fa-chevron-right"></i>
                  </a>

                  <div>
                    <a href="https://amzn.to/2QY2ONp" target="_blank" rel="noopener noreferrer">
                      Get it from Amazon
                    </a>
                  </div>

                </div>
              </div>

            </div>



            


          </article>


        </div>


      </div>

    </div>




    <section class="bar background-image-fixed-2 no-mb color-white text-center">
      <div class="dark-mask"></div>
      <div class="container">
        <div class="row">
          <div class="col-md-12">
            <h3 class="lead">Never miss an article about web development, JavaScript and self-growth.</h3>
            <h2 class="text-uppercase">Take Part</h2>
          </div>

          <div class="col-md-12 text-center">

            <h3 class="lead"><i class="fa fa-check"></i> Join 30.000&#43; Developers</h3>

            <h3 class="lead"><i class="fa fa-check"></i> Learn Web Development with JavaScript</h3>

            <h3 class="lead"><i class="fa fa-check"></i> Tips and Tricks</h3>

            <h3 class="lead"><i class="fa fa-check"></i> Access Tutorials, eBooks and Courses</h3>

            <h3 class="lead"><i class="fa fa-check"></i> Personal Development as a Software Engineer</h3>

          </div>
          <div class="col-md-12">
            <p class="text-center">
              <div id="mc_embed_signup">
                <form action="https://www.getrevue.co/profile/rwieruch/add_subscriber" method="post" id="revue-form"
                  name="revue-form" target="_blank">
                  <div id="mc_embed_signup_scroll">
                    <input class="email" placeholder="email address" type="email" name="member[email]"
                      id="member_email">
                    <div>
                      <button type="submit" value="Subscribe" name="member[subscribe]" id="member_submit"
                        class="btn btn-template-transparent-black btn-lg">
                        Subscribe
                      </button>
                    </div>
                  </div>
                </form>
              </div>

            </p>
          </div>
        </div>
      </div>
    </section>
    <footer id="subfooter">
      <div class="container">

        <div class="col-md-5 col-sm-6">

          <h4>Recent posts</h4>

          <div class="blog-entries">

            <div class="item same-height-row clearfix">
              <div class="article same-height-always">
                <a href="../redux-vs-usereducer/index.html">

                  <img data-lazy-src="//img/posts/redux-vs-usereducer/banner.jpg" data-is-thumb="is-thumb"
                    class="img-lazy img-responsive" alt="React&#39;s useReducer vs Redux">

                </a>
              </div>
              <div class="name same-height-always">
                <h5><a href="../redux-vs-usereducer/index.html">React&#39;s useReducer vs Redux</a></h5>
              </div>
            </div>

            <div class="item same-height-row clearfix">
              <div class="article same-height-always">
                <a href="../publish-npm-package-node/index.html">

                  <img data-lazy-src="//img/posts/publish-npm-package-node/banner.jpg" data-is-thumb="is-thumb"
                    class="img-lazy img-responsive" alt="How to publish a npm package?">

                </a>
              </div>
              <div class="name same-height-always">
                <h5><a href="../publish-npm-package-node/index.html">How to publish a npm package?</a></h5>
              </div>
            </div>

            <div class="item same-height-row clearfix">
              <div class="article same-height-always">
                <a href="../react-scroll-to-item/index.html">

                  <img data-lazy-src="//img/posts/react-scroll-to-item/banner.jpg" data-is-thumb="is-thumb"
                    class="img-lazy img-responsive" alt="How to Scroll to Item in React?">

                </a>
              </div>
              <div class="name same-height-always">
                <h5><a href="../react-scroll-to-item/index.html">How to Scroll to Item in React?</a></h5>
              </div>
            </div>

          </div>

          <hr class="hidden-md hidden-lg hidden-sm">

        </div>



        <div class="col-md-5 col-md-offset-2 col-sm-6">

          <h4>About Me</h4>

          <div class="blog-entries">
            <div class="item same-height-row clearfix">
              <div class="profile same-height-always">
                <img class="img-lazy img-responsive" data-lazy-src="//img/page/profile.jpg" alt="profile">
              </div>
              <div class="name same-height-always">
                <p>
                  Hi, I'm Chris - a Midvale, Utah-based consulting software developer. Find out more <a
                    href="../about/index.html">about me</a>, <a href="../work-with-me/index.html">work with me</a>, or
                  have a look at my social media profiles below.
                </p>
              </div>
            </div>
          </div>

        </div>



      </div>

    </footer>


    <footer id="copyright">
      <div class="container">
        <div class="row">
          <div class="col-md-4">
            <ul class="info list-inline quicklinks pull-left">

              <li> Chris Paul</li>

            </ul>
          </div>
          <div class="col-md-4">
            
          </div>
          <div class="col-md-4">
            <ul class="info list-inline quicklinks pull-right">

              <li><a aria-label="quicklinks" href="../legal/index.html">Legal Notice</a></li>

            </ul>
          </div>
        </div>
      </div>
    </footer>


  </div>




  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>

  <script src="../js/script.js"></script>
</body>

</html>